import React, { useState, useEffect, useRef } from 'react';
import { NavigationContainer } from '@react-navigation/native';
import { createNativeStackNavigator } from '@react-navigation/native-stack';
import { View, Text, StyleSheet, TouchableOpacity, TextInput, SafeAreaView, Alert, ScrollView, FlatList, Image, ImageBackground, Animated, Dimensions, Linking, ActivityIndicator, Modal, Switch } from 'react-native';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { initializeApp } from 'firebase/app';
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, sendEmailVerification, sendPasswordResetEmail } from 'firebase/auth';
import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, getDocs, query as dbQuery, orderBy, limit, where, startAfter } from 'firebase/firestore';
import { getFunctions, httpsCallable } from 'firebase/functions';
import { getStorage, ref, uploadBytes, getDownloadURL } from 'firebase/storage';
import * as ImagePicker from 'expo-image-picker';
import TelegramChannelsScreen from './src/screens/TelegramChannelsScreen';
import Icon from 'react-native-vector-icons/MaterialIcons';
import { useAppFonts, fonts } from './src/utils/fonts';

// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyCYYavl-JsiPGcFhWSw7vGMPCbVhqt5pBQ",
  authDomain: "nibjobs-dev.firebaseapp.com", 
  projectId: "nibjobs-dev",
  storageBucket: "nibjobs-dev.firebasestorage.app",
  messagingSenderId: "921124469397",
  appId: "1:921124469397:android:4dcb0020fee8cb5ca9f99c"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const functions = getFunctions(app);
const storage = getStorage(app);

// Brand colors - Updated with modern palette
const lightColors = {
  beeYellow: '#F4C430',
  honeyGold: '#D4AF37',
  darkYellow: '#B8860B',
  deepNavy: '#1A1B3E',
  charcoal: '#2C2C2C',
  cream: '#FFF9E6',
  white: '#FFFFFF',
  warmGray: '#6B6B6B',
  lightGray: '#F5F5F5',
  softBlue: '#4A90E2',
  success: '#27AE60',
  danger: '#E74C3C',
  error: '#E74C3C',
  lightPeach: '#FFE5CC',
  // Modern sidebar colors
  sidebarBg: '#F8FAFC',        // Light gray-blue
  sidebarText: '#475569',      // Slate gray
  sidebarTextActive: '#0F172A', // Dark slate
  sidebarAccent: '#3B82F6',    // Modern blue
  sidebarAccentLight: '#EFF6FF', // Light blue
  sidebarBorder: '#E2E8F0',    // Subtle border
  sidebarHover: '#F1F5F9',     // Hover state
};

// Dark theme colors
const darkColors = {
  beeYellow: '#FFD700',
  honeyGold: '#FFA500',
  darkYellow: '#FF8C00',
  deepNavy: '#E2E8F0',
  charcoal: '#F8F9FA',
  cream: '#1A1D23',
  white: '#0F1114',
  warmGray: '#9CA3AF',
  lightGray: '#1F2937',
  softBlue: '#60A5FA',
  success: '#10B981',
  danger: '#F87171',
  error: '#F87171',
  lightPeach: '#3A2E28',
  // Modern sidebar colors (dark)
  sidebarBg: '#1F2937',
  sidebarText: '#9CA3AF',
  sidebarTextActive: '#F9FAFB',
  sidebarAccent: '#60A5FA',
  sidebarAccentLight: '#1E3A8A',
  sidebarBorder: '#374151',
  sidebarHover: '#374151',
};

// Subscription Plans Configuration
const SUBSCRIPTION_PLANS = [
  {
    id: 'free',
    name: 'Free',
    priceMonthly: 0,
    priceYearly: 0,
    icon: 'star-outline',
    color: '#808080',
    popular: false,
    buttonText: 'Get Started',
    features: [
      { text: '3 custom job notifications per day on mobile app', enabled: true },
      { text: 'Basic job search and browsing', enabled: true },
      { text: 'Cannot post job ads', enabled: false },
      { text: 'Limited to 3 notifications daily', enabled: false }
    ],
    adsEnabled: true
  },
  {
    id: 'standard',
    name: 'Standard',
    priceMonthly: 299,
    priceYearly: 2990,
    icon: 'star',
    color: '#F4C430',
    popular: true,
    buttonText: 'Choose Standard',
    features: [
      { text: 'Up to 50 custom job notifications per day', enabled: true },
      { text: 'Priority in search results', enabled: true },
      { text: 'Advanced filtering options', enabled: true },
      { text: 'Resume visibility boost', enabled: true },
      { text: 'Cannot post job ads', enabled: false }
    ],
    adsEnabled: false
  },
  {
    id: 'enterprise',
    name: 'Enterprise',
    priceMonthly: 15000,
    priceYearly: 150000,
    icon: 'business',
    color: '#1A365D',
    popular: false,
    buttonText: 'Contact Sales',
    features: [
      { text: 'Post unlimited job ads', enabled: true },
      { text: 'Accept and manage resumes', enabled: true },
      { text: 'Detailed job market statistics', enabled: true },
      { text: 'Applicant tracking system', enabled: true },
      { text: 'Company branding & logo display', enabled: true },
      { text: 'Featured job placements', enabled: true },
      { text: 'Priority support & account manager', enabled: true }
    ],
    adsEnabled: false
  }
];

// Multi-language translations
const translations = {
  en: {
    appTitle: 'NibJobs',
    searchPlaceholder: 'Search jobs...',
    login: 'Login',
    signUp: 'Sign Up',
    exploreChannels: 'Multiple Job Sources',
    swipeHint: 'â† Swipe to explore more channels â†’',
    recentJobs: 'Recent Jobs',
    jobsFound: 'jobs found',
    loading: 'Loading jobs...',
    categories: 'Categories',
    contractType: 'Contract Type',
    location: 'Location',
    remoteJobs: 'Remote Jobs',
    clearFilters: 'Clear Filters',
    adminLogin: 'Administrator Login',
    email: 'Email',
    password: 'Password',
    loginButton: 'Login',
    loginError: 'Please enter email and password',
    invalidCredentials: 'Invalid email or password',
    telegramChannel: 'Telegram Channel',
    members: 'members',
    darkMode: 'Dark Mode',
    language: 'Language',
    downloadPlayStore: 'Play Store',
    downloadAppStore: 'App Store',
    // Jobs page
    employmentType: 'Employment Type',
    workMode: 'Work Mode',
    fullTime: 'Full-time',
    partTime: 'Part-time',
    contract: 'Contract',
    remote: 'Remote',
    onSite: 'On-site',
    hybrid: 'Hybrid',
    applyNow: 'Apply Now',
    shareJob: 'Share Job',
    viewDetails: 'View Details',
    salaryRange: 'Salary Range',
    posted: 'Posted',
    ago: 'ago',
    noJobsFound: 'No jobs found',
    filterJobs: 'Filter Jobs',
    sortBy: 'Sort By',
    clearAll: 'Clear All',
    // Companies page
    companies: 'Companies',
    viewAll: 'View All',
    noCompaniesFound: 'No companies found',
    // Settings page
    settings: 'Settings',
    profile: 'Profile',
    notifications: 'Notifications',
    theme: 'Theme',
    logout: 'Logout',
    about: 'About',
    privacy: 'Privacy Policy',
    terms: 'Terms of Service',
    // Bookmarks
    bookmarks: 'Bookmarks',
    bookmark: 'Bookmark',
    save: 'Save',
    saved: 'Saved',
    remove: 'Remove',
    // Common
    jobs: 'Jobs',
    search: 'Search',
    filter: 'Filter',
    apply: 'Apply',
    company: 'Company',
    salary: 'Salary',
    description: 'Description',
    requirements: 'Requirements'
  },
  am: { // Amharic
    appTitle: 'áŠ•á‰¥ áˆµáˆ«á‹Žá‰½',
    searchPlaceholder: 'áˆµáˆ«á‹Žá‰½áŠ• á‹­áˆáˆáŒ‰...',
    login: 'áŒá‰£',
    signUp: 'áˆ˜áˆ˜á‹áŒˆá‰¥',
    exploreChannels: 'ðŸš€ á‹¨á‰´áˆŒáŒáˆ«áˆ á‰»áŠ“áˆŽá‰½áŠ• áŠ áˆµáˆ±',
    swipeHint: 'â† á‰°áŒ¨áˆ›áˆª á‰»áŠ“áˆŽá‰½áŠ• áˆˆáˆ›áˆµáˆ³á‰µ á‹­áŠ•áˆ¸áˆ«á‰°á‰± â†’',
    recentJobs: 'á‹¨á‰…áˆ­á‰¥ áŒŠá‹œ áˆµáˆ«á‹Žá‰½',
    jobsFound: 'áˆµáˆ«á‹Žá‰½ á‰°áŒˆáŠá‰°á‹‹áˆ',
    loading: 'áˆµáˆ«á‹Žá‰½ á‰ áˆ˜áŒ«áŠ• áˆ‹á‹­...',
    categories: 'áˆá‹µá‰¦á‰½',
    contractType: 'á‹¨áŠ®áŠ•á‰µáˆ«á‰µ áŠ á‹­áŠá‰µ',
    location: 'áŠ áŠ«á‰£á‰¢',
    remoteJobs: 'á‹¨áˆ­á‰€á‰µ áˆµáˆ«á‹Žá‰½',
    clearFilters: 'áˆ›áŒ£áˆªá‹«á‹Žá‰½áŠ• áŠ áŒ½á‹³',
    adminLogin: 'á‹¨áŠ áˆµá‰°á‹³á‹³áˆª áˆ˜áŒá‰¢á‹«',
    email: 'áŠ¢áˆœá‹­áˆ',
    password: 'á‹¨á‹­áˆˆá á‰ƒáˆ',
    loginButton: 'áŒá‰£',
    loginError: 'áŠ¥á‰£áŠ­á‹Ž áŠ¢áˆœá‹­áˆ áŠ¥áŠ“ á‹¨á‹­áˆˆá á‰ƒáˆ á‹«áˆµáŒˆá‰¡',
    invalidCredentials: 'áˆáŠ­ á‹«áˆáˆ†áŠ áŠ¢áˆœá‹­áˆ á‹ˆá‹­áˆ á‹¨á‹­áˆˆá á‰ƒáˆ',
    telegramChannel: 'á‹¨á‰´áˆŒáŒáˆ«áˆ á‰»áŠ“áˆ',
    members: 'áŠ á‰£áˆ‹á‰µ',
    darkMode: 'áŒ¨áˆˆáˆ› áŒˆáŒ½á‰³',
    language: 'á‰‹áŠ•á‰‹',
    downloadPlayStore: 'á•áˆŒá‹­ áˆµá‰¶áˆ­',
    downloadAppStore: 'áŠ á• áˆµá‰¶áˆ­',
    // Jobs page
    employmentType: 'á‹¨á‰…áŒ¥áˆ­ áŠ á‹­áŠá‰µ',
    workMode: 'á‹¨áˆµáˆ« á‹˜á‹´',
    fullTime: 'áˆ™áˆ‰ áŒŠá‹œ',
    partTime: 'á‹¨á‰µáˆ­á áŒŠá‹œ',
    contract: 'á‹áˆ',
    remote: 'áˆ­á‰€á‰µ',
    onSite: 'á‰ á‰¦á‰³á‹',
    hybrid: 'á‹µá‰¥áˆá‰…',
    applyNow: 'áŠ áˆáŠ• á‹«áˆ˜áˆáŠ­á‰±',
    shareJob: 'áˆµáˆ« áŠ áŒ‹áˆ«',
    viewDetails: 'á‹áˆ­á‹áˆ­ á‹­áˆ˜áˆáŠ¨á‰±',
    salaryRange: 'á‹¨á‹°áˆ˜á‹ˆá‹ áŠ­áˆáˆ',
    posted: 'á‹¨á‰°áˆˆáŒ áˆ',
    ago: 'á‰ áŠá‰µ',
    noJobsFound: 'áˆáŠ•áˆ áˆµáˆ«á‹Žá‰½ áŠ áˆá‰°áŒˆáŠ™áˆ',
    filterJobs: 'áˆµáˆ«á‹Žá‰½áŠ• áŠ áŒ£áˆ«',
    sortBy: 'á‹°áˆ­á‹µáˆ­ á‰ ',
    clearAll: 'áˆáˆ‰áŠ•áˆ áŠ áŒ½á‹³',
    // Companies page
    companies: 'áŠ©á‰£áŠ•á‹«á‹Žá‰½',
    viewAll: 'áˆáˆ‰áŠ•áˆ á‹­áˆ˜áˆáŠ¨á‰±',
    noCompaniesFound: 'áˆáŠ•áˆ áŠ©á‰£áŠ•á‹«á‹Žá‰½ áŠ áˆá‰°áŒˆáŠ™áˆ',
    // Settings page
    settings: 'á‰…áŠ•á‰¥áˆ®á‰½',
    profile: 'áˆ˜áŒˆáˆˆáŒ«',
    notifications: 'áˆ›áˆ³á‹ˆá‰‚á‹«á‹Žá‰½',
    theme: 'áŒˆáŒ½á‰³',
    logout: 'á‹áŒ£',
    about: 'áˆµáˆˆ',
    privacy: 'á‹¨áŒáˆ‹á‹ŠáŠá‰µ á–áˆŠáˆ²',
    terms: 'á‹¨áŠ áŒˆáˆáŒáˆŽá‰µ á‹áˆ',
    // Bookmarks
    bookmarks: 'á‹¨á‰°á‰€áˆ˜áŒ¡',
    bookmark: 'áˆáˆáŠ­á‰µ áŠ á‹µáˆ­áŒ',
    save: 'áŠ áˆµá‰€áˆáŒ¥',
    saved: 'á‰°á‰€áˆáŒ§áˆ',
    remove: 'áŠ áˆµá‹ˆáŒá‹µ',
    // Common
    jobs: 'áˆµáˆ«á‹Žá‰½',
    search: 'áˆáˆáŒ',
    filter: 'áŠ áŒ£áˆ«',
    apply: 'á‹«áˆ˜áˆáŠ­á‰±',
    company: 'áŠ©á‰£áŠ•á‹«',
    salary: 'á‹°áˆ˜á‹ˆá‹',
    description: 'áˆ˜áŒáˆˆáŒ«',
    requirements: 'áˆ˜áˆµáˆáˆ­á‰¶á‰½'
  },
  ti: { // Tigrigna
    appTitle: 'áŠ•á‰¥ áˆµáˆ«áˆ•á‰²',
    searchPlaceholder: 'áˆµáˆ«áˆ•á‰² á‹µáˆˆ...',
    login: 'áŠ¥á‰°',
    signUp: 'áˆá‹áŒˆá‰£',
    exploreChannels: 'ðŸš€ á‹¨á‰´áˆŒáŒáˆ«áˆ áˆ˜áˆ­áˆ”á‰³á‰µ áˆ­áŠ£',
    swipeHint: 'â† á‰°á‹ˆáˆ³áŠº áˆ˜áˆ­áˆ”á‰³á‰µ áŠ•áˆáˆ­áŠ£á‹­ áŠ£áŠ•áˆ¸áˆ«áˆ½áˆ­ â†’',
    recentJobs: 'áŠ“á‹­ áˆ“á‹³áˆ½ áˆµáˆ«áˆ•á‰²',
    jobsFound: 'áˆµáˆ«áˆ•á‰² á‰°áˆ¨áŠºá‰¦áˆ',
    loading: 'áˆµáˆ«áˆ•á‰² á‹­áŒ½á‹“áŠ‘ áŠ£áˆˆá‹‰...',
    categories: 'áˆá‹µá‰£á‰µ',
    contractType: 'á‹“á‹­áŠá‰µ áˆ°áŠ•á‹±',
    location: 'á‰¦á‰³',
    remoteJobs: 'áŠ“á‹­ áˆ­áˆ‘á‰• áˆµáˆ«áˆ•á‰²',
    clearFilters: 'áˆ˜áŒ»áˆ­á‹«á‰³á‰µ áˆ°áˆ­á‹',
    adminLogin: 'áŠ“á‹­ áŠ£áˆ˜áˆ“á‹³áˆª áˆ˜áŠ¥á‰°á‹Š',
    email: 'áŠ¢áˆ˜á‹­áˆ',
    password: 'áˆ˜áˆ•áˆˆáŠ á‰ƒáˆ',
    loginButton: 'áŠ¥á‰°',
    loginError: 'áŠ¢áˆ˜á‹­áˆáŠ• áˆ˜áˆ•áˆˆáŠ á‰ƒáˆáŠ• áŠ£áŠ¥á‰±',
    invalidCredentials: 'á‹˜á‹­á‰…áŠ‘á‹• áŠ¢áˆ˜á‹­áˆ á‹ˆá‹­ áˆ˜áˆ•áˆˆáŠ á‰ƒáˆ',
    telegramChannel: 'á‹¨á‰´áˆŒáŒáˆ«áˆ áˆ˜áˆ­áˆ”',
    members: 'áŠ£á‰£áˆ‹á‰µ',
    darkMode: 'áŒ¸áˆáˆ›á‰µ áŒˆáŒ½á‰³',
    language: 'á‰‹áŠ•á‰‹',
    downloadPlayStore: 'á•áˆŒá‹­ áˆµá‰¶áˆ­',
    downloadAppStore: 'áŠ á• áˆµá‰¶áˆ­',
    // Jobs page
    employmentType: 'á‹“á‹­áŠá‰µ áˆµáˆ«áˆ•',
    workMode: 'áŠ£áŒˆá‰£á‰¥ áˆµáˆ«áˆ•',
    fullTime: 'áˆáˆ‰áŠ¥ áŒá‹œ',
    partTime: 'áŠ­á‹áˆ áŒá‹œ',
    contract: 'áˆ°áŠ•á‹²',
    remote: 'áˆ­áˆ‘á‰•',
    onSite: 'áŠ£á‰¥ á‰¦á‰³áŠ¡',
    hybrid: 'á‰°á‹°áˆšáˆ©',
    applyNow: 'áˆ•áŒ‚ áŠ£áˆ˜áˆáŠ­á‰µ',
    shareJob: 'áˆµáˆ«áˆ• áŠ£áŠ«ááˆ',
    viewDetails: 'á‹áˆ­á‹áˆ­ áˆ­áŠ£á‹­',
    salaryRange: 'á‹°áˆžá‹ áˆ˜áŒ áŠ•',
    posted: 'á‰°áˆˆáŒ¢á‰',
    ago: 'á‰…á‹µáˆš',
    noJobsFound: 'áˆµáˆ«áˆ•á‰² áŠ£á‹­á‰°áˆ¨áŠ¸á‰ áŠ•',
    filterJobs: 'áˆµáˆ«áˆ•á‰² áˆáˆ­áŒ«',
    sortBy: 'á‹°áˆ­á‹µáˆ­ á‰¥',
    clearAll: 'áŠ©áˆ‰ áˆ°áˆ­á‹',
    // Companies page
    companies: 'á‰µáŠ«áˆ‹á‰µ',
    viewAll: 'áŠ©áˆ‰ áˆ­áŠ£á‹­',
    noCompaniesFound: 'á‰µáŠ«áˆ‹á‰µ áŠ£á‹­á‰°áˆ¨áŠ¸á‰¡áŠ•',
    // Settings page
    settings: 'áŠ£á‹ˆáˆƒáˆ…á‰£',
    profile: 'áˆ˜áŒáˆˆáŒº',
    notifications: 'áˆ˜áŒ áŠ•á‰€á‰•á‰³',
    theme: 'áŒˆáŒ½á‰³',
    logout: 'á‹áŒ»áŠ¥',
    about: 'á‰¥á‹›á‹•á‰£',
    privacy: 'á–áˆŠáˆ² á•áˆ«á‹­á‰¨áˆ²',
    terms: 'á‹á‹•áˆ áŠ£áŒˆáˆáŒáˆŽá‰µ',
    // Bookmarks
    bookmarks: 'á‹á‰°á‰áˆ˜áŒ¡',
    bookmark: 'áˆáˆáŠ­á‰µ áŒá‰ áˆ­',
    save: 'áŠ£á‰áˆáŒ¥',
    saved: 'á‰°á‰áˆšáŒ¡',
    remove: 'áŠ£áˆáŒáˆµ',
    // Common
    jobs: 'áˆµáˆ«áˆ•á‰²',
    search: 'á‹µáˆˆ',
    filter: 'áˆáˆ­áŒ«',
    apply: 'áŠ£áˆ˜áˆáŠ­á‰µ',
    company: 'á‰µáŠ«áˆ',
    salary: 'á‹°áˆžá‹',
    description: 'áˆ˜áŒáˆˆáŒº',
    requirements: 'áˆ¨á‰›áˆ’á‰³á‰µ'
  },
  or: { // Oromifa
    appTitle: 'Niib Hojii',
    searchPlaceholder: 'Hojii barbaadi...',
    login: 'Seeni',
    signUp: 'Galmaa\'i',
    exploreChannels: 'ðŸš€ Chaanalii Telegram qoradhaa',
    swipeHint: 'â† Chaanalii dabalataa argachuuf garagali â†’',
    recentJobs: 'Hojii Yeroo Dhiyoo',
    jobsFound: 'hojiin argame',
    loading: 'Hojiin ni fe\'ama...',
    categories: 'Gosa',
    contractType: 'Gosa Kontraata',
    location: 'Bakka',
    remoteJobs: 'Hojii Fagoo',
    clearFilters: 'Calalchiisa haqxi',
    adminLogin: 'Seensa Bulchiinsa',
    email: 'Imeelii',
    password: 'Jecha Icciitii',
    loginButton: 'Seeni',
    loginError: 'Imeelii fi jecha icciitii galchi',
    invalidCredentials: 'Imeelii ykn jecha icciitii dogoggoraa',
    telegramChannel: 'Chaanalii Telegram',
    members: 'miseensa',
    darkMode: 'Haala Dukkana',
    language: 'Afaan',
    downloadPlayStore: 'Play Store',
    downloadAppStore: 'App Store',
    // Jobs page
    employmentType: 'Gosa Hojii',
    workMode: 'Akkaataa Hojii',
    fullTime: 'Guutuu Yeroo',
    partTime: 'Yeroo Muraasa',
    contract: 'Kontraata',
    remote: 'Fagoo',
    onSite: 'Bakka Hojii irratti',
    hybrid: 'Walitti makame',
    applyNow: 'Amma iyyannaa galchi',
    shareJob: 'Hojii qoodaa',
    viewDetails: 'Bal\'ina ilaali',
    salaryRange: 'Hangi Mindaa',
    posted: 'Maxxanfame',
    ago: 'dura',
    noJobsFound: 'Hojiin hin argamne',
    filterJobs: 'Hojii filannoo',
    sortBy: 'Tartiiba',
    clearAll: 'Hunda haqxi',
    // Companies page
    companies: 'Dhaabbilee',
    viewAll: 'Hunda ilaali',
    noCompaniesFound: 'Dhaabbilee hin argamne',
    // Settings page
    settings: 'Qindaa\'ina',
    profile: 'Ibsa',
    notifications: 'Beeksisa',
    theme: 'Bifa',
    logout: 'Ba\'i',
    about: 'Waa\'ee',
    privacy: 'Imaammata Dhuunfaa',
    terms: 'Waliigaltee Tajaajila',
    // Bookmarks
    bookmarks: 'Kan Kuufaman',
    bookmark: 'Mallattoo godhi',
    save: 'Kuufadhu',
    saved: 'Kuufameera',
    remove: 'Haqi',
    // Common
    jobs: 'Hojii',
    search: 'Barbaadi',
    filter: 'Filannoo',
    apply: 'Iyyannaa galchi',
    company: 'Dhaabbata',
    salary: 'Mindaa',
    description: 'Ibsa',
    requirements: 'Ulaagaalee'
  }
};

// Helper function to get current colors based on theme
const getColors = (isDarkMode: boolean) => isDarkMode ? darkColors : lightColors;

// Login Screen
function LoginScreen({ navigation, route }: any) {
  const initialEmail = route?.params?.prefillEmail || '';
  const [email, setEmail] = useState(initialEmail);
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);

  const handleLogin = async () => {
    if (!email || !password) {
      Alert.alert('Error', 'Please enter email and password');
      return;
    }

    setLoading(true);
    try {
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      
      // Reload user to get latest email verification status
      await user.reload();
      const updatedUser = auth.currentUser;
      
      // Check if email is verified
      if (!updatedUser?.emailVerified) {
        // User hasn't verified their email
        // Don't sign out - keep them signed in to resend verification
        navigation.navigate('VerificationRequired', { userEmail: email, keepSignedIn: true });
        setLoading(false);
        return;
      }
      
      // Update isVerified in Firestore if email is verified but DB shows false
      const userDoc = await getDoc(doc(db, 'users', user.uid));
      if (userDoc.exists()) {
        const userData = userDoc.data();
        
        console.log('User data from Firestore:', {
          role: userData.role,
          isVerified: userData.isVerified,
          isActive: userData.isActive
        });
        
        // Update isVerified if it's false but email is verified
        if (!userData.isVerified && updatedUser.emailVerified) {
          await updateDoc(doc(db, 'users', user.uid), {
            isVerified: true,
            updatedAt: new Date()
          });
          console.log('âœ… Updated isVerified to true in Firestore');
        }
        
        // Check user role and redirect accordingly
        if (userData.role === 'superadmin') {
          console.log('Navigating to AdminPanel');
          navigation.replace('AdminPanel');
        } else if (userData.isVerified && userData.isActive) {
          // Verified and active users go to Jobs page
          console.log('Navigating to Jobs page');
          navigation.replace('Jobs');
        } else if (!userData.isActive) {
          Alert.alert('Account Inactive', 'Your account has been deactivated. Please contact support.');
          await signOut(auth);
        } else {
          Alert.alert('Access Denied', 'Please verify your email to continue');
          await signOut(auth);
        }
      } else {
        console.error('User profile not found in Firestore');
        Alert.alert('Error', 'User profile not found');
        await signOut(auth);
      }
    } catch (error: any) {
      Alert.alert('Login Failed', error.message);
    }
    setLoading(false);
  };

  const handleGoogleLogin = async () => {
    try {
      const provider = new GoogleAuthProvider();
      const result = await signInWithPopup(auth, provider);
      const user = result.user;

      // Check if user is admin
      const userDoc = await getDoc(doc(db, 'users', user.uid));
      if (userDoc.exists() && userDoc.data().role === 'superadmin') {
        navigation.replace('AdminPanel');
      } else {
        Alert.alert('Access Denied', 'You do not have admin privileges');
        await signOut(auth);
      }
    } catch (error: any) {
      // If the Google account email already exists with a different sign-in method
      if (error.code === 'auth/account-exists-with-different-credential') {
        const emailFromError = error.customData?.email || error.email || '';
        Alert.alert(
          'Account Exists',
          'An account already exists with this email. Please sign in using your email and password. We will prefill your email on the login screen.',
          [
            { text: 'Cancel', style: 'cancel' },
            { text: 'Go to Login', onPress: () => navigation.navigate('Login', { prefillEmail: emailFromError }) }
          ]
        );
      } else {
        Alert.alert('Google Login Failed', error.message);
      }
    }
  };

  return (
    <SafeAreaView style={styles.container}>
      <View style={styles.loginContainer}>
        {/* Header */}
        <View style={styles.loginHeader}>
          <Image source={require('./assets/favicon.png')} style={styles.loginLogoImage} />
          <Text style={styles.loginTitle}>NibJobs</Text>
          <Text style={styles.loginSubtitle}>Administrator Login</Text>
        </View>
        
        {/* Login Form */}
        <View style={styles.loginForm}>
          <View style={styles.inputContainer}>
            <View style={styles.inputGroup}>
              <Icon name="email" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
              <TextInput
                style={styles.modernInput}
                value={email}
                onChangeText={setEmail}
                placeholder="Email address"
                placeholderTextColor={lightColors.warmGray}
                keyboardType="email-address"
                autoCapitalize="none"
              />
            </View>
          </View>

          <View style={styles.inputContainer}>
            <View style={styles.inputGroup}>
              <Icon name="lock" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
              <TextInput
                style={styles.modernInput}
                value={password}
                onChangeText={setPassword}
                placeholder="Password"
                placeholderTextColor={lightColors.warmGray}
                secureTextEntry
              />
            </View>
          </View>

          <TouchableOpacity 
            style={[styles.modernLoginButton, loading && styles.loginButtonDisabled]} 
            onPress={handleLogin}
            disabled={loading}
          >
            {loading ? (
              <View style={styles.loadingButtonContent}>
                <Text style={styles.modernLoginButtonText}>Signing In...</Text>
              </View>
            ) : (
              <View style={styles.buttonContent}>
                <Text style={styles.modernLoginButtonText}>Sign In</Text>
                <Icon name="arrow-forward" size={20} color={lightColors.white} />
              </View>
            )}
          </TouchableOpacity>

          {/* Forgot Password Link */}
          <TouchableOpacity 
            style={styles.forgotPasswordLink}
            onPress={() => navigation.navigate('ForgotPassword')}
          >
            <Text style={styles.forgotPasswordText}>Forgot Password?</Text>
          </TouchableOpacity>

          {/* Divider */}
          <View style={styles.dividerContainer}>
            <View style={styles.divider} />
            <Text style={styles.dividerText}>OR</Text>
            <View style={styles.divider} />
          </View>

          {/* Google Sign In Button */}
          <TouchableOpacity 
            style={styles.googleButton}
            onPress={handleGoogleLogin}
          >
            <Image 
              source={{ uri: 'https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg' }}
              style={{ width: 20, height: 20, marginRight: 8 }}
            />
            <Text style={styles.googleButtonText}>Sign in with Google</Text>
          </TouchableOpacity>

          {/* Signup Link */}
          <View style={styles.signupLinkContainer}>
            <Text style={styles.signupLinkText}>Don't have an account? </Text>
            <TouchableOpacity onPress={() => navigation.navigate('Signup')}>
              <Text style={styles.signupLink}>Sign Up</Text>
            </TouchableOpacity>
          </View>
        </View>

        {/* Footer */}
        <TouchableOpacity 
          style={styles.backToHome}
          onPress={() => navigation.navigate('Home')}
        >
          <Icon name="arrow-back" size={16} color={lightColors.softBlue} />
          <Text style={styles.backToHomeText}>Back to Home</Text>
        </TouchableOpacity>
      </View>
    </SafeAreaView>
  );
}

// Verification Required Screen
function VerificationRequiredScreen({ route, navigation }: any) {
  const { userEmail, keepSignedIn } = route.params || {};
  const [loading, setLoading] = useState(false);
  const [emailSent, setEmailSent] = useState(false);

  // Sign out when navigating back to login or home
  const handleBackToLogin = async () => {
    const auth = getAuth();
    if (auth.currentUser) {
      await signOut(auth);
    }
    navigation.navigate('Login');
  };

  const handleBackToHome = async () => {
    const auth = getAuth();
    if (auth.currentUser) {
      await signOut(auth);
    }
    navigation.navigate('Home');
  };

  const handleResendEmail = async () => {
    if (!userEmail) {
      Alert.alert('Error', 'Email address is required');
      return;
    }

    setLoading(true);

    try {
      const auth = getAuth();
      const user = auth.currentUser;
      
      if (!user) {
        Alert.alert(
          'Error', 
          'You need to be signed in to resend verification email. Please try logging in again.'
        );
        setLoading(false);
        navigation.navigate('Login');
        return;
      }

      // Send verification email with action code settings
      await sendEmailVerification(user, {
        url: 'http://localhost:19006/login',
        handleCodeInApp: false,
      });

      setEmailSent(true);
      
      Alert.alert(
        'Email Sent!',
        `A new verification email has been sent to ${userEmail}. Please check your inbox and spam folder.`,
        [{ text: 'OK' }]
      );
    } catch (error: any) {
      console.error('Error resending verification email:', error);
      
      let errorMessage = 'Failed to send verification email. Please try again.';
      
      if (error.code === 'auth/too-many-requests') {
        errorMessage = 'Too many requests. Please wait a moment before trying again.';
      }
      
      Alert.alert('Error', errorMessage);
    } finally {
      setLoading(false);
    }
  };

  return (
    <SafeAreaView style={styles.container}>
      <ScrollView contentContainerStyle={styles.loginContainer}>
        <View style={styles.loginHeader}>
          <Image source={require('./assets/favicon.png')} style={styles.loginLogoImage} />
          <Text style={styles.loginTitle}>NibJobs</Text>
          <Text style={styles.loginSubtitle}>Email Verification Required</Text>
        </View>

        <View style={styles.loginForm}>
          <View style={styles.verificationMessageContainer}>
            <Icon name="mark-email-unread" size={64} color={lightColors.beeYellow} style={{ marginBottom: 20 }} />
            <Text style={styles.verificationTitle}>Email Not Verified</Text>
            <Text style={styles.verificationMessage}>
              Your email address has not been verified yet.
            </Text>
            {userEmail && (
              <Text style={styles.verificationEmail}>{userEmail}</Text>
            )}
            <Text style={styles.verificationMessage}>
              Please check your inbox (and spam folder) for the verification email and click the link to verify your account.
            </Text>

            {emailSent && (
              <View style={styles.successMessageContainer}>
                <Icon name="check-circle" size={20} color={lightColors.success} style={{ marginRight: 8 }} />
                <Text style={styles.successMessageText}>
                  Verification email sent! Check your inbox.
                </Text>
              </View>
            )}
            
            <TouchableOpacity 
              style={[styles.modernLoginButton, loading && styles.buttonDisabled]}
              onPress={handleResendEmail}
              disabled={loading}
            >
              <View style={styles.buttonContent}>
                {loading ? (
                  <ActivityIndicator size="small" color={lightColors.deepNavy} />
                ) : (
                  <>
                    <Icon name="email" size={20} color={lightColors.deepNavy} style={{ marginRight: 8 }} />
                    <Text style={styles.modernLoginButtonText}>Resend Verification Email</Text>
                  </>
                )}
              </View>
            </TouchableOpacity>

            <TouchableOpacity 
              style={[styles.modernSecondaryButton, { marginTop: 40 }]}
              onPress={handleBackToLogin}
            >
              <Text style={styles.modernSecondaryButtonText}>Back to Login</Text>
            </TouchableOpacity>

            <TouchableOpacity 
              style={styles.backToHome}
              onPress={handleBackToHome}
            >
              <Icon name="arrow-back" size={16} color={lightColors.softBlue} />
              <Text style={styles.backToHomeText}>Back to Home</Text>
            </TouchableOpacity>
          </View>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Forgot Password Screen
function ForgotPasswordScreen({ navigation }: any) {
  const [email, setEmail] = useState('');
  const [loading, setLoading] = useState(false);
  const [emailSent, setEmailSent] = useState(false);

  const handleResetPassword = async () => {
    if (!email) {
      Alert.alert('Error', 'Please enter your email address');
      return;
    }

    setLoading(true);
    try {
      const actionCodeSettings = {
        url: `${window.location.origin}/login`,
        handleCodeInApp: false,
      };
      
      await sendPasswordResetEmail(auth, email, actionCodeSettings);
      setEmailSent(true);
    } catch (error: any) {
      if (error.code === 'auth/user-not-found') {
        Alert.alert('Error', 'No account found with this email address');
      } else if (error.code === 'auth/invalid-email') {
        Alert.alert('Error', 'Invalid email address');
      } else {
        Alert.alert('Error', error.message || 'Failed to send password reset email');
      }
    }
    setLoading(false);
  };

  return (
    <SafeAreaView style={styles.container}>
      <ScrollView contentContainerStyle={styles.loginContainer}>
        {emailSent ? (
          // Password Reset Email Sent
          <>
            <View style={styles.loginHeader}>
              <Image source={require('./assets/favicon.png')} style={styles.loginLogoImage} />
              <Text style={styles.loginTitle}>NibJobs</Text>
              <Text style={styles.loginSubtitle}>Check Your Email</Text>
            </View>

            <View style={styles.loginForm}>
              <View style={styles.verificationMessageContainer}>
                <Icon name="mark-email-read" size={64} color={lightColors.beeYellow} style={{ marginBottom: 20 }} />
                <Text style={styles.verificationTitle}>Password Reset Email Sent!</Text>
                <Text style={styles.verificationMessage}>
                  We've sent password reset instructions to:
                </Text>
                <Text style={styles.verificationEmail}>{email}</Text>
                <Text style={styles.verificationMessage}>
                  Please check your inbox (and spam folder) and follow the link to reset your password.
                </Text>
                
                <TouchableOpacity 
                  style={styles.modernLoginButton}
                  onPress={() => navigation.navigate('Login')}
                >
                  <View style={styles.buttonContent}>
                    <Text style={styles.modernLoginButtonText}>Back to Login</Text>
                    <Icon name="arrow-forward" size={20} color={lightColors.deepNavy} />
                  </View>
                </TouchableOpacity>

                <TouchableOpacity 
                  style={styles.backToHome}
                  onPress={() => navigation.navigate('Home')}
                >
                  <Icon name="arrow-back" size={16} color={lightColors.softBlue} />
                  <Text style={styles.backToHomeText}>Back to Home</Text>
                </TouchableOpacity>
              </View>
            </View>
          </>
        ) : (
          // Forgot Password Form
          <>
            <View style={styles.loginHeader}>
              <Image source={require('./assets/favicon.png')} style={styles.loginLogoImage} />
              <Text style={styles.loginTitle}>NibJobs</Text>
              <Text style={styles.loginSubtitle}>Reset Your Password</Text>
            </View>

            <View style={styles.loginForm}>
              <Text style={styles.forgotPasswordDescription}>
                Enter your email address and we'll send you instructions to reset your password.
              </Text>

              <View style={styles.inputContainer}>
                <View style={styles.inputGroup}>
                  <Icon name="email" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
                  <TextInput
                    style={styles.modernInput}
                    value={email}
                    onChangeText={setEmail}
                    placeholder="Email address"
                    placeholderTextColor={lightColors.warmGray}
                    keyboardType="email-address"
                    autoCapitalize="none"
                  />
                </View>
              </View>

              <TouchableOpacity 
                style={[styles.modernLoginButton, loading && styles.loginButtonDisabled]}
                onPress={handleResetPassword}
                disabled={loading}
              >
                {loading ? (
                  <View style={styles.loadingButtonContent}>
                    <Text style={styles.modernLoginButtonText}>Sending...</Text>
                  </View>
                ) : (
                  <View style={styles.buttonContent}>
                    <Text style={styles.modernLoginButtonText}>Send Reset Link</Text>
                    <Icon name="arrow-forward" size={20} color={lightColors.deepNavy} />
                  </View>
                )}
              </TouchableOpacity>

              <View style={{ alignItems: 'center', marginTop: 40 }}>
                <TouchableOpacity 
                  style={[styles.modernSecondaryButton, { alignSelf: 'center', width: 'auto', paddingHorizontal: 32 }]}
                  onPress={() => navigation.navigate('Login')}
                >
                  <Text style={styles.modernSecondaryButtonText}>Back to Login</Text>
                </TouchableOpacity>
              </View>

              <TouchableOpacity 
                style={styles.backToHome}
                onPress={() => navigation.navigate('Home')}
              >
                <Icon name="arrow-back" size={16} color={lightColors.softBlue} />
                <Text style={styles.backToHomeText}>Back to Home</Text>
              </TouchableOpacity>
            </View>
          </>
        )}
      </ScrollView>
    </SafeAreaView>
  );
}

// Signup Screen
function SignupScreen({ navigation, route }: any) {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [fullName, setFullName] = useState('');
  const [loading, setLoading] = useState(false);
  const [emailSent, setEmailSent] = useState(false);
  const [userEmail, setUserEmail] = useState('');
  
  // Get message from navigation params if available
  const message = route?.params?.message;
  
  // Generate username from full name
  const generateUsernameFromName = (name: string) => {
    // Remove spaces and special characters, convert to lowercase
    const cleanName = name.replace(/[^a-zA-Z0-9]/g, '').toLowerCase();
    // Add random 4-digit number
    const randomNum = Math.floor(1000 + Math.random() * 9000);
    return `${cleanName}${randomNum}`;
  };
  
  // Ensure username is unique
  const generateUniqueUsername = async (baseName: string) => {
    let username = generateUsernameFromName(baseName);
    let isUnique = false;
    let attempts = 0;
    
    while (!isUnique && attempts < 10) {
      const usernameQuery = dbQuery(
        collection(db, 'users'),
        where('username', '==', username)
      );
      const querySnapshot = await getDocs(usernameQuery);
      
      if (querySnapshot.empty) {
        isUnique = true;
      } else {
        // Generate new username with different number
        username = generateUsernameFromName(baseName);
        attempts++;
      }
    }
    
    return username;
  };

  const handleSignup = async () => {
    if (!email || !password || !fullName) {
      Alert.alert('Error', 'Please fill in all fields');
      return;
    }

    if (password !== confirmPassword) {
      Alert.alert('Error', 'Passwords do not match');
      return;
    }

    if (password.length < 6) {
      Alert.alert('Error', 'Password must be at least 6 characters long');
      return;
    }

    setLoading(true);
    try {
      console.log('ðŸ”„ Creating user account for:', email);
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      
      // Send email verification
      console.log('ðŸ“§ Sending verification email to:', user.email);
      try {
        const actionCodeSettings = {
          url: `${window.location.origin}/login`, // Redirect to login page after verification
          handleCodeInApp: false,
        };
        await sendEmailVerification(user, actionCodeSettings);
        console.log('âœ… Verification email sent successfully!');
      } catch (emailError: any) {
        console.error('âŒ Failed to send verification email:', emailError);
      }
      
      // Create user document in Firestore matching superadmin schema
      console.log('ðŸ’¾ Creating user profile in Firestore...');
      
      // Generate unique username from full name
      const generatedUsername = await generateUniqueUsername(fullName);
      
      await setDoc(doc(db, 'users', user.uid), {
        uid: user.uid,
        email: email,
        displayName: fullName,
        username: generatedUsername,
        role: 'user',
        subscriptionId: 'free',
        subscriptionStatus: 'active',
        subscriptionStartDate: new Date(),
        subscriptionEndDate: null,
        isVerified: false,
        isActive: true,
        lastLogin: new Date(),
        permissions: [],
        profile: {
          avatar: '',
          bio: '',
          phone: ''
        },
        fcmTokens: [],
        selectedCategories: [],
        isNotificationsEnabled: false,
        createdAt: new Date(),
        updatedAt: new Date(),
      });
      console.log('âœ… User profile created in Firestore');
      
      // Set state to show verification message
      setUserEmail(email);
      setEmailSent(true);
    } catch (error: any) {
      console.error('âŒ Signup failed:', error);
      if (error.code === 'auth/email-already-in-use') {
        Alert.alert('Error', 'This email is already registered');
      } else if (error.code === 'auth/invalid-email') {
        Alert.alert('Error', 'Invalid email address');
      } else {
        Alert.alert('Signup Failed', error.message);
      }
    }
    setLoading(false);
  };

  const handleGoogleSignup = async () => {
    try {
      const provider = new GoogleAuthProvider();
      const result = await signInWithPopup(auth, provider);
      const user = result.user;
      
      // Check if user document exists
      const userDocRef = doc(db, 'users', user.uid);
      const userDoc = await getDoc(userDocRef);
      
      if (!userDoc.exists()) {
        // Generate username from Google display name
        const displayName = user.displayName || 'User';
        const generatedUsername = await generateUniqueUsername(displayName);
        
        // Create new user document for first-time Google sign-in
        await setDoc(userDocRef, {
          uid: user.uid,
          email: user.email || '',
          displayName: user.displayName || 'User',
          username: generatedUsername,
          role: 'reader',
          subscriptionId: 'free',
          subscriptionStatus: 'active',
          subscriptionStartDate: new Date(),
          subscriptionEndDate: null,
          isVerified: true, // Google users are pre-verified
          isActive: true,
          lastLogin: new Date(),
          permissions: [],
          profile: {
            avatar: user.photoURL || '',
            bio: '',
            phone: ''
          },
          fcmTokens: [],
          selectedCategories: [],
          isNotificationsEnabled: false,
          createdAt: new Date(),
          updatedAt: new Date(),
        });
        Alert.alert('Success', 'Signed up with Google successfully!');
      } else {
        // User already exists (previously signed up with email/password)
        // Update their last login and verification status
        await setDoc(userDocRef, {
          lastLogin: new Date(),
          isVerified: true, // Mark as verified since they're using Google
          updatedAt: new Date(),
        }, { merge: true });
        Alert.alert('Success', 'Logged in successfully!');
      }
      
      navigation.replace('Home');
    } catch (error: any) {
      // Handle account-exists-with-different-credential error
      if (error.code === 'auth/account-exists-with-different-credential') {
        Alert.alert(
          'Account Exists',
          'An account already exists with this email. Please sign in using your original method (email/password) or contact support to link your accounts.',
          [{ text: 'OK' }]
        );
      } else {
        Alert.alert('Google Sign-In Failed', error.message);
      }
    }
  };

  return (
    <SafeAreaView style={styles.container}>
      <ScrollView contentContainerStyle={styles.loginContainer}>
        {emailSent ? (
          // Verification Email Sent Message
          <>
            <View style={styles.loginHeader}>
              <Image source={require('./assets/favicon.png')} style={styles.loginLogoImage} />
              <Text style={styles.loginTitle}>NibJobs</Text>
              <Text style={styles.loginSubtitle}>Check Your Email</Text>
            </View>

            <View style={styles.loginForm}>
              <View style={styles.verificationMessageContainer}>
                <Icon name="email" size={64} color={lightColors.beeYellow} style={{ marginBottom: 20 }} />
                <Text style={styles.verificationTitle}>Verification Email Sent!</Text>
                <Text style={styles.verificationMessage}>
                  We've sent a verification email to:
                </Text>
                <Text style={styles.verificationEmail}>{userEmail}</Text>
                <Text style={styles.verificationMessage}>
                  Please check your inbox (and spam folder) and click the verification link to activate your account.
                </Text>
                
                <TouchableOpacity 
                  style={styles.modernLoginButton}
                  onPress={() => navigation.replace('Login')}
                >
                  <View style={styles.buttonContent}>
                    <Text style={styles.modernLoginButtonText}>Go to Login</Text>
                    <Icon name="arrow-forward" size={20} color={lightColors.deepNavy} />
                  </View>
                </TouchableOpacity>

                <TouchableOpacity 
                  style={styles.backToHome}
                  onPress={() => navigation.navigate('Home')}
                >
                  <Icon name="arrow-back" size={16} color={lightColors.softBlue} />
                  <Text style={styles.backToHomeText}>Back to Home</Text>
                </TouchableOpacity>
              </View>
            </View>
          </>
        ) : (
          // Signup Form
          <>
            <View style={styles.loginHeader}>
              <Image source={require('./assets/favicon.png')} style={styles.loginLogoImage} />
              <Text style={styles.loginTitle}>NibJobs</Text>
              <Text style={styles.loginSubtitle}>Create Your Account</Text>
            </View>
            
            {message && (
              <View style={{
                backgroundColor: lightColors.beeYellow,
                padding: 16,
                marginHorizontal: 20,
                marginBottom: 20,
                borderRadius: 12,
                flexDirection: 'row',
                alignItems: 'center',
                gap: 12,
              }}>
                <Icon name="info" size={24} color={lightColors.deepNavy} />
                <Text style={{
                  flex: 1,
                  fontSize: 14,
                  color: lightColors.deepNavy,
                  fontFamily: 'Inter-Medium',
                  lineHeight: 20,
                }}>
                  {message}
                </Text>
              </View>
            )}
            
            <View style={styles.loginForm}>
              <View style={styles.inputContainer}>
                <View style={styles.inputGroup}>
                  <Icon name="person" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
                  <TextInput
                    style={styles.modernInput}
                    value={fullName}
                    onChangeText={setFullName}
                    placeholder="Full Name"
                    placeholderTextColor={lightColors.warmGray}
                    autoCapitalize="words"
                  />
                </View>
              </View>

              <View style={styles.inputContainer}>
                <View style={styles.inputGroup}>
                  <Icon name="email" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
                  <TextInput
                    style={styles.modernInput}
                    value={email}
                    onChangeText={setEmail}
                    placeholder="Email address"
                    placeholderTextColor={lightColors.warmGray}
                    keyboardType="email-address"
                    autoCapitalize="none"
                  />
                </View>
              </View>

              <View style={styles.inputContainer}>
                <View style={styles.inputGroup}>
                  <Icon name="lock" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
                  <TextInput
                    style={styles.modernInput}
                    value={password}
                    onChangeText={setPassword}
                    placeholder="Password (min 6 characters)"
                    placeholderTextColor={lightColors.warmGray}
                    secureTextEntry
                  />
                </View>
              </View>

              <View style={styles.inputContainer}>
                <View style={styles.inputGroup}>
                  <Icon name="lock-outline" size={20} color={lightColors.warmGray} style={styles.inputIcon} />
                  <TextInput
                    style={styles.modernInput}
                    value={confirmPassword}
                    onChangeText={setConfirmPassword}
                    placeholder="Confirm Password"
                    placeholderTextColor={lightColors.warmGray}
                    secureTextEntry
                  />
                </View>
              </View>

              <TouchableOpacity 
                style={[styles.modernLoginButton, loading && styles.loginButtonDisabled]} 
                onPress={handleSignup}
                disabled={loading}
              >
                {loading ? (
                  <View style={styles.loadingButtonContent}>
                    <Text style={styles.modernLoginButtonText}>Creating Account...</Text>
                  </View>
                ) : (
                  <View style={styles.buttonContent}>
                    <Text style={styles.modernLoginButtonText}>Sign Up</Text>
                    <Icon name="arrow-forward" size={20} color={lightColors.deepNavy} />
                  </View>
                )}
              </TouchableOpacity>

              {/* Divider */}
              <View style={styles.dividerContainer}>
                <View style={styles.divider} />
                <Text style={styles.dividerText}>OR</Text>
                <View style={styles.divider} />
              </View>

              {/* Google Sign In Button */}
              <TouchableOpacity 
                style={styles.googleButton}
                onPress={handleGoogleSignup}
              >
                <Image 
                  source={{ uri: 'https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg' }}
                  style={{ width: 20, height: 20, marginRight: 8 }}
                />
                <Text style={styles.googleButtonText}>Sign up with Google</Text>
              </TouchableOpacity>

              {/* Login Link */}
              <View style={styles.signupLinkContainer}>
                <Text style={styles.signupLinkText}>Already have an account? </Text>
                <TouchableOpacity onPress={() => navigation.navigate('Login')}>
                  <Text style={styles.signupLink}>Log In</Text>
                </TouchableOpacity>
              </View>
            </View>

            {/* Footer */}
            <TouchableOpacity 
              style={styles.backToHome}
              onPress={() => navigation.navigate('Home')}
            >
              <Icon name="arrow-back" size={16} color={lightColors.softBlue} />
              <Text style={styles.backToHomeText}>Back to Home</Text>
            </TouchableOpacity>
          </>
        )}
      </ScrollView>
    </SafeAreaView>
  );
}

// Job Details Screen
function JobDetailsScreen({ route, navigation, isDarkMode, toggleTheme }: any) {
  const { id } = route.params;
  const [job, setJob] = useState<any>(null);
  const [relatedJobs, setRelatedJobs] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [isSaved, setIsSaved] = useState(false);
  const [user, setUser] = useState<any>(null);
  const [userData, setUserData] = useState<any>(null);
  const [bookmarkedJobs, setBookmarkedJobs] = useState<string[]>([]);
  
  // Language states for toolbar
  const [selectedLanguage, setSelectedLanguage] = useState('English');
  const [showLanguageMenu, setShowLanguageMenu] = useState(false);
  
  // Search functionality for toolbar
  const [searchText, setSearchText] = useState('');
  
  // Responsive design
  const [dimensions, setDimensions] = useState(Dimensions.get('window'));
  const isMobile = dimensions.width < 480;
  const isTablet = dimensions.width >= 480 && dimensions.width < 768;
  const isDesktop = dimensions.width >= 768;

  useEffect(() => {
    const subscription = Dimensions.addEventListener('change', ({ window }) => {
      setDimensions(window);
    });
    return () => subscription?.remove();
  }, []);

  // Listen to auth state for toolbar
  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, async (authUser) => {
      if (authUser) {
        setUser(authUser);
        // Fetch bookmarked jobs and user data
        const userDoc = await getDoc(doc(db, 'users', authUser.uid));
        if (userDoc.exists()) {
          const data = userDoc.data();
          setUserData(data);
          setBookmarkedJobs(data.bookmarkedJobs || []);
          setIsSaved(data.bookmarkedJobs?.includes(id) || false);
        }
      } else {
        setUser(null);
        setUserData(null);
        setBookmarkedJobs([]);
      }
    });

    return unsubscribe;
  }, [id]);
  
  const colors = isDarkMode ? darkColors : lightColors;
  
  // Simple helper functions
  const handleLogin = () => navigation.navigate('Login');
  
  const dynamicStyles = StyleSheet.create({
    container: {
      flex: 1,
      backgroundColor: colors.white,
    },
  });


  useEffect(() => {
    const fetchJobDetails = async () => {
      try {
        setLoading(true);
        // Fetch job details
        const jobDoc = await getDoc(doc(db, 'jobs', id));
        if (jobDoc.exists()) {
          const jobData = { id: jobDoc.id, ...jobDoc.data() };
          setJob(jobData);
          
          // Debug: Log available image fields
          console.log('Available image fields:', {
            sourceImageUrl: jobData.sourceImageUrl,
            sourceChannelImageUrl: jobData.sourceChannelImageUrl,
            channelImageUrl: jobData.channelImageUrl
          });
          
          // Check if job is saved
          const currentUser = auth.currentUser;
          if (currentUser) {
            const userDoc = await getDoc(doc(db, 'users', currentUser.uid));
            const savedJobs = userDoc.data()?.savedJobs || [];
            setIsSaved(savedJobs.includes(id));
          }
          
          // Fetch related jobs (same category, limit 5)
          if ((jobData as any).category || (jobData as any).categoryId) {
            const relatedQuery = dbQuery(
              collection(db, 'jobs'),
              orderBy('createdAt', 'desc'),
              limit(6)
            );
            const relatedSnapshot = await getDocs(relatedQuery);
            const related = relatedSnapshot.docs
              .map(doc => ({ id: doc.id, ...doc.data() as any }))
              .filter((j: any) => 
                j.id !== id && 
                (j.category === (jobData as any).category || j.categoryId === (jobData as any).categoryId)
              )
              .slice(0, 5);
            setRelatedJobs(related);
          }
        } else {
          Alert.alert('Error', 'Job not found');
          navigation.goBack();
        }
      } catch (error) {
        console.error('Error fetching job:', error);
        Alert.alert('Error', 'Failed to load job details');
      } finally {
        setLoading(false);
      }
    };

    if (id) {
      fetchJobDetails();
    }
  }, [id]);

  const handleSaveJob = async () => {
    const currentUser = auth.currentUser;
    if (!currentUser) {
      Alert.alert('Authentication Required', 'Please login to save jobs');
      return;
    }

    try {
      const userRef = doc(db, 'users', currentUser.uid);
      const userDoc = await getDoc(userRef);
      const savedJobs = userDoc.data()?.savedJobs || [];
      
      if (isSaved) {
        // Remove from saved jobs
        await updateDoc(userRef, {
          savedJobs: savedJobs.filter((jobId: string) => jobId !== id)
        });
        setIsSaved(false);
        Alert.alert('Success', 'Job removed from saved jobs');
      } else {
        // Add to saved jobs
        await updateDoc(userRef, {
          savedJobs: [...savedJobs, id]
        });
        setIsSaved(true);
        Alert.alert('Success', 'Job saved successfully');
      }
    } catch (error) {
      console.error('Error saving job:', error);
      Alert.alert('Error', 'Failed to save job');
    }
  };

  const handleShareJob = async () => {
    const jobUrl = `https://nibjobs.com/job/${id}`;
    const message = `Check out this job: ${job.title} at ${job.company}\n${jobUrl}`;
    
    if (typeof navigator !== 'undefined' && navigator.share) {
      try {
        await navigator.share({
          title: job.title,
          text: message,
          url: jobUrl,
        });
      } catch (error) {
        console.log('Error sharing:', error);
      }
    } else {
      // Fallback: copy to clipboard
      Alert.alert('Share', `Job URL: ${jobUrl}`);
    }
  };

  const handleApply = async () => {
    if (!job) return;
    
    // Open Telegram message URL for job applications
    const telegramUrl = job.telegramMessageUrl || job.telegramLink || 'https://t.me/nibjobseth';
    
    try {
      const supported = await Linking.canOpenURL(telegramUrl);
      if (supported) {
        await Linking.openURL(telegramUrl);
      } else {
        // Fallback to window.open for web
        if (typeof window !== 'undefined') {
          window.open(telegramUrl, '_blank');
        } else {
          Alert.alert('Error', 'Unable to open Telegram link');
        }
      }
    } catch (error) {
      console.error('Error opening Telegram link:', error);
      Alert.alert('Error', 'Failed to open Telegram link');
    }
  };

  const formatDate = (date: any) => {
    if (!date) return 'Recently posted';
    if (date.seconds) {
      return new Date(date.seconds * 1000).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    }
    return new Date(date).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  };

  const getTimeAgo = (date: any) => {
    if (!date) return 'Recently';
    const dateObj = date.seconds ? new Date(date.seconds * 1000) : new Date(date);
    const seconds = Math.floor((new Date().getTime() - dateObj.getTime()) / 1000);
    
    let interval = seconds / 31536000;
    if (interval > 1) return Math.floor(interval) + ' years ago';
    interval = seconds / 2592000;
    if (interval > 1) return Math.floor(interval) + ' months ago';
    interval = seconds / 86400;
    if (interval > 1) return Math.floor(interval) + ' days ago';
    interval = seconds / 3600;
    if (interval > 1) return Math.floor(interval) + ' hours ago';
    interval = seconds / 60;
    if (interval > 1) return Math.floor(interval) + ' minutes ago';
    return 'Just now';
  };

  if (loading || !job) {
    return (
      <SafeAreaView style={styles.container}>
        <View style={styles.loadingContainer}>
          <Text style={styles.loadingText}>Loading job details...</Text>
        </View>
      </SafeAreaView>
    );
  }

  return (
    <SafeAreaView style={dynamicStyles.container}>
      {/* Header Toolbar - Same as Jobs Page */}
      <View style={[styles.jobsToolbar, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <View style={styles.jobsToolbarLeft}>
          <TouchableOpacity onPress={() => navigation.navigate('Home')}>
            <Image 
              source={require('./assets/favicon.png')}
              style={styles.toolbarLogo}
              resizeMode="contain"
            />
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Jobs')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Jobs</Text>
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Companies')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Companies</Text>
          </TouchableOpacity>
          
          {/* Search Bar */}
          <View style={[styles.toolbarSearchContainer, { backgroundColor: colors.cream }]}>
            <Icon name="search" size={18} color={colors.warmGray} />
            <TextInput
              style={[styles.toolbarSearchInput, { color: colors.deepNavy }]}
              placeholder="Search jobs..."
              placeholderTextColor={colors.warmGray}
              value={searchText}
              onChangeText={setSearchText}
            />
          </View>
          
          {/* Language Selector */}
          <View style={styles.toolbarLanguageContainer}>
            <TouchableOpacity 
              style={[styles.toolbarLanguageButton, { backgroundColor: colors.cream }]}
              onPress={() => setShowLanguageMenu(!showLanguageMenu)}
            >
              <Icon name="language" size={20} color={colors.deepNavy} />
              <Text style={[styles.toolbarLanguageText, { color: colors.deepNavy }]}>
                {selectedLanguage}
              </Text>
              <Icon name="arrow-drop-down" size={20} color={colors.deepNavy} />
            </TouchableOpacity>
            
            {showLanguageMenu && (
              <View style={[styles.languageMenu, { backgroundColor: colors.white }]}>
                {['English', 'Amharic', 'Oromifa'].map((lang) => (
                  <TouchableOpacity
                    key={lang}
                    style={styles.languageMenuItem}
                    onPress={() => {
                      setSelectedLanguage(lang);
                      setShowLanguageMenu(false);
                    }}
                  >
                    <Text style={[
                      styles.languageMenuItemText,
                      { color: colors.deepNavy },
                      selectedLanguage === lang && { color: colors.beeYellow, fontWeight: '600' }
                    ]}>
                      {lang}
                    </Text>
                    {selectedLanguage === lang && (
                      <Icon name="check" size={16} color={colors.beeYellow} />
                    )}
                  </TouchableOpacity>
                ))}
              </View>
            )}
          </View>
        </View>
        
        <View style={styles.jobsToolbarRight}>
          {/* Theme Toggle Switch */}
          <TouchableOpacity 
            style={styles.toolbarThemeToggle}
            onPress={toggleTheme}
          >
            <View style={[
              styles.themeToggleTrack,
              { backgroundColor: isDarkMode ? colors.deepNavy : colors.lightGray }
            ]}>
              <Icon 
                name="wb-sunny" 
                size={14} 
                color={isDarkMode ? colors.warmGray : colors.beeYellow}
                style={styles.themeToggleIconLeft}
              />
              <View style={[
                styles.themeToggleKnob,
                { backgroundColor: colors.white },
                isDarkMode && styles.themeToggleKnobActive
              ]}>
                <Icon 
                  name={isDarkMode ? 'nightlight-round' : 'wb-sunny'} 
                  size={12} 
                  color={isDarkMode ? colors.deepNavy : colors.beeYellow}
                />
              </View>
              <Icon 
                name="nightlight-round" 
                size={14} 
                color={isDarkMode ? colors.beeYellow : colors.warmGray}
                style={styles.themeToggleIconRight}
              />
            </View>
          </TouchableOpacity>

          {user ? (
            <>
              {userData?.profilePicture ? (
                <Image 
                  source={{ uri: userData.profilePicture }}
                  style={styles.toolbarProfilePicture}
                />
              ) : (
                <View style={[styles.toolbarProfilePlaceholder, { backgroundColor: colors.beeYellow }]}>
                  <Icon name="person" size={20} color={colors.deepNavy} />
                </View>
              )}
              <Text style={[styles.toolbarUserName, { color: colors.deepNavy }]}>
                {user.email?.split('@')[0]}
              </Text>
              <TouchableOpacity 
                style={styles.toolbarSettingsButton}
                onPress={() => navigation.navigate('Settings')}
              >
                <Icon name="settings" size={24} color={colors.deepNavy} />
              </TouchableOpacity>
              <TouchableOpacity 
                style={styles.toolbarLogoutButton}
                onPress={() => {
                  signOut(auth);
                  navigation.replace('Home');
                }}
              >
                <Icon name="logout" size={24} color={colors.danger} />
              </TouchableOpacity>
            </>
          ) : (
            <>
              <TouchableOpacity 
                style={[styles.toolbarLoginButton, { borderColor: colors.deepNavy }]}
                onPress={() => navigation.navigate('Login')}
              >
                <Text style={[styles.toolbarLoginButtonText, { color: colors.deepNavy }]}>
                  Login
                </Text>
              </TouchableOpacity>
              <TouchableOpacity 
                style={[styles.toolbarSignupButton, { backgroundColor: colors.beeYellow }]}
                onPress={() => navigation.navigate('Signup')}
              >
                <Text style={[styles.toolbarSignupButtonText, { color: colors.deepNavy }]}>
                  Sign Up
                </Text>
              </TouchableOpacity>
            </>
          )}
        </View>
      </View>

      <View style={styles.jobDetailsMainContainer}>
        {/* Main Content with Sticky Apply Button */}
        <View style={{ flex: 1, position: 'relative' }}>
          <ScrollView style={[styles.jobDetailsContent, { backgroundColor: colors.cream }]} showsVerticalScrollIndicator={false} contentContainerStyle={{ paddingBottom: 100 }}>
          {/* Job Header Card - Modern Enhanced Design */}
          <View style={[styles.modernJobHeaderCard, { backgroundColor: colors.white }]}>
            <View style={styles.modernJobHeaderTop}>
              <View style={styles.modernJobDetailsIconContainer}>
                {job.sourceImageUrl ? (
                  <Image
                    source={{ uri: job.sourceImageUrl }}
                    style={styles.modernCompanyLogo}
                    resizeMode="cover"
                  />
                ) : (
                  <View style={[styles.modernCompanyLogoPlaceholder, { backgroundColor: colors.cream }]}>
                    <Icon name="business" size={52} color={colors.beeYellow} />
                  </View>
                )}
              </View>
              <View style={styles.modernJobHeaderInfo}>
                <Text style={[styles.modernJobDetailsTitle, { color: colors.deepNavy }]}>{job.title}</Text>
                <TouchableOpacity>
                  <Text style={[styles.modernJobDetailsCompany, { color: colors.softBlue }]}>{job.company}</Text>
                </TouchableOpacity>
                <View style={styles.modernJobMetaRow}>
                  <View style={styles.modernJobMetaItem}>
                    <Icon name="schedule" size={16} color={colors.warmGray} />
                    <Text style={[styles.modernJobPostedTime, { color: colors.warmGray }]}>{getTimeAgo(job.postedDate || job.createdAt)}</Text>
                  </View>
                  {job.location && (
                    <View style={styles.modernJobMetaItem}>
                      <Icon name="location-on" size={16} color={colors.danger} />
                      <Text style={[styles.modernJobPostedTime, { color: colors.warmGray }]}>{job.location}</Text>
                    </View>
                  )}
                </View>
              </View>
            </View>
            
            {/* Modern Badges */}
            <View style={styles.modernJobDetailsBadges}>
              {job.contractType && (
                <View style={[styles.modernJobDetailsBadge, { backgroundColor: colors.cream, borderColor: colors.softBlue }]}>
                  <Icon name="description" size={15} color={colors.softBlue} />
                  <Text style={[styles.modernJobDetailsBadgeText, { color: colors.deepNavy }]}>{job.contractType}</Text>
                </View>
              )}
              {job.isRemote && (
                <View style={[styles.modernJobDetailsBadge, { backgroundColor: colors.cream, borderColor: colors.success }]}>
                  <Icon name="home-work" size={15} color={colors.success} />
                  <Text style={[styles.modernJobDetailsBadgeText, { color: colors.success }]}>Remote</Text>
                </View>
              )}
              {job.experienceLevel && (
                <View style={[styles.modernJobDetailsBadge, { backgroundColor: colors.cream, borderColor: colors.honeyGold }]}>
                  <Icon name="military-tech" size={15} color={colors.honeyGold} />
                  <Text style={[styles.modernJobDetailsBadgeText, { color: colors.deepNavy }]}>{job.experienceLevel}</Text>
                </View>
              )}
              {job.category && (
                <View style={[styles.modernJobDetailsBadge, { backgroundColor: colors.cream, borderColor: colors.softBlue }]}>
                  <Icon name="category" size={15} color={colors.softBlue} />
                  <Text style={[styles.modernJobDetailsBadgeText, { color: colors.deepNavy }]}>{job.category}</Text>
                </View>
              )}
            </View>

            {/* Enhanced Quick Stats */}
            {(job.applicants || job.views) && (
              <View style={[styles.modernQuickStatsContainer, { backgroundColor: colors.cream }]}>
                {job.applicants && (
                  <View style={styles.modernQuickStat}>
                    <View style={[styles.modernStatIconCircle, { backgroundColor: colors.white }]}>
                      <Icon name="people" size={18} color={colors.softBlue} />
                    </View>
                    <Text style={[styles.modernQuickStatText, { color: colors.deepNavy }]}>{job.applicants} applicants</Text>
                  </View>
                )}
                {job.views && (
                  <View style={styles.modernQuickStat}>
                    <View style={[styles.modernStatIconCircle, { backgroundColor: colors.white }]}>
                      <Icon name="visibility" size={18} color={colors.warmGray} />
                    </View>
                    <Text style={[styles.modernQuickStatText, { color: colors.deepNavy }]}>{job.views} views</Text>
                  </View>
                )}
              </View>
            )}
            
            {/* Enhanced Job Matching Score */}
            {auth.currentUser && job.matchScore && (
              <View style={[styles.modernMatchScoreCard, { backgroundColor: colors.cream }]}>
                <View style={styles.modernMatchScoreHeader}>
                  <View style={styles.modernMatchScoreLeft}>
                    <View style={[styles.modernStatIconCircle, { backgroundColor: colors.white }]}>
                      <Icon name="stars" size={22} color={colors.beeYellow} />
                    </View>
                    <View>
                      <Text style={[styles.modernMatchScoreTitle, { color: colors.deepNavy }]}>Job Match</Text>
                      <Text style={[styles.modernMatchScoreSubtitle, { color: colors.warmGray }]}>Based on your profile</Text>
                    </View>
                  </View>
                  <View style={[styles.modernMatchScoreBadge, { backgroundColor: colors.beeYellow }]}>
                    <Text style={[styles.modernMatchScorePercentage, { color: colors.deepNavy }]}>{job.matchScore}%</Text>
                  </View>
                </View>
                <View style={[styles.modernMatchScoreBar, { backgroundColor: colors.lightGray }]}>
                  <View style={[styles.modernMatchScoreProgress, { width: `${job.matchScore}%`, backgroundColor: colors.beeYellow }]} />
                </View>
                <Text style={[styles.modernMatchScoreDescription, { color: colors.warmGray }]}>
                  {job.matchScore >= 80 ? 'Excellent match! Your skills align well with this position.' :
                   job.matchScore >= 60 ? 'Good match. Consider applying to strengthen your profile.' :
                   'Moderate match. You may need additional skills for this role.'}
                </Text>
              </View>
            )}

            {/* Enhanced Salary Highlight */}
            {job.salary && (
              <View style={[styles.modernSalaryHighlight, { backgroundColor: '#e8f5e9' }]}>
                <View style={[styles.modernStatIconCircle, { backgroundColor: colors.white }]}>
                  <Icon name="attach-money" size={22} color={colors.success} />
                </View>
                <Text style={[styles.modernSalaryHighlightText, { color: colors.success }]}>{job.salary}</Text>
              </View>
            )}
          </View>

          {/* Job Description - Modern Enhanced Section */}
          {job.description && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="description" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Job Description</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <Text style={[styles.modernJobDetailsDescription, { color: colors.warmGray }]}>{job.description}</Text>
              </View>
            </View>
          )}

          {/* Key Information Grid - Modern Enhanced */}
          <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
            <View style={styles.modernSectionHeaderContainer}>
              <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                <Icon name="info" size={20} color={colors.deepNavy} />
              </View>
              <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Key Information</Text>
            </View>
            <View style={[styles.modernJobDetailsInfoSection, { backgroundColor: colors.cream }]}>
              {job.salary && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#e8f5e9' }]}>
                    <Icon name="payments" size={26} color={colors.success} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Salary Range</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{job.salary}</Text>
                  </View>
                </View>
              )}

              {job.location && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#ffebee' }]}>
                    <Icon name="location-on" size={26} color={colors.danger} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Location</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{job.location}</Text>
                  </View>
                </View>
              )}

              {job.isRemote !== undefined && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#e8f5e9' }]}>
                    <Icon name="home-work" size={26} color={colors.success} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Work Model</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{job.isRemote ? 'Remote' : 'On-site'}</Text>
                  </View>
                </View>
              )}
              
              <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                <View style={[styles.modernInfoCardIcon, { backgroundColor: '#e3f2fd' }]}>
                  <Icon name="calendar-today" size={26} color={colors.softBlue} />
                </View>
                <View style={styles.modernJobDetailsInfoContent}>
                  <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Posted Date</Text>
                  <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{formatDate(job.postedDate || job.createdAt)}</Text>
                </View>
              </View>

              {job.deadline && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#ffebee' }]}>
                    <Icon name="event" size={26} color={colors.danger} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Application Deadline</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{formatDate(job.deadline)}</Text>
                  </View>
                </View>
              )}

              {job.jobType && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#fff8e1' }]}>
                    <Icon name="work" size={26} color={colors.honeyGold} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Job Type</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{job.jobType}</Text>
                  </View>
                </View>
              )}

              {job.experienceLevel && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#e3f2fd' }]}>
                    <Icon name="school" size={26} color={colors.softBlue} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Experience Level</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{job.experienceLevel}</Text>
                  </View>
                </View>
              )}

              {job.education && (
                <View style={[styles.modernJobDetailsInfoCard, { backgroundColor: colors.white }]}>
                  <View style={[styles.modernInfoCardIcon, { backgroundColor: '#fff8e1' }]}>
                    <Icon name="school" size={26} color={colors.honeyGold} />
                  </View>
                  <View style={styles.modernJobDetailsInfoContent}>
                    <Text style={[styles.modernJobDetailsInfoLabel, { color: colors.warmGray }]}>Education</Text>
                    <Text style={[styles.modernJobDetailsInfoValue, { color: colors.deepNavy }]}>{job.education}</Text>
                  </View>
                </View>
              )}
            </View>
          </View>

          {/* About the Company - Modern Enhanced */}
          {job.companyDescription && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="business" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>About {job.company}</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <Text style={[styles.modernJobDetailsDescription, { color: colors.warmGray }]}>{job.companyDescription}</Text>
              </View>
            </View>
          )}

          {/* Requirements - Modern Enhanced */}
          {job.requirements && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="checklist" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Requirements</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <Text style={[styles.modernJobDetailsDescription, { color: colors.warmGray }]}>{job.requirements}</Text>
              </View>
            </View>
          )}

          {/* Responsibilities - Modern Enhanced */}
          {job.responsibilities && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="assignment" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Responsibilities</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <Text style={[styles.modernJobDetailsDescription, { color: colors.warmGray }]}>{job.responsibilities}</Text>
              </View>
            </View>
          )}

          {/* Benefits & Perks - Modern Enhanced */}
          {job.benefits && job.benefits.length > 0 && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="card-giftcard" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Benefits & Perks</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <View style={styles.modernBenefitsList}>
                  {job.benefits.map((benefit: string, index: number) => (
                    <View key={index} style={styles.modernBenefitItem}>
                      <Icon name="check-circle" size={20} color={colors.success} />
                      <Text style={[styles.modernBenefitText, { color: colors.deepNavy }]}>{benefit}</Text>
                    </View>
                  ))}
                </View>
              </View>
            </View>
          )}

          {/* Required Skills - Modern Enhanced */}
          {job.requiredSkills && job.requiredSkills.length > 0 && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="emoji-objects" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Required Skills</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <View style={styles.modernJobTagsContainer}>
                  {job.requiredSkills.map((skill: string, index: number) => (
                    <View key={index} style={[styles.modernSkillTag, { backgroundColor: '#e8f5e9', borderColor: colors.success }]}>
                      <Icon name="check-circle" size={15} color={colors.success} />
                      <Text style={[styles.modernSkillTagText, { color: colors.deepNavy }]}>{skill}</Text>
                    </View>
                  ))}
                </View>
              </View>
            </View>
          )}

          {/* Nice to Have Skills - Modern Enhanced */}
          {job.preferredSkills && job.preferredSkills.length > 0 && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="star-outline" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Nice to Have</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <View style={styles.modernJobTagsContainer}>
                  {job.preferredSkills.map((skill: string, index: number) => (
                    <View key={index} style={[styles.modernPreferredSkillTag, { backgroundColor: '#fff8e1', borderColor: colors.honeyGold }]}>
                      <Icon name="star-border" size={15} color={colors.honeyGold} />
                      <Text style={[styles.modernPreferredSkillTagText, { color: colors.deepNavy }]}>{skill}</Text>
                    </View>
                  ))}
                </View>
              </View>
            </View>
          )}

          {/* Tags - Modern Enhanced */}
          {job.tags && job.tags.length > 0 && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="local-offer" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Tags</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <View style={styles.modernJobTagsContainer}>
                  {job.tags.map((tag: string, index: number) => (
                    <View key={index} style={[styles.modernJobTag, { backgroundColor: colors.cream, borderColor: colors.beeYellow }]}>
                      <Text style={[styles.modernJobTagText, { color: colors.deepNavy }]}>{tag}</Text>
                    </View>
                  ))}
                </View>
              </View>
            </View>
          )}

          {/* Job Source & Activity - Modern Enhanced */}
          <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
            <View style={styles.modernSectionHeaderContainer}>
              <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                <Icon name="info" size={20} color={colors.deepNavy} />
              </View>
              <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Job Source & Activity</Text>
            </View>
            <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
              {/* Application Activity Stats */}
              {(job.recentApplicants || job.viewsLast24h) && (
                <View style={{ marginBottom: 16 }}>
                  <Text style={{ fontSize: 14, fontWeight: '600', color: colors.deepNavy, marginBottom: 8 }}>
                    Application Activity
                  </Text>
                  <View style={{ gap: 8 }}>
                    {job.recentApplicants && (
                      <View style={{ flexDirection: 'row', alignItems: 'center' }}>
                        <View style={{ width: 28, height: 28, borderRadius: 14, backgroundColor: colors.lightPeach, alignItems: 'center', justifyContent: 'center', marginRight: 8 }}>
                          <Icon name="schedule" size={16} color={colors.danger} />
                        </View>
                        <Text style={{ fontSize: 13, color: colors.warmGray, flex: 1 }}>
                          <Text style={{ fontWeight: '600', color: colors.deepNavy }}>{job.recentApplicants}</Text> people applied in the last 24 hours
                        </Text>
                      </View>
                    )}
                    {job.viewsLast24h && (
                      <View style={{ flexDirection: 'row', alignItems: 'center' }}>
                        <View style={{ width: 28, height: 28, borderRadius: 14, backgroundColor: colors.lightPeach, alignItems: 'center', justifyContent: 'center', marginRight: 8 }}>
                          <Icon name="remove-red-eye" size={16} color={colors.warmGray} />
                        </View>
                        <Text style={{ fontSize: 13, color: colors.warmGray, flex: 1 }}>
                          <Text style={{ fontWeight: '600', color: colors.deepNavy }}>{job.viewsLast24h}</Text> views in the last 24 hours
                        </Text>
                      </View>
                    )}
                  </View>
                </View>
              )}

              {/* Source Channel Info */}
              <View style={{ borderTopWidth: (job.recentApplicants || job.viewsLast24h) ? 1 : 0, borderTopColor: colors.lightGray, paddingTop: (job.recentApplicants || job.viewsLast24h) ? 16 : 0 }}>
                <Text style={{ fontSize: 14, fontWeight: '600', color: colors.deepNavy, marginBottom: 12 }}>
                  Source Channel
                </Text>
                <View style={{ flexDirection: 'row', alignItems: 'flex-start' }}>
                  {job.sourceImageUrl ? (
                    <Image
                      source={{ uri: job.sourceImageUrl }}
                      style={{ width: 56, height: 56, borderRadius: 28, marginRight: 12 }}
                      resizeMode="cover"
                    />
                  ) : (
                    <View style={{ width: 56, height: 56, borderRadius: 28, backgroundColor: colors.lightPeach, alignItems: 'center', justifyContent: 'center', marginRight: 12 }}>
                      <Icon name="telegram" size={32} color="#0088cc" />
                    </View>
                  )}
                  <View style={{ flex: 1 }}>
                    <Text style={{ fontSize: 15, fontWeight: '600', color: colors.deepNavy, marginBottom: 4 }}>
                      {job.jobSource || 'NibJobs Channel'}
                    </Text>
                    <Text style={{ fontSize: 13, color: colors.warmGray, marginBottom: 10 }}>
                      This job was sourced from a Telegram channel
                    </Text>
                    {(job.telegramMessageUrl || job.telegramLink) && (
                      <TouchableOpacity 
                        style={{ flexDirection: 'row', alignItems: 'center', backgroundColor: '#0088cc', paddingHorizontal: 12, paddingVertical: 8, borderRadius: 6, alignSelf: 'flex-start' }}
                        onPress={() => Linking.openURL(job.telegramMessageUrl || job.telegramLink)}
                      >
                        <Icon name="open-in-new" size={14} color={colors.white} />
                        <Text style={{ fontSize: 13, fontWeight: '600', color: colors.white, marginLeft: 6 }}>
                          View Original Post
                        </Text>
                      </TouchableOpacity>
                    )}
                  </View>
                </View>
              </View>
            </View>
          </View>

          {/* Application Process - Modern Enhanced */}
          {job.applicationProcess && (
            <View style={[styles.modernJobDetailsSection, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.modernSectionHeaderContainer}>
                <View style={[styles.modernSectionIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name="how-to-reg" size={20} color={colors.deepNavy} />
                </View>
                <Text style={[styles.modernJobDetailsSectionHeader, { color: colors.deepNavy }]}>Application Process</Text>
              </View>
              <View style={[styles.modernContentCard, { backgroundColor: colors.white }]}>
                <Text style={[styles.modernJobDetailsDescription, { color: colors.warmGray }]}>{job.applicationProcess}</Text>
              </View>
            </View>
          )}

          {/* Apply Button Section - REMOVED FROM SCROLLVIEW, WILL BE STICKY */}
          
          {/* Login Prompt for Non-Authenticated Users - Moved to Bottom */}
          {!auth.currentUser && (
            <View style={[styles.loginPromptCard, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <View style={styles.loginPromptHeader}>
                <Icon name="account-circle" size={32} color={colors.beeYellow} />
                <Text style={[styles.loginPromptTitle, { color: colors.deepNavy }]}>Want to do more?</Text>
              </View>
              <Text style={[styles.loginPromptSubtitle, { color: colors.warmGray }]}>Create an account or login to unlock these features:</Text>
              
              <View style={styles.loginPromptBenefits}>
                <View style={styles.loginPromptBenefit}>
                  <Icon name="bookmark" size={20} color={colors.softBlue} />
                  <Text style={[styles.loginPromptBenefitText, { color: colors.warmGray }]}>Save this job for later and build your collection</Text>
                </View>
                
                <View style={styles.loginPromptBenefit}>
                  <Icon name="stars" size={20} color={colors.beeYellow} />
                  <Text style={[styles.loginPromptBenefitText, { color: colors.warmGray }]}>See how well your profile matches this job</Text>
                </View>
                
                <View style={styles.loginPromptBenefit}>
                  <Icon name="notifications-active" size={20} color={colors.success} />
                  <Text style={[styles.loginPromptBenefitText, { color: colors.warmGray }]}>Get notifications for jobs tailored to your skills</Text>
                </View>
              </View>
              
              <TouchableOpacity 
                style={[styles.loginPromptButton, { backgroundColor: colors.beeYellow }]}
                onPress={handleLogin}
              >
                <Text style={[styles.loginPromptButtonText, { color: colors.deepNavy }]}>Login or Sign Up</Text>
                <Icon name="arrow-forward" size={18} color={colors.deepNavy} />
              </TouchableOpacity>
            </View>
          )}
          
          {/* Footer */}
          <View style={[styles.jobDetailsFooter, { backgroundColor: colors.cream, borderTopColor: colors.lightGray }]}>
            <View style={styles.jobFooterContent}>
              <View style={styles.jobFooterSection}>
                <Icon name="report-problem" size={18} color={colors.warmGray} />
                <Text style={[styles.jobFooterText, { color: colors.warmGray }]}>Report this job</Text>
              </View>
              
              <View style={[styles.jobFooterDividerVertical, { backgroundColor: colors.lightGray }]} />
              
              <View style={styles.jobFooterSection}>
                <Icon name="info-outline" size={18} color={colors.warmGray} />
                <Text style={[styles.jobFooterText, { color: colors.warmGray }]}>Job ID: {job.id.substring(0, 8)}</Text>
              </View>
            </View>

            <View style={styles.jobFooterBottom}>
              <Text style={[styles.jobFooterBottomText, { color: colors.warmGray }]}>
                Posted on NibJobs â€¢ {formatDate(job.createdAt)}
              </Text>
              <Text style={[styles.jobFooterBottomText, { color: colors.warmGray }]}>
                Â© 2024 NibJobs - Connecting Ethiopia's Talent with Opportunities
              </Text>
            </View>

            <View style={styles.jobFooterLinks}>
              <TouchableOpacity>
                <Text style={[styles.footerLinkText, { color: colors.warmGray }]}>Privacy Policy</Text>
              </TouchableOpacity>
              <Text style={[styles.jobFooterLinkDivider, { color: colors.warmGray }]}>â€¢</Text>
              <TouchableOpacity>
                <Text style={[styles.footerLinkText, { color: colors.warmGray }]}>Terms of Service</Text>
              </TouchableOpacity>
              <Text style={[styles.jobFooterLinkDivider, { color: colors.warmGray }]}>â€¢</Text>
              <TouchableOpacity>
                <Text style={[styles.footerLinkText, { color: colors.warmGray }]}>Contact Us</Text>
              </TouchableOpacity>
            </View>
          </View>
        </ScrollView>
        
        {/* Modern Sticky Apply Button - Deep Navy CTA */}
        <View style={[styles.modernStickyApplyButton, { backgroundColor: colors.white, borderTopColor: colors.lightGray }]}>
          <TouchableOpacity 
            style={[styles.modernJobDetailsApplyButton, { backgroundColor: colors.deepNavy }]}
            onPress={handleApply}
          >
            <Image 
              source={require('./assets/telegram.svg')} 
              style={{ width: 22, height: 22 }}
              resizeMode="contain"
            />
            <Text style={[styles.modernJobDetailsApplyButtonText, { color: colors.white }]}>Apply on Telegram</Text>
            <Icon name="arrow-forward" size={20} color={colors.white} />
          </TouchableOpacity>
        </View>
      </View>
      
      {/* Related Jobs Sidebar - MOVED TO RIGHT SIDE */}
      <ScrollView style={[styles.relatedJobsSidebar, { backgroundColor: colors.cream }]} showsVerticalScrollIndicator={false}>
        <View style={[styles.relatedJobsSidebarHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
          <Icon name="work-outline" size={20} color={colors.deepNavy} />
          <Text style={[styles.relatedJobsTitle, { color: colors.deepNavy }]}>Similar Jobs</Text>
        </View>
        
        {relatedJobs.length > 0 ? (
          relatedJobs.map((relatedJob: any) => (
            <TouchableOpacity
              key={relatedJob.id}
              style={[styles.relatedJobCard, { backgroundColor: colors.white, borderColor: colors.lightGray }]}
              onPress={() => navigation.push('JobDetails', { id: relatedJob.id })}
            >
              {/* Company Logo/Icon */}
              <View style={styles.relatedJobHeader}>
                {relatedJob.sourceImageUrl ? (
                  <Image
                    source={{ uri: relatedJob.sourceImageUrl }}
                    style={styles.relatedJobIcon}
                    resizeMode="cover"
                  />
                ) : (
                  <View style={[styles.relatedJobIconPlaceholder, { backgroundColor: colors.cream }]}>
                    <Icon name="business" size={16} color={colors.beeYellow} />
                  </View>
                )}
                <View style={{ flex: 1 }}>
                  <Text style={[styles.relatedJobTitle, { color: colors.deepNavy }]} numberOfLines={2}>{relatedJob.title}</Text>
                  <Text style={[styles.relatedJobCompany, { color: colors.warmGray }]} numberOfLines={1}>{relatedJob.company}</Text>
                </View>
              </View>
              
              {/* Job Details */}
              <View style={styles.relatedJobDetails}>
                {relatedJob.location && (
                  <View style={styles.relatedJobDetailItem}>
                    <Icon name="location-on" size={14} color={colors.danger} />
                    <Text style={[styles.relatedJobDetailText, { color: colors.warmGray }]} numberOfLines={1}>{relatedJob.location}</Text>
                  </View>
                )}
                {relatedJob.contractType && (
                  <View style={styles.relatedJobDetailItem}>
                    <Icon name="work-outline" size={14} color={colors.softBlue} />
                    <Text style={[styles.relatedJobDetailText, { color: colors.warmGray }]} numberOfLines={1}>{relatedJob.contractType}</Text>
                  </View>
                )}
                {relatedJob.experienceLevel && (
                  <View style={styles.relatedJobDetailItem}>
                    <Icon name="star-outline" size={14} color={colors.honeyGold} />
                    <Text style={[styles.relatedJobDetailText, { color: colors.warmGray }]} numberOfLines={1}>{relatedJob.experienceLevel}</Text>
                  </View>
                )}
              </View>
              
              {/* Salary and Time */}
              <View style={styles.relatedJobFooter}>
                {relatedJob.salary && (
                  <View style={[styles.relatedJobSalaryBadge, { backgroundColor: colors.cream }]}>
                    <Icon name="payments" size={12} color={colors.success} />
                    <Text style={[styles.relatedJobSalary, { color: colors.success }]} numberOfLines={1}>{relatedJob.salary}</Text>
                  </View>
                )}
                {relatedJob.postedDate && (
                  <Text style={[styles.relatedJobTime, { color: colors.warmGray }]}>{getTimeAgo(relatedJob.postedDate || relatedJob.createdAt)}</Text>
                )}
              </View>
            </TouchableOpacity>
          ))
        ) : (
          <View style={styles.relatedJobsEmpty}>
            <Icon name="work-off" size={48} color={colors.lightGray} />
            <Text style={[styles.relatedJobsEmptyText, { color: colors.warmGray }]}>No related jobs found</Text>
            <Text style={[styles.relatedJobsEmptySubtext, { color: colors.warmGray }]}>Check back later for similar opportunities</Text>
          </View>
        )}
      </ScrollView>
      
      </View>
    </SafeAreaView>
  );
}

// Jobs Screen - For verified and active users
function JobsScreen({ navigation, route, isDarkMode, toggleTheme }: any) {
  const [jobs, setJobs] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchText, setSearchText] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('');
  const [selectedJobType, setSelectedJobType] = useState('');
  const [selectedRemote, setSelectedRemote] = useState('');
  const [categories, setCategories] = useState<any[]>([]);
  const [user, setUser] = useState<any>(null);
  const [userData, setUserData] = useState<any>(null);
  const [bookmarkedJobs, setBookmarkedJobs] = useState<string[]>([]);
  const [selectedLanguage, setSelectedLanguage] = useState('English');
  const [showLanguageMenu, setShowLanguageMenu] = useState(false);
  const languageButtonRef = useRef<any>(null);
  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, right: 0 });
  const [currentPage, setCurrentPage] = useState(1);
  const [totalJobs, setTotalJobs] = useState(0);
  const [lastVisible, setLastVisible] = useState<any>(null);
  const [firstVisible, setFirstVisible] = useState<any>(null);
  const [pageCache, setPageCache] = useState<Map<number, any>>(new Map());
  
  // Collapsible filter states
  const [employmentTypeExpanded, setEmploymentTypeExpanded] = useState(true);
  const [workModeExpanded, setWorkModeExpanded] = useState(true);
  
  // View mode state for grid/list toggle
  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');
  const [currentLanguage, setCurrentLanguage] = useState('en');
  
  const jobsPerPage = 12;
  
  const colors = isDarkMode ? darkColors : lightColors;
  const t = translations[currentLanguage as keyof typeof translations];
  
  const languageOptions = [
    { code: 'en', label: 'English' },
    { code: 'am', label: 'áŠ áˆ›áˆ­áŠ›' },
    { code: 'ti', label: 'á‰µáŒáˆ­áŠ›' },
    { code: 'or', label: 'Afaan Oromoo' }
  ];
  
  const getCurrentLanguage = () => {
    return languageOptions.find(lang => lang.code === currentLanguage) || languageOptions[0];
  };
  
  const toggleLanguageDropdown = () => {
    if (!showLanguageMenu && languageButtonRef.current) {
      languageButtonRef.current.measureInWindow((x: number, y: number, width: number, height: number) => {
        setDropdownPosition({
          top: y + height + 5,
          right: typeof window !== 'undefined' ? window.innerWidth - x - width : 0,
        });
      });
    }
    setShowLanguageMenu(!showLanguageMenu);
  };
  
  const changeLanguage = async (langCode: string) => {
    setCurrentLanguage(langCode);
    setSelectedLanguage(languageOptions.find(lang => lang.code === langCode)?.label || 'English');
    setShowLanguageMenu(false);
    try {
      await AsyncStorage.setItem('selectedLanguage', langCode);
    } catch (error) {
      console.error('Error saving language preference:', error);
    }
  };

  useEffect(() => {
    const initializeScreen = async () => {
      try {
        // Load saved language
        const savedLanguage = await AsyncStorage.getItem('selectedLanguage');
        if (savedLanguage) {
          setCurrentLanguage(savedLanguage);
          setSelectedLanguage(languageOptions.find(lang => lang.code === savedLanguage)?.label || 'English');
        }
        
        await fetchTotalCount();
        await fetchJobs(1);
        await fetchCategories();
      } catch (error) {
        console.error('Error initializing Jobs screen:', error);
      }
    };

    initializeScreen();
    
    // Set search text if passed from home page
    if (route?.params?.searchQuery) {
      setSearchText(route.params.searchQuery);
    }

    // Listen to auth state
    const unsubscribe = onAuthStateChanged(auth, async (authUser) => {
      if (authUser) {
        setUser(authUser);
        // Fetch bookmarked jobs and user data
        try {
          const userDoc = await getDoc(doc(db, 'users', authUser.uid));
          if (userDoc.exists()) {
            const data = userDoc.data();
            setUserData(data);
            setBookmarkedJobs(data.bookmarkedJobs || []);
          }
        } catch (error) {
          console.error('Error fetching bookmarked jobs:', error);
        }
      } else {
        setUser(null);
        setUserData(null);
        setBookmarkedJobs([]);
      }
    });

    return unsubscribe;
  }, [route?.params?.searchQuery]);

  const handleToggleBookmark = async (jobId: string) => {
    if (!user) {
      Alert.alert('Authentication Required', 'Please login to bookmark jobs');
      navigation.navigate('Login');
      return;
    }

    try {
      const userRef = doc(db, 'users', user.uid);
      const userDoc = await getDoc(userRef);
      const currentBookmarks = userDoc.data()?.bookmarkedJobs || [];
      
      if (currentBookmarks.includes(jobId)) {
        // Remove bookmark
        await updateDoc(userRef, {
          bookmarkedJobs: currentBookmarks.filter((id: string) => id !== jobId)
        });
        setBookmarkedJobs(currentBookmarks.filter((id: string) => id !== jobId));
      } else {
        // Add bookmark
        await updateDoc(userRef, {
          bookmarkedJobs: [...currentBookmarks, jobId]
        });
        setBookmarkedJobs([...currentBookmarks, jobId]);
      }
    } catch (error) {
      console.error('Error toggling bookmark:', error);
      Alert.alert('Error', 'Failed to update bookmark');
    }
  };

  // Refetch when filters change
  useEffect(() => {
    if (loading) return; // Don't refetch if initial load is still happening
    
    const refetchWithFilters = async () => {
      try {
        setCurrentPage(1);
        setPageCache(new Map());
        await fetchTotalCount();
        await fetchJobs(1);
      } catch (error) {
        console.error('Error refetching with filters:', error);
      }
    };

    refetchWithFilters();
  }, [searchText, selectedCategory, selectedJobType, selectedRemote]);

  const fetchTotalCount = async () => {
    try {
      const jobsCollection = collection(db, 'jobs');
      let countQuery = dbQuery(jobsCollection);

      // Apply filters
      if (selectedCategory) {
        countQuery = dbQuery(countQuery, where('category', '==', selectedCategory));
      }
      if (selectedJobType) {
        countQuery = dbQuery(countQuery, where('contractType', '==', selectedJobType));
      }
      if (selectedRemote === 'Remote') {
        countQuery = dbQuery(countQuery, where('isRemote', '==', true));
      } else if (selectedRemote === 'On-site') {
        countQuery = dbQuery(countQuery, where('isRemote', '==', false));
      }

      const snapshot = await getDocs(countQuery);
      
      // Apply search filter in memory (since Firestore doesn't support text search)
      let filteredCount = snapshot.docs;
      if (searchText) {
        filteredCount = snapshot.docs.filter(doc => {
          const data = doc.data();
          return (
            data.title?.toLowerCase().includes(searchText.toLowerCase()) ||
            data.company?.toLowerCase().includes(searchText.toLowerCase()) ||
            data.location?.toLowerCase().includes(searchText.toLowerCase())
          );
        });
      }
      
      setTotalJobs(filteredCount.length);
    } catch (error) {
      console.error('Error fetching total count:', error);
    }
  };

  const fetchJobs = async (page: number, direction: 'next' | 'prev' | 'direct' = 'direct') => {
    try {
      setLoading(true);

      // Check cache first
      if (pageCache.has(page)) {
        const cachedData = pageCache.get(page);
        setJobs(cachedData.jobs);
        setFirstVisible(cachedData.firstVisible);
        setLastVisible(cachedData.lastVisible);
        setCurrentPage(page);
        setLoading(false);
        return;
      }

      const jobsCollection = collection(db, 'jobs');
      
      // Build the base query with filters - where clauses must come before orderBy
      let queryConstraints: any[] = [];
      
      if (selectedCategory) {
        queryConstraints.push(where('category', '==', selectedCategory));
      }
      if (selectedJobType) {
        queryConstraints.push(where('contractType', '==', selectedJobType));
      }
      if (selectedRemote === 'Remote') {
        queryConstraints.push(where('isRemote', '==', true));
      } else if (selectedRemote === 'On-site') {
        queryConstraints.push(where('isRemote', '==', false));
      }

      // Add orderBy after where clauses
      queryConstraints.push(orderBy('createdAt', 'desc'));

      // Apply pagination
      if (direction === 'next' && lastVisible) {
        queryConstraints.push(startAfter(lastVisible));
        queryConstraints.push(limit(jobsPerPage));
      } else if (direction === 'prev' && firstVisible) {
        queryConstraints.push(startAfter(firstVisible));
        queryConstraints.push(limit(jobsPerPage));
      } else {
        const skip = (page - 1) * jobsPerPage;
        queryConstraints.push(limit(skip + jobsPerPage));
      }

      let jobsQuery = dbQuery(jobsCollection, ...queryConstraints);

      const jobsSnapshot = await getDocs(jobsQuery);
      let jobsData = jobsSnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));

      // For direct navigation, skip to the correct page
      if (direction === 'direct' && page > 1) {
        const skip = (page - 1) * jobsPerPage;
        jobsData = jobsData.slice(skip);
      }

      // Apply search filter in memory (since Firestore doesn't support full-text search)
      if (searchText) {
        jobsData = jobsData.filter(job =>
          job.title?.toLowerCase().includes(searchText.toLowerCase()) ||
          job.company?.toLowerCase().includes(searchText.toLowerCase()) ||
          job.location?.toLowerCase().includes(searchText.toLowerCase())
        );
      }

      // Take only the required number of jobs
      const paginatedJobs = jobsData.slice(0, jobsPerPage);

      // Store pagination cursors
      if (jobsSnapshot.docs.length > 0) {
        const relevantDocs = jobsSnapshot.docs.slice(
          direction === 'direct' && page > 1 ? (page - 1) * jobsPerPage : 0,
          direction === 'direct' && page > 1 ? (page - 1) * jobsPerPage + jobsPerPage : jobsPerPage
        );
        
        if (relevantDocs.length > 0) {
          setFirstVisible(relevantDocs[0]);
          setLastVisible(relevantDocs[relevantDocs.length - 1]);

          // Cache this page
          const newCache = new Map(pageCache);
          newCache.set(page, {
            jobs: paginatedJobs,
            firstVisible: relevantDocs[0],
            lastVisible: relevantDocs[relevantDocs.length - 1]
          });
          setPageCache(newCache);
        }
      }

      setJobs(paginatedJobs);
      setCurrentPage(page);
    } catch (error) {
      console.error('Error fetching jobs:', error);
      // Don't show alert, just log the error and set empty jobs
      setJobs([]);
    } finally {
      setLoading(false);
    }
  };

  const fetchCategories = async () => {
    try {
      const categoriesCollection = collection(db, 'categories');
      const categoriesSnapshot = await getDocs(categoriesCollection);
      const categoriesData = categoriesSnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      setCategories(categoriesData);
    } catch (error) {
      console.error('Error fetching categories:', error);
    }
  };

  const handleLogout = async () => {
    try {
      await signOut(auth);
      navigation.replace('Home');
    } catch (error) {
      console.error('Logout error:', error);
    }
  };

  // Pagination calculations
  const totalPages = Math.ceil(totalJobs / jobsPerPage);
  const startIndex = (currentPage - 1) * jobsPerPage;
  const endIndex = Math.min(startIndex + jobsPerPage, totalJobs);

  const handlePageChange = (page: number) => {
    if (page === currentPage + 1) {
      fetchJobs(page, 'next');
    } else if (page === currentPage - 1) {
      fetchJobs(page, 'prev');
    } else {
      fetchJobs(page, 'direct');
    }
  };

  const renderJobCard = ({ item: job }: any) => {
    const isFeatured = job.featured || Math.random() > 0.7; // Mock featured status
    
    return (
      <TouchableOpacity 
        style={[
          styles.modernJobCard, 
          { backgroundColor: colors.white },
          viewMode === 'list' && styles.modernJobCardList,
          isFeatured && styles.featuredJobCard
        ]} 
        activeOpacity={0.7}
        onPress={() => navigation.navigate('JobDetails', { id: job.id, job })}
      >
        {/* Featured Badge */}
        {isFeatured && (
          <View style={[styles.featuredBadge, { backgroundColor: colors.beeYellow }]}>
            <Icon name="star" size={14} color={colors.deepNavy} />
            <Text style={[styles.featuredBadgeText, { color: colors.deepNavy }]}>Featured</Text>
          </View>
        )}

        {/* Card Header with Company Logo and Bookmark */}
        <View style={styles.modernCardHeader}>
          {job.sourceImageUrl ? (
            <Image
              source={{ uri: job.sourceImageUrl }}
              style={[styles.companyLogo, { backgroundColor: colors.cream }]}
              resizeMode="cover"
            />
          ) : (
            <View style={[styles.companyLogo, { backgroundColor: colors.deepNavy }]}>
              <Text style={[styles.companyLogoText, { color: colors.white }]}>
                {job.company?.charAt(0)?.toUpperCase() || 'C'}
              </Text>
            </View>
          )}
          <View style={styles.cardHeaderActions}>
            <TouchableOpacity 
              style={[styles.bookmarkButton, { backgroundColor: colors.cream }]}
              onPress={(e) => {
                e.stopPropagation();
                handleToggleBookmark(job.id);
              }}
            >
              <Icon 
                name={bookmarkedJobs.includes(job.id) ? "bookmark" : "bookmark-outline"} 
                size={18} 
                color={bookmarkedJobs.includes(job.id) ? colors.beeYellow : colors.deepNavy} 
              />
            </TouchableOpacity>
          </View>
        </View>

        {/* Job Title and Company */}
        <View style={styles.modernCardBody}>
          <Text style={[styles.modernJobTitle, { color: colors.deepNavy }]} numberOfLines={2}>
            {job.title || 'Job Title'}
          </Text>
          <TouchableOpacity onPress={(e) => e.stopPropagation()}>
            <Text style={[styles.modernCompanyName, { color: colors.warmGray }]} numberOfLines={1}>
              {job.company || 'Company Name'}
            </Text>
          </TouchableOpacity>

          {/* Tags Row */}
          <View style={styles.tagsRow}>
            {job.contractType && (
              <View style={[styles.modernTag, { backgroundColor: `${colors.softBlue}20`, borderColor: colors.softBlue }]}>
                <Icon name="schedule" size={12} color={colors.softBlue} />
                <Text style={[styles.modernTagText, { color: colors.softBlue }]}>{job.contractType}</Text>
              </View>
            )}
            {job.isRemote && (
              <View style={[styles.modernTag, { backgroundColor: `${colors.success}20`, borderColor: colors.success }]}>
                <Icon name="home-work" size={12} color={colors.success} />
                <Text style={[styles.modernTagText, { color: colors.success }]}>Remote</Text>
              </View>
            )}
            {job.category && (
              <View style={[styles.modernTag, { backgroundColor: colors.cream, borderColor: `${colors.warmGray}40` }]}>
                <Text style={[styles.modernTagText, { color: colors.warmGray }]} numberOfLines={1}>{job.category}</Text>
              </View>
            )}
          </View>

          {/* Location and Salary */}
          <View style={styles.modernMetaRow}>
            <View style={styles.modernMetaItem}>
              <Icon name="location-on" size={16} color={colors.warmGray} />
              <Text style={[styles.modernMetaText, { color: colors.warmGray }]} numberOfLines={1}>
                {job.location || 'Location'}
              </Text>
            </View>
          </View>
          
          {job.salary && (
            <View style={[styles.salarySection, { backgroundColor: `${colors.success}10` }]}>
              <Icon name="payments" size={16} color={colors.success} />
              <Text style={[styles.salaryText, { color: colors.success }]} numberOfLines={1}>
                {job.salary}
              </Text>
            </View>
          )}
        </View>

        {/* Card Footer */}
        <View style={[styles.modernCardFooter, { borderTopColor: colors.lightGray }]}>
          <View style={styles.jobDateContainer}>
            <Icon name="access-time" size={14} color={colors.warmGray} />
            <Text style={[styles.modernJobDate, { color: colors.warmGray }]}>
              {job.createdAt ? new Date(job.createdAt.seconds * 1000).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) : 'Recent'}
            </Text>
          </View>
          <TouchableOpacity 
            style={[styles.modernApplyButton, { backgroundColor: colors.deepNavy }]}
            onPress={(e) => {
              e.stopPropagation();
              navigation.navigate('JobDetails', { id: job.id, job });
            }}
          >
            <Text style={[styles.modernApplyText, { color: colors.white }]}>Apply Now</Text>
            <Icon name="arrow-forward" size={16} color={colors.white} />
          </TouchableOpacity>
        </View>
      </TouchableOpacity>
    );
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      {/* Header Toolbar */}
      <View style={[styles.jobsToolbar, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <View style={styles.jobsToolbarLeft}>
          <TouchableOpacity onPress={() => navigation.navigate('Home')}>
            <Image 
              source={require('./assets/favicon.png')}
              style={styles.toolbarLogo}
              resizeMode="contain"
            />
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Jobs')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Jobs</Text>
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Companies')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Companies</Text>
          </TouchableOpacity>
          {user && (
            <TouchableOpacity 
              style={[styles.toolbarNavButton, styles.toolbarBookmarksButton]}
              onPress={() => navigation.navigate('Bookmarks')}
            >
              <Icon name="bookmark" size={18} color={colors.beeYellow} />
              <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy, marginLeft: 4 }]}>Bookmarks</Text>
            </TouchableOpacity>
          )}
          
          {/* Search Bar */}
          <View style={[styles.toolbarSearchContainer, { backgroundColor: colors.cream }]}>
            <Icon name="search" size={18} color={colors.warmGray} />
            <TextInput
              style={[styles.toolbarSearchInput, { color: colors.deepNavy }]}
              placeholder="Search jobs..."
              placeholderTextColor={colors.warmGray}
              value={searchText}
              onChangeText={setSearchText}
            />
          </View>
          
          {/* Language Selector */}
          <View style={styles.toolbarLanguageContainer}>
            <TouchableOpacity 
              ref={languageButtonRef}
              style={[styles.toolbarLanguageButton, { backgroundColor: colors.cream }]}
              onPress={toggleLanguageDropdown}
            >
              <Icon name="language" size={20} color={colors.deepNavy} />
              <Text style={[styles.toolbarLanguageText, { color: colors.deepNavy }]}>
                {getCurrentLanguage().code.toUpperCase()}
              </Text>
              <Icon name={showLanguageMenu ? "expand-less" : "expand-more"} size={20} color={colors.deepNavy} />
            </TouchableOpacity>
          </View>
        </View>
        
        <View style={styles.jobsToolbarRight}>
          {/* Theme Toggle Switch */}
          <TouchableOpacity 
            style={styles.toolbarThemeToggle}
            onPress={toggleTheme}
          >
            <View style={[
              styles.themeToggleTrack,
              { backgroundColor: isDarkMode ? colors.deepNavy : colors.lightGray }
            ]}>
              <Icon 
                name="wb-sunny" 
                size={14} 
                color={isDarkMode ? colors.warmGray : colors.beeYellow}
                style={styles.themeToggleIconLeft}
              />
              <View style={[
                styles.themeToggleKnob,
                { backgroundColor: colors.white },
                isDarkMode && styles.themeToggleKnobActive
              ]}>
                <Icon 
                  name={isDarkMode ? 'nightlight-round' : 'wb-sunny'} 
                  size={12} 
                  color={isDarkMode ? colors.deepNavy : colors.beeYellow}
                />
              </View>
              <Icon 
                name="nightlight-round" 
                size={14} 
                color={isDarkMode ? colors.beeYellow : colors.warmGray}
                style={styles.themeToggleIconRight}
              />
            </View>
          </TouchableOpacity>

          {user ? (
            <>
              {userData?.profilePicture ? (
                <Image 
                  source={{ uri: userData.profilePicture }}
                  style={styles.toolbarProfilePicture}
                />
              ) : (
                <View style={[styles.toolbarProfilePlaceholder, { backgroundColor: colors.beeYellow }]}>
                  <Icon name="person" size={20} color={colors.deepNavy} />
                </View>
              )}
              <Text style={[styles.toolbarUserName, { color: colors.deepNavy }]}>
                {user.email?.split('@')[0]}
              </Text>
              <TouchableOpacity 
                style={styles.toolbarSettingsButton}
                onPress={() => navigation.navigate('Settings')}
              >
                <Icon name="settings" size={24} color={colors.deepNavy} />
              </TouchableOpacity>
              <TouchableOpacity 
                style={styles.toolbarLogoutButton}
                onPress={() => {
                  signOut(auth);
                  navigation.replace('Home');
                }}
              >
                <Icon name="logout" size={24} color={colors.danger} />
              </TouchableOpacity>
            </>
          ) : (
            <>
              <TouchableOpacity 
                style={[styles.toolbarLoginButton, { borderColor: colors.deepNavy }]}
                onPress={() => navigation.navigate('Login')}
              >
                <Text style={[styles.toolbarLoginButtonText, { color: colors.deepNavy }]}>
                  Login
                </Text>
              </TouchableOpacity>
              <TouchableOpacity 
                style={[styles.toolbarSignupButton, { backgroundColor: colors.beeYellow }]}
                onPress={() => navigation.navigate('Signup')}
              >
                <Text style={[styles.toolbarSignupButtonText, { color: colors.deepNavy }]}>
                  Sign Up
                </Text>
              </TouchableOpacity>
            </>
          )}
        </View>
      </View>

      <ScrollView style={[styles.jobsPageContainer, { backgroundColor: colors.cream }]}>
        {/* Hero Section with Search */}
        <View style={[styles.jobsHeroSection, { backgroundColor: colors.deepNavy }]}>
          {/* Decorative Background Elements */}
          <View style={styles.heroBackgroundDecor}>
            <View style={[styles.heroCircle1, { backgroundColor: `${colors.beeYellow}15` }]} />
            <View style={[styles.heroCircle2, { backgroundColor: `${colors.softBlue}15` }]} />
          </View>
          
          <View style={styles.jobsHeroContent}>
            <View style={styles.heroTextContainer}>
              <Text style={[styles.jobsHeroTitle, { color: colors.white }]}>
                Discover Your Next Career Move
              </Text>
              <Text style={[styles.jobsHeroSubtitle, { color: colors.cream }]}>
                {totalJobs.toLocaleString()} opportunities from top companies worldwide
              </Text>
            </View>
            
            {/* Enhanced Search Bar */}
            <View style={[styles.heroSearchContainer, { backgroundColor: colors.white }]}>
              <View style={styles.searchIconContainer}>
                <Icon name="search" size={24} color={colors.deepNavy} />
              </View>
              <TextInput
                style={[styles.heroSearchInput, { color: colors.deepNavy }]}
                placeholder="Job title, keywords, or company..."
                placeholderTextColor={colors.warmGray}
                value={searchText}
                onChangeText={setSearchText}
              />
              {searchText.length > 0 && (
                <TouchableOpacity 
                  onPress={() => setSearchText('')}
                  style={styles.searchClearButton}
                >
                  <Icon name="close" size={20} color={colors.warmGray} />
                </TouchableOpacity>
              )}
              <TouchableOpacity style={[styles.searchButton, { backgroundColor: colors.deepNavy }]}>
                <Text style={[styles.searchButtonText, { color: colors.white }]}>Search</Text>
              </TouchableOpacity>
            </View>

            {/* Quick Stats with Icons */}
            <View style={styles.statsRow}>
              <View style={styles.statItem}>
                <View style={[styles.statIconCircle, { backgroundColor: `${colors.beeYellow}20` }]}>
                  <Icon name="work" size={24} color={colors.beeYellow} />
                </View>
                <Text style={[styles.statNumber, { color: colors.beeYellow }]}>{totalJobs}</Text>
                <Text style={[styles.statLabel, { color: colors.cream }]}>Active Jobs</Text>
              </View>
              <View style={styles.statDivider} />
              <View style={styles.statItem}>
                <View style={[styles.statIconCircle, { backgroundColor: `${colors.softBlue}20` }]}>
                  <Icon name="category" size={24} color={colors.softBlue} />
                </View>
                <Text style={[styles.statNumber, { color: colors.beeYellow }]}>{categories.length}</Text>
                <Text style={[styles.statLabel, { color: colors.cream }]}>Categories</Text>
              </View>
              <View style={styles.statDivider} />
              <View style={styles.statItem}>
                <View style={[styles.statIconCircle, { backgroundColor: `${colors.success}20` }]}>
                  <Icon name="business" size={24} color={colors.success} />
                </View>
                <Text style={[styles.statNumber, { color: colors.beeYellow }]}>500+</Text>
                <Text style={[styles.statLabel, { color: colors.cream }]}>Companies</Text>
              </View>
            </View>
          </View>
        </View>

        {/* Category Pills */}
        {categories.length > 0 && (
          <View style={[styles.categoriesSection, { backgroundColor: colors.white }]}>
            <ScrollView 
              horizontal 
              showsHorizontalScrollIndicator={false}
              contentContainerStyle={styles.categoriesScrollContent}
            >
              <TouchableOpacity
                style={[
                  styles.categoryPill,
                  { backgroundColor: colors.cream, borderColor: colors.lightGray },
                  !selectedCategory && { backgroundColor: colors.deepNavy }
                ]}
                onPress={() => setSelectedCategory('')}
              >
                <Icon name="apps" size={16} color={!selectedCategory ? colors.white : colors.deepNavy} />
                <Text style={[
                  styles.categoryPillText,
                  { color: colors.deepNavy },
                  !selectedCategory && { color: colors.white, fontWeight: '600' }
                ]}>
                  All Jobs
                </Text>
              </TouchableOpacity>
              {categories.map((category) => (
                <TouchableOpacity
                  key={category.id}
                  style={[
                    styles.categoryPill,
                    { backgroundColor: colors.cream, borderColor: colors.lightGray },
                    selectedCategory === category.name && { backgroundColor: colors.deepNavy }
                  ]}
                  onPress={() => setSelectedCategory(category.name)}
                >
                  <Text style={[
                    styles.categoryPillText,
                    { color: colors.deepNavy },
                    selectedCategory === category.name && { color: colors.white, fontWeight: '600' }
                  ]}>
                    {category.name}
                  </Text>
                </TouchableOpacity>
              ))}
            </ScrollView>
          </View>
        )}

        {/* Main Content Area with Sidebar */}
        <View style={styles.jobsContentWithSidebar}>
          {/* Filter Sidebar */}
          <View style={[styles.filterSidebar, { backgroundColor: colors.white }]}>
            <View style={styles.filterHeader}>
              <Icon name="tune" size={24} color={colors.deepNavy} />
              <Text style={[styles.filterTitle, { color: colors.deepNavy }]}>Filters</Text>
            </View>

            {/* Clear All Filters */}
            {(selectedJobType || selectedRemote) && (
              <TouchableOpacity 
                style={[styles.clearFiltersButton, { backgroundColor: `${colors.softBlue}15` }]}
                onPress={() => {
                  setSelectedJobType('');
                  setSelectedRemote('');
                }}
              >
                <Icon name="clear-all" size={16} color={colors.softBlue} />
                <Text style={[styles.clearFiltersText, { color: colors.softBlue }]}>Clear all filters</Text>
              </TouchableOpacity>
            )}
            
            {/* Employment Type Filter - Enhanced */}
            <View style={styles.filterGroup}>
              <TouchableOpacity 
                style={styles.filterGroupHeader}
                onPress={() => setEmploymentTypeExpanded(!employmentTypeExpanded)}
              >
                <View style={styles.filterGroupTitleContainer}>
                  <View style={[styles.filterGroupIconCircle, { backgroundColor: `${colors.softBlue}20` }]}>
                    <Icon name="work" size={18} color={colors.softBlue} />
                  </View>
                  <Text style={[styles.filterGroupTitle, { color: colors.deepNavy }]}>{t.employmentType}</Text>
                </View>
                <View style={[styles.expandIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon 
                    name={employmentTypeExpanded ? "expand-less" : "expand-more"} 
                    size={20} 
                    color={colors.deepNavy} 
                  />
                </View>
              </TouchableOpacity>
              {employmentTypeExpanded && (
                <View style={styles.filterOptions}>
                  {[
                    { label: 'All Types', value: '', icon: 'work-outline' },
                    { label: 'Full-time', value: 'Full-time', icon: 'work' },
                    { label: 'Part-time', value: 'Part-time', icon: 'schedule' },
                    { label: 'Contract', value: 'Contract', icon: 'description' },
                    { label: 'Freelance', value: 'Freelance', icon: 'laptop' },
                    { label: 'Internship', value: 'Internship', icon: 'school' }
                  ].map((option) => (
                    <TouchableOpacity
                      key={option.value}
                      style={[
                        styles.filterOption,
                        { backgroundColor: colors.white },
                        selectedJobType === option.value && [
                          styles.filterOptionActive,
                          { backgroundColor: colors.deepNavy, borderColor: colors.deepNavy }
                        ]
                      ]}
                      onPress={() => setSelectedJobType(option.value)}
                      activeOpacity={0.7}
                    >
                      <View style={[
                        styles.filterOptionIconCircle,
                        { backgroundColor: selectedJobType === option.value ? `${colors.white}20` : `${colors.softBlue}15` }
                      ]}>
                        <Icon 
                          name={option.icon} 
                          size={16} 
                          color={selectedJobType === option.value ? colors.white : colors.softBlue} 
                        />
                      </View>
                      <Text style={[
                        styles.filterOptionText,
                        { color: colors.deepNavy },
                        selectedJobType === option.value && { color: colors.white, fontFamily: fonts.bold }
                      ]}>
                        {option.label}
                      </Text>
                      {selectedJobType === option.value && (
                        <View style={[styles.checkmarkCircle, { backgroundColor: colors.beeYellow }]}>
                          <Icon name="check" size={14} color={colors.deepNavy} />
                        </View>
                      )}
                    </TouchableOpacity>
                  ))}
                </View>
              )}
            </View>

            {/* Work Model Filter - Enhanced */}
            <View style={styles.filterGroup}>
              <TouchableOpacity 
                style={styles.filterGroupHeader}
                onPress={() => setWorkModeExpanded(!workModeExpanded)}
              >
                <View style={styles.filterGroupTitleContainer}>
                  <View style={[styles.filterGroupIconCircle, { backgroundColor: `${colors.success}20` }]}>
                    <Icon name="home-work" size={18} color={colors.success} />
                  </View>
                  <Text style={[styles.filterGroupTitle, { color: colors.deepNavy }]}>{t.workMode}</Text>
                </View>
                <View style={[styles.expandIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon 
                    name={workModeExpanded ? "expand-less" : "expand-more"} 
                    size={20} 
                    color={colors.deepNavy} 
                  />
                </View>
              </TouchableOpacity>
              {workModeExpanded && (
                <View style={styles.filterOptions}>
                  {[
                    { label: 'All Modes', value: '', icon: 'public' },
                    { label: 'Remote', value: 'Remote', icon: 'home' },
                    { label: 'On-site', value: 'On-site', icon: 'business' }
                  ].map((mode) => (
                    <TouchableOpacity
                      key={mode.value}
                      style={[
                        styles.filterOption,
                        { backgroundColor: colors.white },
                        selectedRemote === mode.value && [
                          styles.filterOptionActive,
                          { backgroundColor: colors.deepNavy, borderColor: colors.deepNavy }
                        ]
                      ]}
                      onPress={() => setSelectedRemote(mode.value)}
                      activeOpacity={0.7}
                    >
                      <View style={[
                        styles.filterOptionIconCircle,
                        { backgroundColor: selectedRemote === mode.value ? `${colors.white}20` : `${colors.success}15` }
                      ]}>
                        <Icon 
                          name={mode.icon} 
                          size={16} 
                          color={selectedRemote === mode.value ? colors.white : colors.success} 
                        />
                      </View>
                      <Text style={[
                        styles.filterOptionText,
                        { color: colors.deepNavy },
                        selectedRemote === mode.value && { color: colors.white, fontFamily: fonts.bold }
                      ]}>
                        {mode.label}
                      </Text>
                      {selectedRemote === mode.value && (
                        <View style={[styles.checkmarkCircle, { backgroundColor: colors.beeYellow }]}>
                          <Icon name="check" size={14} color={colors.deepNavy} />
                        </View>
                      )}
                    </TouchableOpacity>
                  ))}
                </View>
              )}
            </View>
          </View>

          {/* Jobs Grid */}
          <View style={styles.jobsGridSection}>
            {/* Results Header with Sorting */}
            <View style={styles.resultsHeader}>
              <View style={styles.resultsLeftSection}>
                <Text style={[styles.resultsCount, { color: colors.deepNavy }]}>
                  {loading ? 'Loading...' : `${totalJobs} ${totalJobs === 1 ? 'job' : 'jobs'} found`}
                </Text>
                {(selectedCategory || selectedJobType || selectedRemote) && (
                  <View style={styles.activeFiltersRow}>
                    {selectedCategory && (
                      <View style={[styles.activeFilterChip, { backgroundColor: `${colors.deepNavy}15` }]}>
                        <Text style={[styles.activeFilterText, { color: colors.deepNavy }]}>{selectedCategory}</Text>
                        <TouchableOpacity onPress={() => setSelectedCategory('')}>
                          <Icon name="close" size={14} color={colors.deepNavy} />
                        </TouchableOpacity>
                      </View>
                    )}
                    {selectedJobType && (
                      <View style={[styles.activeFilterChip, { backgroundColor: `${colors.deepNavy}15` }]}>
                        <Text style={[styles.activeFilterText, { color: colors.deepNavy }]}>{selectedJobType}</Text>
                        <TouchableOpacity onPress={() => setSelectedJobType('')}>
                          <Icon name="close" size={14} color={colors.deepNavy} />
                        </TouchableOpacity>
                      </View>
                    )}
                  </View>
                )}
              </View>
              <View style={styles.resultsRightSection}>
                <View style={styles.sortContainer}>
                  <Icon name="sort" size={18} color={colors.warmGray} />
                  <Text style={[styles.sortLabel, { color: colors.warmGray }]}>Sort by:</Text>
                  <TouchableOpacity style={styles.sortButton}>
                    <Text style={[styles.sortButtonText, { color: colors.deepNavy }]}>Most Recent</Text>
                    <Icon name="arrow-drop-down" size={20} color={colors.deepNavy} />
                  </TouchableOpacity>
                </View>
                <View style={styles.viewToggle}>
                  <TouchableOpacity 
                    style={[
                      styles.viewToggleButton, 
                      { backgroundColor: viewMode === 'grid' ? colors.deepNavy : colors.cream }
                    ]}
                    onPress={() => setViewMode('grid')}
                  >
                    <Icon name="grid-view" size={18} color={viewMode === 'grid' ? colors.white : colors.deepNavy} />
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={[
                      styles.viewToggleButton, 
                      { backgroundColor: viewMode === 'list' ? colors.deepNavy : colors.cream }
                    ]}
                    onPress={() => setViewMode('list')}
                  >
                    <Icon name="view-list" size={18} color={viewMode === 'list' ? colors.white : colors.deepNavy} />
                  </TouchableOpacity>
                </View>
              </View>
            </View>

            {loading ? (
              <View style={styles.modernLoadingContainer}>
                <ActivityIndicator size="large" color={colors.deepNavy} />
                <Text style={[styles.modernLoadingText, { color: colors.deepNavy }]}>
                  Finding the perfect opportunities for you...
                </Text>
              </View>
            ) : jobs.length === 0 ? (
              <View style={styles.modernEmptyState}>
                <View style={[styles.emptyStateIcon, { backgroundColor: colors.cream }]}>
                  <Icon name="work-off" size={48} color={colors.warmGray} />
                </View>
                <Text style={[styles.emptyStateTitle, { color: colors.deepNavy }]}>No jobs found</Text>
                <Text style={[styles.emptyStateDescription, { color: colors.warmGray }]}>
                  Try adjusting your filters or search terms to find more opportunities
                </Text>
                <TouchableOpacity 
                  style={[styles.emptyStateButton, { backgroundColor: colors.deepNavy }]}
                  onPress={() => {
                    setSearchText('');
                    setSelectedCategory('');
                    setSelectedJobType('');
                    setSelectedRemote('');
                  }}
                >
                  <Text style={[styles.emptyStateButtonText, { color: colors.white }]}>Clear all filters</Text>
                </TouchableOpacity>
              </View>
            ) : (
              <View>
                <FlatList
                  data={jobs}
                  renderItem={renderJobCard}
                  keyExtractor={(item) => item.id}
                  numColumns={viewMode === 'grid' ? 2 : 1}
                  key={viewMode}
                  showsVerticalScrollIndicator={false}
                  contentContainerStyle={styles.modernJobsGrid}
                  scrollEnabled={false}
                  columnWrapperStyle={viewMode === 'grid' ? styles.modernJobsRow : undefined}
                />

                {/* Modern Pagination */}
                {totalPages > 1 && (
                  <View style={[styles.modernPagination, { backgroundColor: colors.white }]}>
                    <TouchableOpacity
                      style={[
                        styles.modernPaginationButton,
                        { borderColor: colors.lightGray },
                        currentPage === 1 && styles.modernPaginationButtonDisabled
                      ]}
                      onPress={() => handlePageChange(currentPage - 1)}
                      disabled={currentPage === 1}
                    >
                      <Icon name="chevron-left" size={20} color={currentPage === 1 ? colors.warmGray : colors.deepNavy} />
                      <Text style={[
                        styles.modernPaginationButtonText,
                        { color: currentPage === 1 ? colors.warmGray : colors.deepNavy }
                      ]}>
                        Previous
                      </Text>
                    </TouchableOpacity>

                    <View style={styles.modernPaginationNumbers}>
                      {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {
                        let pageNumber;
                        if (totalPages <= 5) {
                          pageNumber = i + 1;
                        } else if (currentPage <= 3) {
                          pageNumber = i + 1;
                        } else if (currentPage >= totalPages - 2) {
                          pageNumber = totalPages - 4 + i;
                        } else {
                          pageNumber = currentPage - 2 + i;
                        }

                        return (
                          <TouchableOpacity
                            key={pageNumber}
                            style={[
                              styles.modernPageNumber,
                              { borderColor: colors.lightGray },
                              currentPage === pageNumber && { 
                                backgroundColor: colors.deepNavy,
                                borderColor: colors.deepNavy
                              }
                            ]}
                            onPress={() => handlePageChange(pageNumber)}
                          >
                            <Text style={[
                              styles.modernPageNumberText,
                              { color: colors.deepNavy },
                              currentPage === pageNumber && { color: colors.white }
                            ]}>
                              {pageNumber}
                            </Text>
                          </TouchableOpacity>
                        );
                      })}
                    </View>

                    <TouchableOpacity
                      style={[
                        styles.modernPaginationButton,
                        { borderColor: colors.lightGray },
                        currentPage === totalPages && styles.modernPaginationButtonDisabled
                      ]}
                      onPress={() => handlePageChange(currentPage + 1)}
                      disabled={currentPage === totalPages}
                    >
                      <Text style={[
                        styles.modernPaginationButtonText,
                        { color: currentPage === totalPages ? colors.warmGray : colors.deepNavy }
                      ]}>
                        Next
                      </Text>
                      <Icon name="chevron-right" size={20} color={currentPage === totalPages ? colors.warmGray : colors.deepNavy} />
                    </TouchableOpacity>
                  </View>
                )}
              </View>
            )}
          </View>
        </View>
      </ScrollView>
      
      {/* Language dropdown overlay (same as HomeScreen) */}
      {showLanguageMenu && (
        <View style={styles.fullScreenDropdownOverlay}>
          <TouchableOpacity 
            style={styles.fullScreenTouchArea}
            onPress={() => setShowLanguageMenu(false)}
            activeOpacity={1}
          />
          <View style={[styles.absoluteLanguageDropdown, { top: dropdownPosition.top, right: dropdownPosition.right }]}>
            {languageOptions.map((language, index) => (
              <TouchableOpacity
                key={language.code}
                style={[
                  styles.languageOption,
                  currentLanguage === language.code && styles.languageOptionActive,
                  index === languageOptions.length - 1 && { borderBottomWidth: 0 }
                ]}
                onPress={() => changeLanguage(language.code)}
              >
                <Text style={styles.languageLabel}>{language.label}</Text>
                {currentLanguage === language.code && (
                  <Icon name="check" size={16} color={colors.beeYellow} />
                )}
              </TouchableOpacity>
            ))}
          </View>
        </View>
      )}
    </SafeAreaView>
  );
}

// Companies Screen (Placeholder)
function CompaniesScreen({ navigation }: any) {
  const colors = lightColors;

  return (
    <SafeAreaView style={styles.container}>
      <View style={styles.settingsHeader}>
        <TouchableOpacity 
          style={styles.settingsBackButton}
          onPress={() => navigation.goBack()}
        >
          <Icon name="arrow-back" size={24} color={colors.deepNavy} />
        </TouchableOpacity>
        <Text style={styles.settingsTitle}>Companies</Text>
      </View>
      <View style={styles.emptyStateContainer}>
        <Icon name="business" size={64} color={colors.warmGray} />
        <Text style={styles.emptyStateText}>Companies Coming Soon</Text>
        <Text style={styles.emptyStateSubtext}>Browse companies and their job listings</Text>
      </View>
    </SafeAreaView>
  );
}

// Bookmarks Screen - Modern Design
function BookmarksScreen({ navigation, isDarkMode, toggleTheme }: any) {
  const [user, setUser] = useState<any>(null);
  const [userData, setUserData] = useState<any>(null);
  const [bookmarkedJobs, setBookmarkedJobs] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [selectedLanguage, setSelectedLanguage] = useState('English');
  const [showLanguageMenu, setShowLanguageMenu] = useState(false);
  const colors = isDarkMode ? darkColors : lightColors;

  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, async (authUser) => {
      if (authUser) {
        setUser(authUser);
        // Fetch user data and bookmarked jobs
        const userDoc = await getDoc(doc(db, 'users', authUser.uid));
        if (userDoc.exists()) {
          const data = userDoc.data();
          setUserData(data);
          const bookmarkedJobIds = data.bookmarkedJobs || [];
          // Fetch full job details for bookmarked jobs
          const jobPromises = bookmarkedJobIds.map(async (jobId: string) => {
            const jobDoc = await getDoc(doc(db, 'jobs', jobId));
            if (jobDoc.exists()) {
              return { id: jobDoc.id, ...jobDoc.data() };
            }
            return null;
          });
          const jobs = (await Promise.all(jobPromises)).filter(job => job !== null);
          setBookmarkedJobs(jobs);
        }
      } else {
        navigation.replace('Login');
      }
      setLoading(false);
    });

    return unsubscribe;
  }, []);

  const handleRemoveBookmark = async (jobId: string) => {
    if (!user) return;

    try {
      const userRef = doc(db, 'users', user.uid);
      const currentBookmarks = bookmarkedJobs.map(job => job.id);
      const updatedBookmarks = currentBookmarks.filter(id => id !== jobId);
      
      await updateDoc(userRef, {
        bookmarkedJobs: updatedBookmarks
      });
      
      setBookmarkedJobs(bookmarkedJobs.filter(job => job.id !== jobId));
    } catch (error) {
      console.error('Error removing bookmark:', error);
      Alert.alert('Error', 'Failed to remove bookmark');
    }
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      {/* Header Toolbar */}
      <View style={[styles.jobsToolbar, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <View style={styles.jobsToolbarLeft}>
          <TouchableOpacity onPress={() => navigation.navigate('Home')}>
            <Image 
              source={require('./assets/favicon.png')}
              style={styles.toolbarLogo}
              resizeMode="contain"
            />
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Jobs')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Jobs</Text>
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Companies')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Companies</Text>
          </TouchableOpacity>
          {user && (
            <TouchableOpacity 
              style={[styles.toolbarNavButton, styles.toolbarBookmarksButton]}
              onPress={() => navigation.navigate('Bookmarks')}
            >
              <Icon name="bookmark" size={18} color={colors.beeYellow} />
              <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy, marginLeft: 4 }]}>Bookmarks</Text>
            </TouchableOpacity>
          )}
          
          {/* Language Selector */}
          <View style={styles.toolbarLanguageContainer}>
            <TouchableOpacity 
              style={[styles.toolbarLanguageButton, { backgroundColor: colors.cream }]}
              onPress={() => setShowLanguageMenu(!showLanguageMenu)}
            >
              <Icon name="language" size={20} color={colors.deepNavy} />
              <Text style={[styles.toolbarLanguageText, { color: colors.deepNavy }]}>
                {selectedLanguage}
              </Text>
              <Icon name="arrow-drop-down" size={20} color={colors.deepNavy} />
            </TouchableOpacity>
            
            {showLanguageMenu && (
              <View style={[styles.languageDropdownMenu, { backgroundColor: colors.white }]}>
                {['English', 'áŠ áˆ›áˆ­áŠ›', 'á‰µáŒáˆ­áŠ›', 'Oromiffa'].map((lang) => (
                  <TouchableOpacity
                    key={lang}
                    style={styles.languageMenuItem}
                    onPress={() => {
                      setSelectedLanguage(lang);
                      setShowLanguageMenu(false);
                    }}
                  >
                    <Text style={[
                      styles.languageMenuItemText,
                      { color: colors.deepNavy },
                      selectedLanguage === lang && { color: colors.beeYellow, fontWeight: '600' }
                    ]}>
                      {lang}
                    </Text>
                    {selectedLanguage === lang && (
                      <Icon name="check" size={16} color={colors.beeYellow} />
                    )}
                  </TouchableOpacity>
                ))}
              </View>
            )}
          </View>
        </View>
        
        <View style={styles.jobsToolbarRight}>
          {/* Theme Toggle Switch */}
          <TouchableOpacity 
            style={styles.toolbarThemeToggle}
            onPress={toggleTheme}
          >
            <View style={[
              styles.themeToggleTrack,
              { backgroundColor: isDarkMode ? colors.deepNavy : colors.lightGray }
            ]}>
              <Icon 
                name="wb-sunny" 
                size={14} 
                color={isDarkMode ? colors.warmGray : colors.beeYellow}
                style={styles.themeToggleIconLeft}
              />
              <View style={[
                styles.themeToggleKnob,
                { backgroundColor: colors.white },
                isDarkMode && styles.themeToggleKnobActive
              ]}>
                <Icon 
                  name={isDarkMode ? 'nightlight-round' : 'wb-sunny'} 
                  size={12} 
                  color={isDarkMode ? colors.deepNavy : colors.beeYellow}
                />
              </View>
              <Icon 
                name="nightlight-round" 
                size={14} 
                color={isDarkMode ? colors.beeYellow : colors.warmGray}
                style={styles.themeToggleIconRight}
              />
            </View>
          </TouchableOpacity>

          {user && (
            <>
              {userData?.profilePicture ? (
                <Image 
                  source={{ uri: userData.profilePicture }}
                  style={styles.toolbarProfilePicture}
                />
              ) : (
                <View style={[styles.toolbarProfilePlaceholder, { backgroundColor: colors.beeYellow }]}>
                  <Icon name="person" size={20} color={colors.deepNavy} />
                </View>
              )}
              <Text style={[styles.toolbarUserName, { color: colors.deepNavy }]}>
                {user.email?.split('@')[0]}
              </Text>
              <TouchableOpacity 
                style={styles.toolbarSettingsButton}
                onPress={() => navigation.navigate('Settings')}
              >
                <Icon name="settings" size={24} color={colors.deepNavy} />
              </TouchableOpacity>
              <TouchableOpacity 
                style={styles.toolbarLogoutButton}
                onPress={() => {
                  signOut(auth);
                  navigation.replace('Home');
                }}
              >
                <Icon name="logout" size={24} color={colors.danger} />
              </TouchableOpacity>
            </>
          )}
        </View>
      </View>

      <ScrollView style={[styles.jobsPageContainer, { backgroundColor: colors.cream }]}>
        {/* Hero Section */}
        <View style={[styles.bookmarksHeroSection, { backgroundColor: colors.deepNavy }]}>
          <View style={styles.heroBackgroundDecor}>
            <View style={[styles.heroCircle1, { backgroundColor: `${colors.beeYellow}15` }]} />
            <View style={[styles.heroCircle2, { backgroundColor: `${colors.softBlue}15` }]} />
          </View>
          
          <View style={styles.bookmarksHeroContent}>
            <View style={styles.bookmarksHeroIconCircle}>
              <Icon name="bookmark" size={40} color={colors.beeYellow} />
            </View>
            <Text style={[styles.bookmarksHeroTitle, { color: colors.white }]}>
              Your Bookmarked Jobs
            </Text>
            <Text style={[styles.bookmarksHeroSubtitle, { color: colors.cream }]}>
              {loading ? 'Loading...' : `${bookmarkedJobs.length} ${bookmarkedJobs.length === 1 ? 'job' : 'jobs'} saved`}
            </Text>
          </View>
        </View>

        {/* Content Section */}
        <View style={styles.bookmarksContentContainer}>
          {loading ? (
            <View style={styles.bookmarksLoadingContainer}>
              <ActivityIndicator size="large" color={colors.beeYellow} />
              <Text style={[styles.bookmarksLoadingText, { color: colors.warmGray }]}>
                Loading your bookmarked jobs...
              </Text>
            </View>
          ) : bookmarkedJobs.length === 0 ? (
            <View style={[styles.bookmarksEmptyState, { backgroundColor: colors.white }]}>
              <View style={[styles.bookmarksEmptyIconCircle, { backgroundColor: colors.cream }]}>
                <Icon name="bookmark-outline" size={80} color={colors.warmGray} />
              </View>
              <Text style={[styles.bookmarksEmptyTitle, { color: colors.deepNavy }]}>
                No Bookmarked Jobs Yet
              </Text>
              <Text style={[styles.bookmarksEmptySubtitle, { color: colors.warmGray }]}>
                Start exploring jobs and bookmark the ones you're interested in. They'll appear here for easy access.
              </Text>
              <TouchableOpacity 
                style={[styles.bookmarksEmptyButton, { backgroundColor: colors.beeYellow }]}
                onPress={() => navigation.navigate('Jobs')}
              >
                <Icon name="search" size={20} color={colors.deepNavy} />
                <Text style={[styles.bookmarksEmptyButtonText, { color: colors.deepNavy }]}>
                  Browse Jobs
                </Text>
              </TouchableOpacity>
            </View>
          ) : (
            <View style={styles.bookmarksGridContainer}>
              <View style={styles.bookmarksGridHeader}>
                <Text style={[styles.bookmarksGridTitle, { color: colors.deepNavy }]}>
                  Saved Opportunities
                </Text>
                <View style={styles.bookmarksGridStats}>
                  <Icon name="bookmark" size={18} color={colors.beeYellow} />
                  <Text style={[styles.bookmarksGridStatsText, { color: colors.warmGray }]}>
                    {bookmarkedJobs.length} {bookmarkedJobs.length === 1 ? 'Job' : 'Jobs'}
                  </Text>
                </View>
              </View>

              <View style={styles.bookmarksGrid}>
                {bookmarkedJobs.map((job: any) => (
                  <TouchableOpacity
                    key={job.id}
                    style={[styles.modernBookmarkCard, { backgroundColor: colors.white }]}
                    onPress={() => navigation.navigate('JobDetails', { id: job.id, job })}
                    activeOpacity={0.7}
                  >
                    {/* Card Header */}
                    <View style={styles.modernBookmarkCardHeader}>
                      <View style={styles.modernBookmarkLogoContainer}>
                        {job.sourceImageUrl ? (
                          <Image
                            source={{ uri: job.sourceImageUrl }}
                            style={styles.modernBookmarkLogo}
                            resizeMode="cover"
                          />
                        ) : (
                          <View style={[styles.modernBookmarkLogoPlaceholder, { backgroundColor: colors.cream }]}>
                            <Text style={[styles.modernBookmarkLogoText, { color: colors.deepNavy }]}>
                              {job.company?.charAt(0) || 'C'}
                            </Text>
                          </View>
                        )}
                      </View>
                      <TouchableOpacity 
                        style={[styles.modernRemoveBookmarkButton, { backgroundColor: `${colors.danger}10` }]}
                        onPress={(e) => {
                          e.stopPropagation();
                          Alert.alert(
                            'Remove Bookmark',
                            'Are you sure you want to remove this job from your bookmarks?',
                            [
                              { text: 'Cancel', style: 'cancel' },
                              { text: 'Remove', style: 'destructive', onPress: () => handleRemoveBookmark(job.id) }
                            ]
                          );
                        }}
                      >
                        <Icon name="close" size={16} color={colors.danger} />
                      </TouchableOpacity>
                    </View>

                    {/* Job Info */}
                    <View style={styles.modernBookmarkCardBody}>
                      <Text style={[styles.modernBookmarkJobTitle, { color: colors.deepNavy }]} numberOfLines={2}>
                        {job.title || 'Job Title'}
                      </Text>
                      <Text style={[styles.modernBookmarkCompany, { color: colors.warmGray }]} numberOfLines={1}>
                        {job.company || 'Company Name'}
                      </Text>

                      {/* Tags */}
                      <View style={styles.modernBookmarkTags}>
                        {job.contractType && (
                          <View style={[styles.modernBookmarkTag, { backgroundColor: `${colors.softBlue}20`, borderColor: colors.softBlue }]}>
                            <Icon name="work-outline" size={12} color={colors.softBlue} />
                            <Text style={[styles.modernBookmarkTagText, { color: colors.softBlue }]}>{job.contractType}</Text>
                          </View>
                        )}
                        {job.isRemote && (
                          <View style={[styles.modernBookmarkTag, { backgroundColor: `${colors.success}20`, borderColor: colors.success }]}>
                            <Icon name="home-work" size={12} color={colors.success} />
                            <Text style={[styles.modernBookmarkTagText, { color: colors.success }]}>Remote</Text>
                          </View>
                        )}
                        {job.location && (
                          <View style={[styles.modernBookmarkTag, { backgroundColor: colors.cream, borderColor: `${colors.warmGray}40` }]}>
                            <Icon name="location-on" size={12} color={colors.warmGray} />
                            <Text style={[styles.modernBookmarkTagText, { color: colors.warmGray }]} numberOfLines={1}>
                              {job.location}
                            </Text>
                          </View>
                        )}
                      </View>

                      {/* Salary */}
                      {job.salary && (
                        <View style={[styles.modernBookmarkSalary, { backgroundColor: `${colors.success}10` }]}>
                          <Icon name="payments" size={16} color={colors.success} />
                          <Text style={[styles.modernBookmarkSalaryText, { color: colors.success }]}>
                            {job.salary}
                          </Text>
                        </View>
                      )}
                    </View>

                    {/* Card Footer */}
                    <View style={[styles.modernBookmarkCardFooter, { borderTopColor: colors.lightGray }]}>
                      <View style={styles.modernBookmarkDate}>
                        <Icon name="access-time" size={14} color={colors.warmGray} />
                        <Text style={[styles.modernBookmarkDateText, { color: colors.warmGray }]}>
                          {job.createdAt ? new Date(job.createdAt.seconds * 1000).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) : 'Recent'}
                        </Text>
                      </View>
                      <View style={[styles.modernBookmarkApplyButton, { backgroundColor: colors.deepNavy }]}>
                        <Text style={[styles.modernBookmarkApplyText, { color: colors.white }]}>View</Text>
                        <Icon name="arrow-forward" size={14} color={colors.white} />
                      </View>
                    </View>
                  </TouchableOpacity>
                ))}
              </View>
            </View>
          )}
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Settings Screen - Main Menu
function SettingsScreen({ navigation, isDarkMode, toggleTheme }: any) {
  const [user, setUser] = useState<any>(null);
  const [userData, setUserData] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [selectedMenu, setSelectedMenu] = useState<string>('profile');
  const [bookmarkedJobs, setBookmarkedJobs] = useState<string[]>([]);
  const [selectedLanguage, setSelectedLanguage] = useState('English');
  const [showLanguageMenu, setShowLanguageMenu] = useState(false);
  const languageButtonRef = useRef<any>(null);
  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, right: 0 });
  const [currentLanguage, setCurrentLanguage] = useState('en');
  
  const colors = isDarkMode ? darkColors : lightColors;
  
  const languageOptions = [
    { code: 'en', label: 'English' },
    { code: 'am', label: 'áŠ áˆ›áˆ­áŠ›' },
    { code: 'ti', label: 'á‰µáŒáˆ­áŠ›' },
    { code: 'or', label: 'Afaan Oromoo' }
  ];
  
  const getCurrentLanguage = () => {
    return languageOptions.find(lang => lang.code === currentLanguage) || languageOptions[0];
  };
  
  const toggleLanguageDropdown = () => {
    if (!showLanguageMenu && languageButtonRef.current) {
      languageButtonRef.current.measureInWindow((x: number, y: number, width: number, height: number) => {
        setDropdownPosition({
          top: y + height + 5,
          right: typeof window !== 'undefined' ? window.innerWidth - x - width : 0,
        });
      });
    }
    setShowLanguageMenu(!showLanguageMenu);
  };
  
  const changeLanguage = async (langCode: string) => {
    setCurrentLanguage(langCode);
    setSelectedLanguage(languageOptions.find(lang => lang.code === langCode)?.label || 'English');
    setShowLanguageMenu(false);
    try {
      await AsyncStorage.setItem('selectedLanguage', langCode);
    } catch (error) {
      console.error('Error saving language preference:', error);
    }
  };

  useEffect(() => {
    const initializeSettings = async () => {
      // Load saved language
      const savedLanguage = await AsyncStorage.getItem('selectedLanguage');
      if (savedLanguage) {
        setCurrentLanguage(savedLanguage);
        setSelectedLanguage(languageOptions.find(lang => lang.code === savedLanguage)?.label || 'English');
      }
    };
    
    initializeSettings();
    
    const unsubscribe = onAuthStateChanged(auth, async (authUser) => {
      if (authUser) {
        setUser(authUser);
        // Fetch user data
        const userDoc = await getDoc(doc(db, 'users', authUser.uid));
        if (userDoc.exists()) {
          const data = userDoc.data();
          setUserData(data);
          setBookmarkedJobs(data.bookmarkedJobs || []);
        }
      } else {
        navigation.replace('Login');
      }
      setLoading(false);
    });

    return unsubscribe;
  }, []);

  const settingsMenuItems = [
    {
      id: 'account',
      title: 'Account',
      subtitle: 'Profile & security',
      icon: 'person',
      color: '#4A90E2',
    },
    {
      id: 'preferences',
      title: 'Preferences',
      subtitle: 'Theme & language',
      icon: 'tune',
      color: '#9B59B6',
    },
    {
      id: 'notifications',
      title: 'Notifications',
      subtitle: 'Manage alerts',
      icon: 'notifications',
      color: '#E67E22',
    },
    {
      id: 'privacy',
      title: 'Privacy & Security',
      subtitle: 'Data & permissions',
      icon: 'security',
      color: '#27AE60',
    },
    {
      id: 'subscription',
      title: 'Subscription',
      subtitle: userData?.subscriptionPlan || 'Free Plan',
      icon: 'workspace-premium',
      color: '#F4C430',
    },
    {
      id: 'help',
      title: 'Help & Support',
      subtitle: 'FAQs & contact',
      icon: 'help',
      color: '#3498DB',
    },
  ];

  const renderSettingsContent = () => {
    const props = { userData, user, isDarkMode, toggleTheme, colors, navigation, currentLanguage, setCurrentLanguage, changeLanguage };
    
    switch (selectedMenu) {
      case 'account':
        return <SettingsAccountContent {...props} />;
      case 'preferences':
        return <SettingsPreferencesContent {...props} />;
      case 'notifications':
        return <SettingsNotificationsContent {...props} />;
      case 'privacy':
        return <SettingsPrivacyContent {...props} />;
      case 'subscription':
        return <SettingsSubscriptionContent {...props} />;
      case 'help':
        return <SettingsHelpContent {...props} />;
      default:
        return <SettingsAccountContent {...props} />;
    }
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      {/* Header Toolbar - Reused from Jobs Screen */}
      <View style={[styles.jobsToolbar, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <View style={styles.jobsToolbarLeft}>
          <TouchableOpacity onPress={() => navigation.navigate('Home')}>
            <Image 
              source={require('./assets/favicon.png')}
              style={styles.toolbarLogo}
              resizeMode="contain"
            />
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Jobs')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Jobs</Text>
          </TouchableOpacity>
          <TouchableOpacity 
            style={styles.toolbarNavButton}
            onPress={() => navigation.navigate('Companies')}
          >
            <Text style={[styles.toolbarNavButtonText, { color: colors.deepNavy }]}>Companies</Text>
          </TouchableOpacity>
          
          {/* Language Selector */}
          <View style={styles.toolbarLanguageContainer}>
            <TouchableOpacity 
              ref={languageButtonRef}
              style={[styles.toolbarLanguageButton, { backgroundColor: colors.cream }]}
              onPress={toggleLanguageDropdown}
            >
              <Icon name="language" size={20} color={colors.deepNavy} />
              <Text style={[styles.toolbarLanguageText, { color: colors.deepNavy }]}>
                {getCurrentLanguage().code.toUpperCase()}
              </Text>
              <Icon name={showLanguageMenu ? "expand-less" : "expand-more"} size={20} color={colors.deepNavy} />
            </TouchableOpacity>
          </View>
        </View>
        
        <View style={styles.jobsToolbarRight}>
          {/* Theme Toggle Switch */}
          <TouchableOpacity 
            style={styles.toolbarThemeToggle}
            onPress={toggleTheme}
          >
            <View style={[
              styles.themeToggleTrack,
              { backgroundColor: isDarkMode ? colors.deepNavy : colors.lightGray }
            ]}>
              <Icon 
                name="wb-sunny" 
                size={14} 
                color={isDarkMode ? colors.warmGray : colors.beeYellow}
                style={styles.themeToggleIconLeft}
              />
              <View style={[
                styles.themeToggleKnob,
                { backgroundColor: colors.white },
                isDarkMode && styles.themeToggleKnobActive
              ]}>
                <Icon 
                  name={isDarkMode ? 'nightlight-round' : 'wb-sunny'} 
                  size={12} 
                  color={isDarkMode ? colors.deepNavy : colors.beeYellow}
                />
              </View>
              <Icon 
                name="nightlight-round" 
                size={14} 
                color={isDarkMode ? colors.beeYellow : colors.warmGray}
                style={styles.themeToggleIconRight}
              />
            </View>
          </TouchableOpacity>

          {user && (
            <>
              {userData?.profilePicture ? (
                <Image 
                  source={{ uri: userData.profilePicture }}
                  style={styles.toolbarProfilePicture}
                />
              ) : (
                <View style={[styles.toolbarProfilePlaceholder, { backgroundColor: colors.beeYellow }]}>
                  <Icon name="person" size={20} color={colors.deepNavy} />
                </View>
              )}
              <Text style={[styles.toolbarUserName, { color: colors.deepNavy }]}>
                {user.email?.split('@')[0]}
              </Text>
              <TouchableOpacity 
                style={styles.toolbarSettingsButton}
                onPress={() => navigation.navigate('Settings')}
              >
                <Icon name="settings" size={24} color={colors.beeYellow} />
              </TouchableOpacity>
              <TouchableOpacity 
                style={styles.toolbarLogoutButton}
                onPress={() => {
                  signOut(auth);
                  navigation.replace('Home');
                }}
              >
                <Icon name="logout" size={24} color={colors.danger} />
              </TouchableOpacity>
            </>
          )}
        </View>
      </View>

      {loading ? (
        <View style={styles.settingsLoadingContainer}>
          <ActivityIndicator size="large" color={colors.beeYellow} />
        </View>
      ) : (
        <ScrollView style={{ flex: 1, backgroundColor: colors.white }} showsVerticalScrollIndicator={false}>
          {/* Modern Profile Header */}
          <View style={[styles.settingsProfileHeader, { backgroundColor: colors.white }]}>
            <View style={styles.settingsProfileContent}>
              <View style={styles.settingsProfileLeft}>
                {userData?.profilePicture ? (
                  <Image 
                    source={{ uri: userData.profilePicture }} 
                    style={styles.settingsProfileImage}
                  />
                ) : (
                  <View style={[styles.settingsProfileImagePlaceholder, { backgroundColor: colors.beeYellow }]}>
                    <Text style={{ fontSize: 32, fontWeight: '700', color: colors.deepNavy }}>
                      {(userData?.displayName || user?.email)?.[0]?.toUpperCase()}
                    </Text>
                  </View>
                )}
                <View style={styles.settingsProfileDetails}>
                  <Text style={[styles.settingsProfileName, { color: colors.deepNavy }]}>
                    {userData?.displayName || user?.email?.split('@')[0] || 'User'}
                  </Text>
                  <Text style={[styles.settingsProfileEmail, { color: colors.warmGray }]}>
                    {user?.email}
                  </Text>
                  {userData?.username && (
                    <TouchableOpacity 
                      style={styles.settingsProfileUsername}
                      onPress={() => {
                        const profileUrl = `https://nibjobs.com/@${userData.username}`;
                        if (typeof navigator !== 'undefined' && navigator.clipboard) {
                          navigator.clipboard.writeText(profileUrl);
                          Alert.alert('Copied!', 'Profile link copied to clipboard');
                        }
                      }}
                    >
                      <Text style={{ color: colors.softBlue, fontSize: 13 }}>@{userData.username}</Text>
                      <Icon name="content-copy" size={12} color={colors.softBlue} />
                    </TouchableOpacity>
                  )}
                </View>
              </View>
              <TouchableOpacity 
                style={[styles.settingsEditButton, { backgroundColor: colors.cream }]}
                onPress={() => setSelectedMenu('account')}
              >
                <Icon name="edit" size={16} color={colors.deepNavy} />
              </TouchableOpacity>
            </View>
          </View>

          {/* Stats Cards */}
          <View style={styles.settingsStatsContainer}>
            <View style={[styles.settingsStatCard, { backgroundColor: colors.cream }]}>
              <Icon name="bookmark" size={24} color={colors.beeYellow} />
              <Text style={[styles.settingsStatNumber, { color: colors.deepNavy }]}>
                {bookmarkedJobs.length}
              </Text>
              <Text style={[styles.settingsStatLabel, { color: colors.warmGray }]}>Saved</Text>
            </View>
            <View style={[styles.settingsStatCard, { backgroundColor: colors.cream }]}>
              <Icon name="workspace-premium" size={24} color={colors.beeYellow} />
              <Text style={[styles.settingsStatNumber, { color: colors.deepNavy }]}>
                {userData?.subscriptionPlan === 'premium' ? 'Pro' : 'Free'}
              </Text>
              <Text style={[styles.settingsStatLabel, { color: colors.warmGray }]}>Plan</Text>
            </View>
            <View style={[styles.settingsStatCard, { backgroundColor: colors.cream }]}>
              <Icon name="verified" size={24} color={colors.beeYellow} />
              <Text style={[styles.settingsStatNumber, { color: colors.deepNavy }]}>
                {user?.emailVerified ? 'Yes' : 'No'}
              </Text>
              <Text style={[styles.settingsStatLabel, { color: colors.warmGray }]}>Verified</Text>
            </View>
          </View>

          {/* Settings List */}
          <View style={styles.settingsListContainer}>
            <Text style={[styles.settingsSectionHeader, { color: colors.warmGray }]}>ACCOUNT</Text>
            
            <TouchableOpacity 
              style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}
              onPress={() => setSelectedMenu('account')}
            >
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#E3F2FD' }]}>
                  <Icon name="person" size={20} color="#2196F3" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Profile</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    Name, username, bio
                  </Text>
                </View>
              </View>
              <Icon name="chevron-right" size={20} color={colors.warmGray} />
            </TouchableOpacity>

            <TouchableOpacity 
              style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}
              onPress={() => setSelectedMenu('privacy')}
            >
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#E8F5E9' }]}>
                  <Icon name="security" size={20} color="#4CAF50" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Privacy & Security</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    Control your data
                  </Text>
                </View>
              </View>
              <Icon name="chevron-right" size={20} color={colors.warmGray} />
            </TouchableOpacity>

            <Text style={[styles.settingsSectionHeader, { color: colors.warmGray, marginTop: 32 }]}>PREFERENCES</Text>

            <TouchableOpacity 
              style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}
              onPress={() => setSelectedMenu('notifications')}
            >
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#FFF3E0' }]}>
                  <Icon name="notifications" size={20} color="#FF9800" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Notifications</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    Alerts and updates
                  </Text>
                </View>
              </View>
              <Icon name="chevron-right" size={20} color={colors.warmGray} />
            </TouchableOpacity>

            <View style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#F3E5F5' }]}>
                  <Icon name={isDarkMode ? 'dark-mode' : 'light-mode'} size={20} color="#9C27B0" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Dark Mode</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    {isDarkMode ? 'Enabled' : 'Disabled'}
                  </Text>
                </View>
              </View>
              <Switch
                value={isDarkMode}
                onValueChange={toggleTheme}
                trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
                thumbColor={colors.white}
              />
            </View>

            <TouchableOpacity 
              style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}
              onPress={() => setSelectedMenu('preferences')}
            >
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#E1F5FE' }]}>
                  <Icon name="language" size={20} color="#03A9F4" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Language</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    {languageOptions.find(lang => lang.code === currentLanguage)?.label || 'English'}
                  </Text>
                </View>
              </View>
              <Icon name="chevron-right" size={20} color={colors.warmGray} />
            </TouchableOpacity>

            <Text style={[styles.settingsSectionHeader, { color: colors.warmGray, marginTop: 32 }]}>MORE</Text>

            <TouchableOpacity 
              style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}
              onPress={() => setSelectedMenu('subscription')}
            >
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#FFF9C4' }]}>
                  <Icon name="workspace-premium" size={20} color="#FBC02D" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Subscription</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    {userData?.subscriptionPlan || 'Free Plan'}
                  </Text>
                </View>
              </View>
              <Icon name="chevron-right" size={20} color={colors.warmGray} />
            </TouchableOpacity>

            <TouchableOpacity 
              style={[styles.settingsListItem, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}
              onPress={() => setSelectedMenu('help')}
            >
              <View style={styles.settingsListItemLeft}>
                <View style={[styles.settingsListIcon, { backgroundColor: '#E0F2F1' }]}>
                  <Icon name="help" size={20} color="#009688" />
                </View>
                <View>
                  <Text style={[styles.settingsListTitle, { color: colors.deepNavy }]}>Help & Support</Text>
                  <Text style={[styles.settingsListSubtitle, { color: colors.warmGray }]}>
                    FAQs and contact
                  </Text>
                </View>
              </View>
              <Icon name="chevron-right" size={20} color={colors.warmGray} />
            </TouchableOpacity>

            {/* Logout Button */}
            <TouchableOpacity 
              style={[styles.settingsLogoutButton, { borderColor: colors.error }]}
              onPress={async () => {
                Alert.alert(
                  'Logout',
                  'Are you sure you want to logout?',
                  [
                    { text: 'Cancel', style: 'cancel' },
                    { 
                      text: 'Logout', 
                      style: 'destructive',
                      onPress: async () => {
                        await signOut(auth);
                        navigation.replace('Home');
                      }
                    }
                  ]
                );
              }}
            >
              <Icon name="logout" size={20} color={colors.error} />
              <Text style={[styles.settingsLogoutText, { color: colors.error }]}>Logout</Text>
            </TouchableOpacity>
          </View>

          {/* App Info Footer */}
          <View style={styles.settingsAppInfo}>
            <Text style={[styles.settingsAppVersion, { color: colors.warmGray }]}>
              NibJobs v2.0
            </Text>
            <Text style={[styles.settingsAppCopyright, { color: colors.warmGray }]}>
              Â© 2025 NibJobs. Made in Ethiopia
            </Text>
          </View>
        </ScrollView>
      )}
      
      {/* Settings Detail Modal */}
      <Modal
        visible={selectedMenu !== null && selectedMenu !== 'account'}
        animationType="slide"
        presentationStyle="pageSheet"
        onRequestClose={() => setSelectedMenu(null)}
      >
        <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
          <View style={[styles.settingsModalHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
            <TouchableOpacity onPress={() => setSelectedMenu(null)} style={styles.settingsModalBackButton}>
              <Icon name="close" size={24} color={colors.deepNavy} />
            </TouchableOpacity>
            <Text style={[styles.settingsModalTitle, { color: colors.deepNavy }]}>
              {settingsMenuItems.find(item => item.id === selectedMenu)?.title}
            </Text>
            <View style={{ width: 40 }} />
          </View>
          <ScrollView style={{ flex: 1 }} showsVerticalScrollIndicator={false}>
            {renderSettingsContent()}
          </ScrollView>
        </SafeAreaView>
      </Modal>

      {/* Account Settings (Full Page) */}
      {selectedMenu === 'account' && (
        <Modal
          visible={true}
          animationType="slide"
          presentationStyle="fullScreen"
          onRequestClose={() => setSelectedMenu(null)}
        >
          <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
            <View style={[styles.settingsModalHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
              <TouchableOpacity onPress={() => setSelectedMenu(null)} style={styles.settingsModalBackButton}>
                <Icon name="arrow-back" size={24} color={colors.deepNavy} />
              </TouchableOpacity>
              <Text style={[styles.settingsModalTitle, { color: colors.deepNavy }]}>
                Account Settings
              </Text>
              <View style={{ width: 40 }} />
            </View>
            <ScrollView style={{ flex: 1 }} showsVerticalScrollIndicator={false}>
              <SettingsAccountContent {...{ userData, user, isDarkMode, toggleTheme, colors, navigation }} />
            </ScrollView>
          </SafeAreaView>
        </Modal>
      )}
      
      {/* Language dropdown overlay (same as JobsScreen) */}
      {showLanguageMenu && (
        <View style={styles.fullScreenDropdownOverlay}>
          <TouchableOpacity 
            style={styles.fullScreenTouchArea}
            onPress={() => setShowLanguageMenu(false)}
            activeOpacity={1}
          />
          <View style={[styles.absoluteLanguageDropdown, { top: dropdownPosition.top, right: dropdownPosition.right }]}>
            {languageOptions.map((language, index) => (
              <TouchableOpacity
                key={language.code}
                style={[
                  styles.languageOption,
                  currentLanguage === language.code && styles.languageOptionActive,
                  index === languageOptions.length - 1 && { borderBottomWidth: 0 }
                ]}
                onPress={() => changeLanguage(language.code)}
              >
                <Text style={styles.languageLabel}>{language.label}</Text>
                {currentLanguage === language.code && (
                  <Icon name="check" size={16} color={colors.beeYellow} />
                )}
              </TouchableOpacity>
            ))}
          </View>
        </View>
      )}
    </SafeAreaView>
  );
}

// Settings Content Components

function SettingsAccountContent({ userData, user, colors }: any) {
  const [displayName, setDisplayName] = useState(userData?.displayName || '');
  const [username, setUsername] = useState(userData?.username || '');
  const [dateOfBirth, setDateOfBirth] = useState(userData?.dateOfBirth || '');
  const [bio, setBio] = useState(userData?.bio || '');
  const [profilePicture, setProfilePicture] = useState(userData?.profilePicture || '');
  const [saving, setSaving] = useState(false);
  const [uploading, setUploading] = useState(false);
  const [usernameAvailable, setUsernameAvailable] = useState<boolean | null>(null);
  const [checkingUsername, setCheckingUsername] = useState(false);
  
  // Check username availability
  const checkUsernameAvailability = async (usernameToCheck: string) => {
    if (!usernameToCheck || usernameToCheck.length < 3) {
      setUsernameAvailable(null);
      return;
    }
    
    // Don't check if it's the same as current username
    if (usernameToCheck.toLowerCase() === userData?.username?.toLowerCase()) {
      setUsernameAvailable(true);
      return;
    }
    
    setCheckingUsername(true);
    try {
      const usernameQuery = dbQuery(
        collection(db, 'users'),
        where('username', '==', usernameToCheck.toLowerCase())
      );
      const querySnapshot = await getDocs(usernameQuery);
      setUsernameAvailable(querySnapshot.empty);
    } catch (error) {
      console.error('Error checking username:', error);
      setUsernameAvailable(null);
    }
    setCheckingUsername(false);
  };
  
  // Debounced username check
  useEffect(() => {
    const timeoutId = setTimeout(() => {
      if (username && username !== userData?.username) {
        checkUsernameAvailability(username);
      }
    }, 500);
    
    return () => clearTimeout(timeoutId);
  }, [username]);

  const pickImage = async () => {
    try {
      const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();
      
      if (status !== 'granted') {
        Alert.alert('Permission Required', 'Sorry, we need camera roll permissions to upload photos.');
        return;
      }

      const result = await ImagePicker.launchImageLibraryAsync({
        mediaTypes: ImagePicker.MediaTypeOptions.Images,
        allowsEditing: true,
        aspect: [1, 1],
        quality: 0.8,
      });

      if (!result.canceled && result.assets[0]) {
        setUploading(true);
        await uploadImage(result.assets[0].uri);
      }
    } catch (error) {
      console.error('Error picking image:', error);
      Alert.alert('Error', 'Failed to pick image');
    } finally {
      setUploading(false);
    }
  };

  const uploadImage = async (uri: string) => {
    if (!user) return;

    try {
      const response = await fetch(uri);
      const blob = await response.blob();

      const filename = `profile_pictures/${user.uid}_${Date.now()}.jpg`;
      const storageRef = ref(storage, filename);

      await uploadBytes(storageRef, blob);
      const downloadURL = await getDownloadURL(storageRef);
      
      setProfilePicture(downloadURL);
      
      await updateDoc(doc(db, 'users', user.uid), {
        profilePicture: downloadURL,
      });
      
      Alert.alert('Success', 'Photo uploaded successfully!');
    } catch (error) {
      console.error('Error uploading image:', error);
      Alert.alert('Error', 'Failed to upload photo');
    }
  };

  const saveProfile = async () => {
    if (!user) return;
    
    // Validate username
    if (username.length < 3) {
      Alert.alert('Error', 'Username must be at least 3 characters long');
      return;
    }
    
    if (!/^[a-zA-Z0-9_]+$/.test(username)) {
      Alert.alert('Error', 'Username can only contain letters, numbers, and underscores');
      return;
    }
    
    if (username !== userData?.username && !usernameAvailable) {
      Alert.alert('Error', 'This username is already taken');
      return;
    }

    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        displayName,
        username: username.toLowerCase(),
        dateOfBirth,
        bio,
        profilePicture,
      });
      Alert.alert('Success', 'Profile updated successfully!');
    } catch (error) {
      console.error('Error updating profile:', error);
      Alert.alert('Error', 'Failed to update profile');
    } finally {
      setSaving(false);
    }
  };

  return (
    <ScrollView style={styles.settingsContentScroll} showsVerticalScrollIndicator={false}>
      <View style={styles.settingsContentSection}>
        <Text style={[styles.settingsContentTitle, { color: colors.deepNavy }]}>Profile</Text>
        <Text style={[styles.settingsContentSubtitle, { color: colors.warmGray }]}>
          Manage your personal information
        </Text>
        
        <View style={styles.settingsSection}>
          {/* Profile Picture - Centered & Clean */}
          <View style={styles.modernProfilePictureSection}>
            {profilePicture ? (
              <Image source={{ uri: profilePicture }} style={styles.modernProfilePicturePreview} />
            ) : (
              <View style={[styles.modernProfilePicturePlaceholder, { backgroundColor: colors.beeYellow }]}>
                <Icon name="person" size={80} color={colors.deepNavy} />
              </View>
            )}
            
            <TouchableOpacity 
              style={[styles.modernUploadButton, { backgroundColor: colors.beeYellow }]}
              onPress={pickImage}
              disabled={uploading}
            >
              <Icon name="cloud-upload" size={20} color={colors.deepNavy} />
              <Text style={[styles.modernUploadButtonText, { color: colors.deepNavy }]}>
                {uploading ? 'Uploading...' : 'Change Photo'}
              </Text>
            </TouchableOpacity>
          </View>

          {/* Form Fields - Modern Design */}
          <View style={[styles.modernInputCard, { backgroundColor: colors.white }]}>
            <Text style={[styles.modernInputLabel, { color: colors.deepNavy }]}>Display Name</Text>
            <TextInput
              style={[styles.modernTextInput, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="Enter your display name"
              placeholderTextColor={colors.warmGray}
              value={displayName}
              onChangeText={setDisplayName}
            />
          </View>
          
          <View style={[styles.modernInputCard, { backgroundColor: colors.white }]}>
            <View style={{ flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center' }}>
              <Text style={[styles.modernInputLabel, { color: colors.deepNavy }]}>Username</Text>
              {checkingUsername && (
                <Text style={{ fontSize: 12, color: colors.warmGray }}>Checking...</Text>
              )}
              {!checkingUsername && usernameAvailable === true && username !== userData?.username && (
                <View style={{ flexDirection: 'row', alignItems: 'center', gap: 4 }}>
                  <Icon name="check-circle" size={16} color="#22c55e" />
                  <Text style={{ fontSize: 12, color: '#22c55e' }}>Available</Text>
                </View>
              )}
              {!checkingUsername && usernameAvailable === false && username !== userData?.username && (
                <View style={{ flexDirection: 'row', alignItems: 'center', gap: 4 }}>
                  <Icon name="cancel" size={16} color="#ef4444" />
                  <Text style={{ fontSize: 12, color: '#ef4444' }}>Taken</Text>
                </View>
              )}
            </View>
            <TextInput
              style={[styles.modernTextInput, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="Enter your username"
              placeholderTextColor={colors.warmGray}
              value={username}
              onChangeText={setUsername}
              autoCapitalize="none"
            />
            <Text style={[styles.modernInputHint, { color: colors.warmGray }]}>
              Letters, numbers, and underscores only (min 3 characters)
            </Text>
          </View>

          <View style={[styles.modernInputCard, { backgroundColor: colors.white }]}>
            <Text style={[styles.modernInputLabel, { color: colors.deepNavy }]}>Bio</Text>
            <TextInput
              style={[styles.modernTextInput, styles.modernTextArea, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="Tell us about yourself..."
              placeholderTextColor={colors.warmGray}
              value={bio}
              onChangeText={setBio}
              multiline
              numberOfLines={4}
              textAlignVertical="top"
            />
          </View>

          <View style={[styles.modernInputCard, { backgroundColor: colors.white }]}>
            <Text style={[styles.modernInputLabel, { color: colors.deepNavy }]}>Date of Birth</Text>
            <TextInput
              style={[styles.modernTextInput, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="YYYY-MM-DD"
              placeholderTextColor={colors.warmGray}
              value={dateOfBirth}
              onChangeText={setDateOfBirth}
            />
            <Text style={[styles.modernInputHint, { color: colors.warmGray }]}>
              Format: YYYY-MM-DD (e.g., 1990-01-15)
            </Text>
          </View>

          <View style={[styles.modernInputCard, { backgroundColor: colors.white }]}>
            <Text style={[styles.modernInputLabel, { color: colors.deepNavy }]}>Email</Text>
            <TextInput
              style={[styles.modernTextInput, styles.modernTextInputDisabled, { backgroundColor: colors.lightGray, color: colors.warmGray }]}
              value={user?.email}
              editable={false}
            />
          </View>

          <TouchableOpacity 
            style={[styles.modernSaveButton, { backgroundColor: colors.beeYellow }, saving && styles.modernSaveButtonDisabled]}
            onPress={saveProfile}
            disabled={saving}
          >
            {saving ? (
              <ActivityIndicator size="small" color={colors.deepNavy} />
            ) : (
              <>
                <Icon name="check" size={20} color={colors.deepNavy} />
                <Text style={[styles.modernSaveButtonText, { color: colors.deepNavy }]}>Save Changes</Text>
              </>
            )}
          </TouchableOpacity>
        </View>
      </View>
    </ScrollView>
  );
}

function SettingsPreferencesContent({ colors, isDarkMode, toggleTheme, currentLanguage, changeLanguage }: any) {
  const languageOptions = [
    { code: 'en', label: 'English' },
    { code: 'am', label: 'áŠ áˆ›áˆ­áŠ›' },
    { code: 'ti', label: 'á‰µáŒáˆ­áŠ›' },
    { code: 'or', label: 'Afaan Oromoo' }
  ];
  
  return (
    <ScrollView style={styles.settingsContentScroll} showsVerticalScrollIndicator={false}>
      <View style={styles.settingsContentSection}>
        <Text style={[styles.settingsContentTitle, { color: colors.deepNavy }]}>Preferences</Text>
        <Text style={[styles.settingsContentSubtitle, { color: colors.warmGray }]}>
          Customize your theme and language preferences
        </Text>
        
        <View style={styles.settingsSection}>
          {/* Dark Mode Toggle */}
          <View style={[styles.modernInputCard, { backgroundColor: colors.white }]}>
            <View style={styles.modernToggleRow}>
              <View style={styles.modernToggleLeft}>
                <View style={[styles.modernIconCircle, { backgroundColor: colors.cream }]}>
                  <Icon name={isDarkMode ? 'dark-mode' : 'light-mode'} size={24} color={colors.beeYellow} />
                </View>
                <View>
                  <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>
                    Dark Mode
                  </Text>
                  <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                    {isDarkMode ? 'Dark theme enabled' : 'Light theme enabled'}
                  </Text>
                </View>
              </View>
              <Switch
                value={isDarkMode}
                onValueChange={toggleTheme}
                trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
                thumbColor={colors.white}
                ios_backgroundColor={colors.lightGray}
              />
            </View>
          </View>
          
          {/* Language Selection */}
          <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginTop: 16 }]}>
            <Text style={[styles.modernInputLabel, { color: colors.deepNavy, marginBottom: 12 }]}>Language</Text>
            {languageOptions.map((lang) => (
              <TouchableOpacity
                key={lang.code}
                style={[
                  styles.modernToggleRow,
                  { paddingVertical: 12 },
                  currentLanguage === lang.code && { backgroundColor: colors.cream }
                ]}
                onPress={() => changeLanguage(lang.code)}
              >
                <View style={styles.modernToggleLeft}>
                  <View style={[styles.modernIconCircle, { backgroundColor: colors.cream }]}>
                    <Icon name="language" size={24} color={colors.beeYellow} />
                  </View>
                  <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>
                    {lang.label}
                  </Text>
                </View>
                {currentLanguage === lang.code && (
                  <Icon name="check-circle" size={24} color={colors.beeYellow} />
                )}
              </TouchableOpacity>
            ))}
          </View>
        </View>
      </View>
    </ScrollView>
  );
}

function SettingsLanguageContent({ userData, user, colors }: any) {
  const [selectedLanguage, setSelectedLanguage] = useState(userData?.language || 'English');
  const [saving, setSaving] = useState(false);
  
  const languages = ['English', 'Amharic', 'Oromifa'];

  const saveLanguage = async () => {
    if (!user) return;

    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        language: selectedLanguage,
      });
      Alert.alert('Success', 'Language preference saved!');
    } catch (error) {
      console.error('Error saving language:', error);
      Alert.alert('Error', 'Failed to save language preference');
    } finally {
      setSaving(false);
    }
  };

  return (
    <ScrollView style={styles.settingsContentScroll}>
      <View style={styles.settingsContentSection}>
        <Text style={[styles.settingsContentTitle, { color: colors.deepNavy }]}>Language</Text>
        
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Select Language</Text>
          
          {languages.map((lang) => (
            <TouchableOpacity
              key={lang}
              style={[
                styles.settingsToggleItem,
                { backgroundColor: colors.white }
              ]}
              onPress={() => setSelectedLanguage(lang)}
            >
              <View style={styles.settingsToggleLeft}>
                <View style={[styles.settingsMenuIconContainer, { backgroundColor: colors.cream }]}>
                  <Icon name="language" size={24} color={colors.beeYellow} />
                </View>
                <Text style={[styles.settingsMenuTitle, { color: colors.deepNavy }]}>
                  {lang}
                </Text>
              </View>
              {selectedLanguage === lang && (
                <Icon name="check-circle" size={24} color={colors.success} />
              )}
            </TouchableOpacity>
          ))}
        </View>

        <TouchableOpacity 
          style={[styles.settingsSaveButton, { backgroundColor: colors.beeYellow }, saving && styles.settingsSaveButtonDisabled]}
          onPress={saveLanguage}
          disabled={saving}
        >
          {saving ? (
            <ActivityIndicator size="small" color="#1a1a2e" />
          ) : (
            <Text style={[styles.settingsSaveButtonText, { color: '#1a1a2e' }]}>Save Changes</Text>
          )}
        </TouchableOpacity>
      </View>
    </ScrollView>
  );
}

function SettingsInterestsContent({ userData, user, colors }: any) {
  const [categories, setCategories] = useState<any[]>([]);
  const [selectedCategories, setSelectedCategories] = useState<string[]>(userData?.interestedCategories || []);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);

  useEffect(() => {
    fetchCategories();
  }, []);

  const fetchCategories = async () => {
    try {
      setLoading(true);
      const categoriesCollection = collection(db, 'categories');
      const categoriesSnapshot = await getDocs(categoriesCollection);
      const categoriesData = categoriesSnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      setCategories(categoriesData);
    } catch (error) {
      console.error('Error fetching categories:', error);
    } finally {
      setLoading(false);
    }
  };

  const toggleCategory = (categoryId: string) => {
    if (selectedCategories.includes(categoryId)) {
      setSelectedCategories(selectedCategories.filter(id => id !== categoryId));
    } else {
      setSelectedCategories([...selectedCategories, categoryId]);
    }
  };

  const saveInterests = async () => {
    if (!user) return;

    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        interestedCategories: selectedCategories,
      });
      Alert.alert('Success', 'Interests saved successfully!');
    } catch (error) {
      console.error('Error saving interests:', error);
      Alert.alert('Error', 'Failed to save interests');
    } finally {
      setSaving(false);
    }
  };

  return (
    <ScrollView style={styles.settingsContentScroll}>
      <View style={styles.settingsContentSection}>
        <Text style={[styles.settingsContentTitle, { color: colors.deepNavy }]}>Job Interests</Text>
        
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Interested Job Categories</Text>
          <Text style={[styles.settingsSectionSubtitle, { color: colors.warmGray }]}>
            Select categories to personalize your job recommendations
          </Text>
          
          {loading ? (
            <View style={styles.settingsLoadingContainer}>
              <ActivityIndicator size="large" color={colors.beeYellow} />
            </View>
          ) : (
            <View style={styles.settingsCategoriesGrid}>
              {categories.map((category) => (
                <TouchableOpacity
                  key={category.id}
                  style={[
                    styles.settingsCategoryChip,
                    {
                      backgroundColor: selectedCategories.includes(category.id)
                        ? colors.beeYellow
                        : colors.white,
                      borderColor: selectedCategories.includes(category.id)
                        ? colors.beeYellow
                        : colors.lightGray,
                    },
                  ]}
                  onPress={() => toggleCategory(category.id)}
                >
                  <Text
                    style={[
                      styles.settingsCategoryChipText,
                      {
                        color: selectedCategories.includes(category.id)
                          ? colors.deepNavy
                          : colors.warmGray,
                      },
                    ]}
                  >
                    {category.name}
                  </Text>
                </TouchableOpacity>
              ))}
            </View>
          )}
        </View>

        <TouchableOpacity 
          style={[styles.settingsSaveButton, { backgroundColor: colors.beeYellow }, saving && styles.settingsSaveButtonDisabled]}
          onPress={saveInterests}
          disabled={saving}
        >
          {saving ? (
            <ActivityIndicator size="small" color="#1a1a2e" />
          ) : (
            <Text style={[styles.settingsSaveButtonText, { color: '#1a1a2e' }]}>Save Changes</Text>
          )}
        </TouchableOpacity>
      </View>
    </ScrollView>
  );
}

function SettingsSubscriptionContent({ userData, user, colors }: any) {
  const currentPlan = userData?.subscriptionPlan || 'Free';

  const plans = [
    {
      id: 'free',
      name: 'Free Plan',
      price: '$0/month',
      features: [
        'Browse all jobs',
        'Apply to unlimited jobs',
        'Save up to 10 jobs',
        'Basic job alerts',
      ],
    },
    {
      id: 'basic',
      name: 'Basic Plan',
      price: '$9.99/month',
      features: [
        'Everything in Free',
        'Unlimited saved jobs',
        'Priority job alerts',
        'Resume builder access',
        'Email support',
      ],
    },
    {
      id: 'premium',
      name: 'Premium Plan',
      price: '$19.99/month',
      features: [
        'Everything in Basic',
        'Featured profile',
        'Direct messaging with employers',
        'Advanced analytics',
        'Priority support',
      ],
    },
  ];

  const upgradePlan = (planId: string) => {
    Alert.alert(
      'Upgrade Plan',
      `Are you sure you want to upgrade to ${plans.find(p => p.id === planId)?.name}?`,
      [
        { text: 'Cancel', style: 'cancel' },
        {
          text: 'Upgrade',
          onPress: async () => {
            try {
              await updateDoc(doc(db, 'users', user.uid), {
                subscriptionPlan: planId,
              });
              Alert.alert('Success', 'Plan upgraded successfully!');
            } catch (error) {
              console.error('Error upgrading plan:', error);
              Alert.alert('Error', 'Failed to upgrade plan');
            }
          }
        },
      ]
    );
  };

  return (
    <ScrollView style={styles.settingsContentScroll}>
      <View style={styles.settingsContentSection}>
        <Text style={[styles.settingsContentTitle, { color: colors.deepNavy }]}>Subscription</Text>
        
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Current Plan</Text>
          <View style={[styles.settingsCurrentPlanCard, { backgroundColor: colors.white }]}>
            <Text style={[styles.settingsCurrentPlanName, { color: colors.deepNavy }]}>
              {plans.find(p => p.id === currentPlan.toLowerCase())?.name || 'Free Plan'}
            </Text>
            <Text style={[styles.settingsCurrentPlanPrice, { color: colors.beeYellow }]}>
              {plans.find(p => p.id === currentPlan.toLowerCase())?.price || '$0/month'}
            </Text>
          </View>

          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy, marginTop: 24 }]}>Available Plans</Text>
          {plans.map((plan) => (
            <View
              key={plan.id}
              style={[
                styles.settingsPlanCard,
                { backgroundColor: colors.white },
                currentPlan.toLowerCase() === plan.id && { borderColor: colors.beeYellow, borderWidth: 2 },
              ]}
            >
              <View style={styles.settingsPlanHeader}>
                <View>
                  <Text style={[styles.settingsPlanName, { color: colors.deepNavy }]}>
                    {plan.name}
                  </Text>
                  <Text style={[styles.settingsPlanPrice, { color: colors.beeYellow }]}>
                    {plan.price}
                  </Text>
                </View>
                {currentPlan.toLowerCase() === plan.id && (
                  <View style={[styles.settingsCurrentBadge, { backgroundColor: colors.beeYellow }]}>
                    <Text style={[styles.settingsCurrentBadgeText, { color: colors.deepNavy }]}>
                      Current
                    </Text>
                  </View>
                )}
              </View>
              <View style={styles.settingsPlanFeatures}>
                {plan.features.map((feature, index) => (
                  <View key={index} style={styles.settingsPlanFeature}>
                    <Icon name="check-circle" size={16} color={colors.success} />
                    <Text style={[styles.settingsPlanFeatureText, { color: colors.deepNavy }]}>
                      {feature}
                    </Text>
                  </View>
                ))}
              </View>
              {currentPlan.toLowerCase() !== plan.id && plan.id !== 'free' && (
                <TouchableOpacity
                  style={[styles.settingsUpgradeButton, { backgroundColor: colors.beeYellow }]}
                  onPress={() => upgradePlan(plan.id)}
                >
                  <Text style={[styles.settingsUpgradeButtonText, { color: colors.deepNavy }]}>
                    Upgrade
                  </Text>
                </TouchableOpacity>
              )}
            </View>
          ))}
        </View>
      </View>
    </ScrollView>
  );
}

// Settings Profile Sub-Screen (kept for backward compatibility with navigation)
function SettingsProfileScreen({ navigation, route, isDarkMode }: any) {
  const { userData, user } = route.params;
  const [displayName, setDisplayName] = useState(userData?.displayName || '');
  const [dateOfBirth, setDateOfBirth] = useState(userData?.dateOfBirth || '');
  const [bio, setBio] = useState(userData?.bio || '');
  const [profilePicture, setProfilePicture] = useState(userData?.profilePicture || '');
  const [saving, setSaving] = useState(false);
  const [uploading, setUploading] = useState(false);
  
  const colors = isDarkMode ? darkColors : lightColors;

  const pickImage = async () => {
    try {
      // Request permission
      const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();
      
      if (status !== 'granted') {
        Alert.alert('Permission Required', 'Sorry, we need camera roll permissions to upload photos.');
        return;
      }

      // Launch image picker
      const result = await ImagePicker.launchImageLibraryAsync({
        mediaTypes: ImagePicker.MediaTypeOptions.Images,
        allowsEditing: true,
        aspect: [1, 1],
        quality: 0.8,
      });

      if (!result.canceled && result.assets[0]) {
        setUploading(true);
        await uploadImage(result.assets[0].uri);
      }
    } catch (error) {
      console.error('Error picking image:', error);
      Alert.alert('Error', 'Failed to pick image');
    } finally {
      setUploading(false);
    }
  };

  const uploadImage = async (uri: string) => {
    if (!user) return;

    try {
      // Fetch the image
      const response = await fetch(uri);
      const blob = await response.blob();

      // Create a reference to Firebase Storage
      const filename = `profile_pictures/${user.uid}_${Date.now()}.jpg`;
      const storageRef = ref(storage, filename);

      // Upload the image
      await uploadBytes(storageRef, blob);

      // Get the download URL
      const downloadURL = await getDownloadURL(storageRef);
      
      // Update the profile picture state
      setProfilePicture(downloadURL);
      
      // Save to Firestore immediately
      await updateDoc(doc(db, 'users', user.uid), {
        profilePicture: downloadURL,
      });
      
      Alert.alert('Success', 'Photo uploaded successfully!');
    } catch (error) {
      console.error('Error uploading image:', error);
      Alert.alert('Error', 'Failed to upload photo');
    }
  };

  const saveProfile = async () => {
    if (!user) return;

    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        displayName,
        dateOfBirth,
        bio,
        profilePicture,
      });
      Alert.alert('Success', 'Profile updated successfully!');
      navigation.goBack();
    } catch (error) {
      console.error('Error updating profile:', error);
      Alert.alert('Error', 'Failed to update profile');
    } finally {
      setSaving(false);
    }
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      <View style={[styles.settingsHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <TouchableOpacity style={styles.settingsBackButton} onPress={() => navigation.goBack()}>
          <Icon name="arrow-back" size={24} color={colors.deepNavy} />
        </TouchableOpacity>
        <Text style={[styles.settingsTitle, { color: colors.deepNavy }]}>Profile</Text>
      </View>

      <ScrollView style={[styles.settingsContainer, { backgroundColor: colors.cream }]}>
        <View style={styles.settingsSection}>
          {/* Profile Picture */}
          <View style={[styles.settingsInputGroup, { backgroundColor: colors.white }]}>
            <Text style={[styles.settingsInputLabel, { color: colors.deepNavy }]}>Profile Picture</Text>
            <View style={styles.profilePictureContainer}>
              {profilePicture ? (
                <Image source={{ uri: profilePicture }} style={styles.profilePicturePreview} />
              ) : (
                <View style={[styles.profilePicturePlaceholder, { backgroundColor: colors.beeYellow }]}>
                  <Icon name="person" size={64} color="#1a1a2e" />
                </View>
              )}
              
              <TouchableOpacity 
                style={[styles.uploadPhotoButton, { backgroundColor: colors.beeYellow }]}
                onPress={pickImage}
                disabled={uploading}
              >
                <Icon name="cloud-upload" size={20} color="#1a1a2e" />
                <Text style={[styles.uploadPhotoButtonText, { color: '#1a1a2e' }]}>
                  {uploading ? 'Uploading...' : 'Upload Photo'}
                </Text>
              </TouchableOpacity>
            </View>
          </View>

          {/* Display Name */}
          <View style={[styles.settingsInputGroup, { backgroundColor: colors.white }]}>
            <Text style={[styles.settingsInputLabel, { color: colors.deepNavy }]}>Display Name</Text>
            <TextInput
              style={[styles.settingsTextInput, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="Enter your display name"
              placeholderTextColor={colors.warmGray}
              value={displayName}
              onChangeText={setDisplayName}
            />
          </View>

          {/* Bio */}
          <View style={[styles.settingsInputGroup, { backgroundColor: colors.white }]}>
            <Text style={[styles.settingsInputLabel, { color: colors.deepNavy }]}>Bio</Text>
            <TextInput
              style={[styles.settingsTextInput, styles.settingsTextAreaInput, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="Tell us about yourself..."
              placeholderTextColor={colors.warmGray}
              value={bio}
              onChangeText={setBio}
              multiline
              numberOfLines={4}
              textAlignVertical="top"
            />
          </View>

          {/* Date of Birth */}
          <View style={[styles.settingsInputGroup, { backgroundColor: colors.white }]}>
            <Text style={[styles.settingsInputLabel, { color: colors.deepNavy }]}>Date of Birth</Text>
            <TextInput
              style={[styles.settingsTextInput, { backgroundColor: colors.cream, color: colors.deepNavy }]}
              placeholder="YYYY-MM-DD"
              placeholderTextColor={colors.warmGray}
              value={dateOfBirth}
              onChangeText={setDateOfBirth}
            />
            <Text style={[styles.settingsInputHint, { color: colors.warmGray }]}>
              Format: YYYY-MM-DD (e.g., 1990-01-15)
            </Text>
          </View>

          {/* Email (Read-only) */}
          <View style={[styles.settingsInputGroup, { backgroundColor: colors.white }]}>
            <Text style={[styles.settingsInputLabel, { color: colors.deepNavy }]}>Email</Text>
            <TextInput
              style={[styles.settingsTextInput, styles.settingsTextInputDisabled, { backgroundColor: colors.lightGray, color: colors.warmGray }]}
              value={user?.email}
              editable={false}
            />
          </View>
        </View>

        {/* Save Button */}
        <TouchableOpacity 
          style={[styles.settingsSaveButton, { backgroundColor: colors.beeYellow }, saving && styles.settingsSaveButtonDisabled]}
          onPress={saveProfile}
          disabled={saving}
        >
          {saving ? (
            <ActivityIndicator size="small" color="#1a1a2e" />
          ) : (
            <Text style={[styles.settingsSaveButtonText, { color: '#1a1a2e' }]}>Save Changes</Text>
          )}
        </TouchableOpacity>
      </ScrollView>
    </SafeAreaView>
  );
}

// Settings Appearance Sub-Screen
function SettingsAppearanceScreen({ navigation, isDarkMode, toggleTheme }: any) {
  const colors = isDarkMode ? darkColors : lightColors;

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      <View style={[styles.settingsHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <TouchableOpacity style={styles.settingsBackButton} onPress={() => navigation.goBack()}>
          <Icon name="arrow-back" size={24} color={colors.deepNavy} />
        </TouchableOpacity>
        <Text style={[styles.settingsTitle, { color: colors.deepNavy }]}>Appearance</Text>
      </View>

      <ScrollView style={[styles.settingsContainer, { backgroundColor: colors.cream }]}>
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Theme</Text>
          
          {/* Theme Toggle */}
          <TouchableOpacity
            style={[styles.settingsToggleItem, { backgroundColor: colors.white }]}
            onPress={toggleTheme}
          >
            <View style={styles.settingsToggleLeft}>
              <View style={[styles.settingsMenuIconContainer, { backgroundColor: colors.cream }]}>
                <Icon name={isDarkMode ? 'dark-mode' : 'light-mode'} size={24} color={colors.beeYellow} />
              </View>
              <View>
                <Text style={[styles.settingsToggleTitle, { color: colors.deepNavy }]}>
                  Dark Mode
                </Text>
                <Text style={[styles.settingsToggleSubtitle, { color: colors.warmGray }]}>
                  {isDarkMode ? 'Enabled' : 'Disabled'}
                </Text>
              </View>
            </View>
            <View style={[styles.toggleSwitch, isDarkMode && styles.toggleSwitchActive]}>
              <View style={[styles.toggleKnob, isDarkMode && styles.toggleKnobActive]} />
            </View>
          </TouchableOpacity>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Notifications Settings Content
function SettingsNotificationsContent({ userData, user, colors }: any) {
  const [emailNotifications, setEmailNotifications] = useState(userData?.emailNotifications ?? true);
  const [pushNotifications, setPushNotifications] = useState(userData?.pushNotifications ?? true);
  const [jobAlerts, setJobAlerts] = useState(userData?.jobAlerts ?? true);
  const [applicationUpdates, setApplicationUpdates] = useState(userData?.applicationUpdates ?? true);
  const [saving, setSaving] = useState(false);

  const saveNotificationSettings = async () => {
    if (!user) return;
    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        emailNotifications,
        pushNotifications,
        jobAlerts,
        applicationUpdates,
      });
      Alert.alert('Success', 'Notification settings saved!');
    } catch (error) {
      console.error('Error saving settings:', error);
      Alert.alert('Error', 'Failed to save settings');
    } finally {
      setSaving(false);
    }
  };

  return (
    <View style={{ padding: 20 }}>
      <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy, fontSize: 20, marginBottom: 20 }]}>
        Notification Preferences
      </Text>
      
      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 16 }]}>
        <View style={styles.modernToggleRow}>
          <View style={styles.modernToggleLeft}>
            <Icon name="email" size={24} color={colors.beeYellow} />
            <View style={{ marginLeft: 12 }}>
              <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>Email Notifications</Text>
              <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                Receive updates via email
              </Text>
            </View>
          </View>
          <Switch
            value={emailNotifications}
            onValueChange={setEmailNotifications}
            trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
            thumbColor={colors.white}
          />
        </View>
      </View>

      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 16 }]}>
        <View style={styles.modernToggleRow}>
          <View style={styles.modernToggleLeft}>
            <Icon name="notifications-active" size={24} color={colors.beeYellow} />
            <View style={{ marginLeft: 12 }}>
              <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>Push Notifications</Text>
              <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                Get instant alerts
              </Text>
            </View>
          </View>
          <Switch
            value={pushNotifications}
            onValueChange={setPushNotifications}
            trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
            thumbColor={colors.white}
          />
        </View>
      </View>

      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 16 }]}>
        <View style={styles.modernToggleRow}>
          <View style={styles.modernToggleLeft}>
            <Icon name="work-outline" size={24} color={colors.beeYellow} />
            <View style={{ marginLeft: 12 }}>
              <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>Job Alerts</Text>
              <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                New jobs matching your interests
              </Text>
            </View>
          </View>
          <Switch
            value={jobAlerts}
            onValueChange={setJobAlerts}
            trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
            thumbColor={colors.white}
          />
        </View>
      </View>

      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 24 }]}>
        <View style={styles.modernToggleRow}>
          <View style={styles.modernToggleLeft}>
            <Icon name="update" size={24} color={colors.beeYellow} />
            <View style={{ marginLeft: 12 }}>
              <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>Application Updates</Text>
              <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                Status changes on your applications
              </Text>
            </View>
          </View>
          <Switch
            value={applicationUpdates}
            onValueChange={setApplicationUpdates}
            trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
            thumbColor={colors.white}
          />
        </View>
      </View>

      <TouchableOpacity 
        style={[styles.modernSaveButton, { backgroundColor: colors.beeYellow }]}
        onPress={saveNotificationSettings}
        disabled={saving}
      >
        {saving ? (
          <ActivityIndicator size="small" color={colors.deepNavy} />
        ) : (
          <>
            <Icon name="check" size={20} color={colors.deepNavy} />
            <Text style={[styles.modernSaveButtonText, { color: colors.deepNavy }]}>Save Changes</Text>
          </>
        )}
      </TouchableOpacity>
    </View>
  );
}

// Privacy Settings Content
function SettingsPrivacyContent({ userData, user, colors }: any) {
  const [profileVisibility, setProfileVisibility] = useState(userData?.profileVisibility ?? 'public');
  const [showEmail, setShowEmail] = useState(userData?.showEmail ?? false);
  const [allowMessaging, setAllowMessaging] = useState(userData?.allowMessaging ?? true);
  const [saving, setSaving] = useState(false);

  const savePrivacySettings = async () => {
    if (!user) return;
    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        profileVisibility,
        showEmail,
        allowMessaging,
      });
      Alert.alert('Success', 'Privacy settings saved!');
    } catch (error) {
      console.error('Error saving settings:', error);
      Alert.alert('Error', 'Failed to save settings');
    } finally {
      setSaving(false);
    }
  };

  return (
    <View style={{ padding: 20 }}>
      <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy, fontSize: 20, marginBottom: 20 }]}>
        Privacy & Security
      </Text>
      
      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 16 }]}>
        <Text style={[styles.modernInputLabel, { color: colors.deepNavy, marginBottom: 12 }]}>Profile Visibility</Text>
        {['public', 'private', 'connections-only'].map((option) => (
          <TouchableOpacity
            key={option}
            style={[
              styles.modernToggleRow,
              { paddingVertical: 12 },
              profileVisibility === option && { backgroundColor: colors.cream }
            ]}
            onPress={() => setProfileVisibility(option)}
          >
            <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>
              {option === 'public' ? 'Public' : option === 'private' ? 'Private' : 'Connections Only'}
            </Text>
            {profileVisibility === option && (
              <Icon name="check-circle" size={24} color={colors.beeYellow} />
            )}
          </TouchableOpacity>
        ))}
      </View>

      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 16 }]}>
        <View style={styles.modernToggleRow}>
          <View style={styles.modernToggleLeft}>
            <Icon name="email" size={24} color={colors.beeYellow} />
            <View style={{ marginLeft: 12 }}>
              <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>Show Email</Text>
              <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                Display email on public profile
              </Text>
            </View>
          </View>
          <Switch
            value={showEmail}
            onValueChange={setShowEmail}
            trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
            thumbColor={colors.white}
          />
        </View>
      </View>

      <View style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 24 }]}>
        <View style={styles.modernToggleRow}>
          <View style={styles.modernToggleLeft}>
            <Icon name="message" size={24} color={colors.beeYellow} />
            <View style={{ marginLeft: 12 }}>
              <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>Allow Messaging</Text>
              <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>
                Recruiters can send messages
              </Text>
            </View>
          </View>
          <Switch
            value={allowMessaging}
            onValueChange={setAllowMessaging}
            trackColor={{ false: colors.lightGray, true: colors.beeYellow }}
            thumbColor={colors.white}
          />
        </View>
      </View>

      <TouchableOpacity 
        style={[styles.modernSaveButton, { backgroundColor: colors.beeYellow }]}
        onPress={savePrivacySettings}
        disabled={saving}
      >
        {saving ? (
          <ActivityIndicator size="small" color={colors.deepNavy} />
        ) : (
          <>
            <Icon name="check" size={20} color={colors.deepNavy} />
            <Text style={[styles.modernSaveButtonText, { color: colors.deepNavy }]}>Save Changes</Text>
          </>
        )}
      </TouchableOpacity>
    </View>
  );
}

// Help & Support Content
function SettingsHelpContent({ colors }: any) {
  const helpItems = [
    { icon: 'help-outline', title: 'FAQs', subtitle: 'Common questions answered' },
    { icon: 'contact-support', title: 'Contact Support', subtitle: 'Get help from our team' },
    { icon: 'feedback', title: 'Send Feedback', subtitle: 'Help us improve' },
    { icon: 'policy', title: 'Privacy Policy', subtitle: 'How we protect your data' },
    { icon: 'description', title: 'Terms of Service', subtitle: 'Our usage terms' },
  ];

  return (
    <View style={{ padding: 20 }}>
      <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy, fontSize: 20, marginBottom: 20 }]}>
        Help & Support
      </Text>
      
      {helpItems.map((item, index) => (
        <TouchableOpacity
          key={index}
          style={[styles.modernInputCard, { backgroundColor: colors.white, marginBottom: 12, flexDirection: 'row', alignItems: 'center' }]}
        >
          <View style={[styles.modernIconCircle, { backgroundColor: colors.cream }]}>
            <Icon name={item.icon} size={24} color={colors.beeYellow} />
          </View>
          <View style={{ flex: 1, marginLeft: 12 }}>
            <Text style={[styles.modernToggleTitle, { color: colors.deepNavy }]}>{item.title}</Text>
            <Text style={[styles.modernToggleSubtitle, { color: colors.warmGray }]}>{item.subtitle}</Text>
          </View>
          <Icon name="chevron-right" size={24} color={colors.warmGray} />
        </TouchableOpacity>
      ))}

      <View style={{ marginTop: 20, padding: 16, backgroundColor: colors.cream, borderRadius: 12 }}>
        <Text style={{ fontSize: 14, color: colors.deepNavy, textAlign: 'center', marginBottom: 8 }}>
          Need immediate help?
        </Text>
        <Text style={{ fontSize: 12, color: colors.warmGray, textAlign: 'center' }}>
          Email us at support@nibjobs.com
        </Text>
      </View>
    </View>
  );
}

// Settings Language Sub-Screen
function SettingsLanguageScreen({ navigation, route, isDarkMode }: any) {
  const { userData, user } = route.params;
  const [selectedLanguage, setSelectedLanguage] = useState(userData?.language || 'English');
  const [saving, setSaving] = useState(false);
  
  const colors = isDarkMode ? darkColors : lightColors;
  const languages = ['English', 'Amharic', 'Oromifa'];

  const saveLanguage = async () => {
    if (!user) return;

    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        language: selectedLanguage,
      });
      Alert.alert('Success', 'Language preference saved!');
      navigation.goBack();
    } catch (error) {
      console.error('Error saving language:', error);
      Alert.alert('Error', 'Failed to save language preference');
    } finally {
      setSaving(false);
    }
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      <View style={[styles.settingsHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <TouchableOpacity style={styles.settingsBackButton} onPress={() => navigation.goBack()}>
          <Icon name="arrow-back" size={24} color={colors.deepNavy} />
        </TouchableOpacity>
        <Text style={[styles.settingsTitle, { color: colors.deepNavy }]}>Language</Text>
      </View>

      <ScrollView style={[styles.settingsContainer, { backgroundColor: colors.cream }]}>
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Select Language</Text>
          
          {languages.map((lang) => (
            <TouchableOpacity
              key={lang}
              style={[
                styles.settingsSelectionItem,
                { backgroundColor: colors.white },
                selectedLanguage === lang && { borderColor: colors.beeYellow, borderWidth: 2 }
              ]}
              onPress={() => setSelectedLanguage(lang)}
            >
              <View style={styles.settingsSelectionLeft}>
                <Icon name="language" size={24} color={selectedLanguage === lang ? colors.beeYellow : colors.warmGray} />
                <Text style={[
                  styles.settingsSelectionText,
                  { color: colors.deepNavy },
                  selectedLanguage === lang && { fontWeight: '600' }
                ]}>
                  {lang}
                </Text>
              </View>
              {selectedLanguage === lang && (
                <Icon name="check-circle" size={24} color={colors.beeYellow} />
              )}
            </TouchableOpacity>
          ))}
        </View>

        {/* Save Button */}
        <TouchableOpacity 
          style={[styles.settingsSaveButton, { backgroundColor: colors.beeYellow }, saving && styles.settingsSaveButtonDisabled]}
          onPress={saveLanguage}
          disabled={saving}
        >
          {saving ? (
            <ActivityIndicator size="small" color={colors.deepNavy} />
          ) : (
            <Text style={[styles.settingsSaveButtonText, { color: colors.deepNavy }]}>Save Language</Text>
          )}
        </TouchableOpacity>
      </ScrollView>
    </SafeAreaView>
  );
}

// Settings Interests Sub-Screen
function SettingsInterestsScreen({ navigation, route, isDarkMode }: any) {
  const { userData, user } = route.params;
  const [categories, setCategories] = useState<any[]>([]);
  const [selectedCategories, setSelectedCategories] = useState<string[]>(userData?.interestedCategories || []);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  
  const colors = isDarkMode ? darkColors : lightColors;

  useEffect(() => {
    fetchCategories();
  }, []);

  const fetchCategories = async () => {
    try {
      setLoading(true);
      const categoriesCollection = collection(db, 'categories');
      const categoriesSnapshot = await getDocs(categoriesCollection);
      const categoriesData = categoriesSnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      setCategories(categoriesData);
    } catch (error) {
      console.error('Error fetching categories:', error);
      Alert.alert('Error', 'Failed to load categories');
    } finally {
      setLoading(false);
    }
  };

  const toggleCategory = (categoryName: string) => {
    if (selectedCategories.includes(categoryName)) {
      setSelectedCategories(selectedCategories.filter(c => c !== categoryName));
    } else {
      setSelectedCategories([...selectedCategories, categoryName]);
    }
  };

  const saveInterests = async () => {
    if (!user) return;

    try {
      setSaving(true);
      await updateDoc(doc(db, 'users', user.uid), {
        interestedCategories: selectedCategories
      });
      Alert.alert('Success', 'Your job interests have been saved!');
      navigation.goBack();
    } catch (error) {
      console.error('Error saving interests:', error);
      Alert.alert('Error', 'Failed to save interests');
    } finally {
      setSaving(false);
    }
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      <View style={[styles.settingsHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <TouchableOpacity style={styles.settingsBackButton} onPress={() => navigation.goBack()}>
          <Icon name="arrow-back" size={24} color={colors.deepNavy} />
        </TouchableOpacity>
        <Text style={[styles.settingsTitle, { color: colors.deepNavy }]}>Job Interests</Text>
      </View>

      <ScrollView style={[styles.settingsContainer, { backgroundColor: colors.cream }]}>
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Interested Job Categories</Text>
          <Text style={[styles.settingsSectionSubtitle, { color: colors.warmGray }]}>
            Select categories to personalize your job recommendations
          </Text>
          
          {loading ? (
            <View style={styles.settingsLoadingContainer}>
              <ActivityIndicator size="large" color={colors.beeYellow} />
            </View>
          ) : (
            <View style={styles.categoriesGrid}>
              {categories.map((category) => (
                <TouchableOpacity
                  key={category.id}
                  style={[
                    styles.categoryCard,
                    { backgroundColor: colors.white, borderColor: colors.lightGray },
                    selectedCategories.includes(category.name) && { 
                      borderColor: colors.beeYellow,
                      backgroundColor: colors.cream 
                    }
                  ]}
                  onPress={() => toggleCategory(category.name)}
                >
                  <View style={styles.categoryCardContent}>
                    <Text style={[
                      styles.categoryCardText,
                      { color: colors.deepNavy },
                      selectedCategories.includes(category.name) && { fontWeight: '600' }
                    ]}>
                      {category.name}
                    </Text>
                    {selectedCategories.includes(category.name) && (
                      <Icon name="check-circle" size={20} color={colors.beeYellow} />
                    )}
                  </View>
                </TouchableOpacity>
              ))}
            </View>
          )}
        </View>

        {/* Save Button */}
        <TouchableOpacity 
          style={[styles.settingsSaveButton, { backgroundColor: colors.beeYellow }, saving && styles.settingsSaveButtonDisabled]}
          onPress={saveInterests}
          disabled={saving}
        >
          {saving ? (
            <ActivityIndicator size="small" color={colors.deepNavy} />
          ) : (
            <Text style={[styles.settingsSaveButtonText, { color: colors.deepNavy }]}>Save Interests</Text>
          )}
        </TouchableOpacity>
      </ScrollView>
    </SafeAreaView>
  );
}

// Settings Subscription Sub-Screen
function SettingsSubscriptionScreen({ navigation, route, isDarkMode }: any) {
  const { userData, user } = route.params;
  const currentPlan = userData?.subscriptionPlan || 'Free';
  const colors = isDarkMode ? darkColors : lightColors;

  const plans = [
    {
      id: 'free',
      name: 'Free Plan',
      price: '$0/month',
      features: [
        'Browse all jobs',
        'Apply to unlimited jobs',
        'Save up to 10 jobs',
        'Basic job alerts',
      ],
    },
    {
      id: 'basic',
      name: 'Basic Plan',
      price: '$9.99/month',
      features: [
        'Everything in Free',
        'Unlimited saved jobs',
        'Priority job alerts',
        'Resume builder access',
        'Application tracking',
      ],
    },
    {
      id: 'premium',
      name: 'Premium Plan',
      price: '$19.99/month',
      features: [
        'Everything in Basic',
        'Featured applicant status',
        'Direct messaging with employers',
        'Advanced analytics',
        'Career coaching sessions',
        'Resume review service',
      ],
    },
  ];

  const handleUpgrade = (planId: string) => {
    Alert.alert(
      'Upgrade Plan',
      `Would you like to upgrade to ${plans.find(p => p.id === planId)?.name}?`,
      [
        { text: 'Cancel', style: 'cancel' },
        { 
          text: 'Upgrade', 
          onPress: async () => {
            try {
              await updateDoc(doc(db, 'users', user.uid), {
                subscriptionPlan: planId,
              });
              Alert.alert('Success', 'Plan upgraded successfully!');
              navigation.goBack();
            } catch (error) {
              console.error('Error upgrading plan:', error);
              Alert.alert('Error', 'Failed to upgrade plan');
            }
          }
        },
      ]
    );
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.cream }]}>
      <View style={[styles.settingsHeader, { backgroundColor: colors.white, borderBottomColor: colors.lightGray }]}>
        <TouchableOpacity style={styles.settingsBackButton} onPress={() => navigation.goBack()}>
          <Icon name="arrow-back" size={24} color={colors.deepNavy} />
        </TouchableOpacity>
        <Text style={[styles.settingsTitle, { color: colors.deepNavy }]}>Subscription</Text>
      </View>

      <ScrollView style={[styles.settingsContainer, { backgroundColor: colors.cream }]}>
        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Current Plan</Text>
          <View style={[styles.currentPlanCard, { backgroundColor: colors.beeYellow }]}>
            <Icon name="card-membership" size={32} color={colors.deepNavy} />
            <Text style={[styles.currentPlanName, { color: colors.deepNavy }]}>
              {plans.find(p => p.id === currentPlan.toLowerCase())?.name || 'Free Plan'}
            </Text>
          </View>
        </View>

        <View style={styles.settingsSection}>
          <Text style={[styles.settingsSectionTitle, { color: colors.deepNavy }]}>Available Plans</Text>
          
          {plans.map((plan) => (
            <View
              key={plan.id}
              style={[
                styles.planCard,
                { backgroundColor: colors.white },
                plan.id === currentPlan.toLowerCase() && { borderColor: colors.beeYellow, borderWidth: 2 }
              ]}
            >
              <View style={styles.planHeader}>
                <Text style={[styles.planName, { color: colors.deepNavy }]}>{plan.name}</Text>
                <Text style={[styles.planPrice, { color: colors.beeYellow }]}>{plan.price}</Text>
              </View>
              
              <View style={styles.planFeatures}>
                {plan.features.map((feature, index) => (
                  <View key={index} style={styles.planFeatureItem}>
                    <Icon name="check" size={16} color={colors.success} />
                    <Text style={[styles.planFeatureText, { color: colors.deepNavy }]}>{feature}</Text>
                  </View>
                ))}
              </View>

              {plan.id !== currentPlan.toLowerCase() && (
                <TouchableOpacity
                  style={[styles.planUpgradeButton, { backgroundColor: colors.beeYellow }]}
                  onPress={() => handleUpgrade(plan.id)}
                >
                  <Text style={[styles.planUpgradeButtonText, { color: colors.deepNavy }]}>
                    {plan.id === 'free' ? 'Downgrade' : 'Upgrade'}
                  </Text>
                </TouchableOpacity>
              )}
              
              {plan.id === currentPlan.toLowerCase() && (
                <View style={[styles.planCurrentBadge, { backgroundColor: colors.cream }]}>
                  <Text style={[styles.planCurrentBadgeText, { color: colors.beeYellow }]}>Current Plan</Text>
                </View>
              )}
            </View>
          ))}
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Admin Panel Screen with Sidebar
function AdminPanelScreen({ navigation, isDarkMode, toggleTheme, colors: themeColors }: any) {
  const [activeTab, setActiveTab] = useState('analytics');
  const [user, setUser] = useState<any>(null);
  const colors = themeColors || lightColors;

  // URL query-based routing for maintaining state on refresh
  useEffect(() => {
    if (typeof window !== 'undefined') {
      const urlParams = new URLSearchParams(window.location.search);
      const tabFromURL = urlParams.get('tab');
      if (tabFromURL && ['analytics', 'categories', 'jobs', 'telegram', 'users', 'subscriptions'].includes(tabFromURL)) {
        setActiveTab(tabFromURL);
      }
    }
  }, []);

  // Update URL when tab changes
  const handleTabChange = (tabId: string) => {
    setActiveTab(tabId);
    if (typeof window !== 'undefined') {
      const url = new URL(window.location.href);
      url.searchParams.set('tab', tabId);
      window.history.replaceState({}, '', url.toString());
    }
  };

  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, async (authUser) => {
      if (authUser) {
        const userDoc = await getDoc(doc(db, 'users', authUser.uid));
        if (userDoc.exists()) {
          setUser({ ...authUser, ...userDoc.data() });
        }
      }
    });
    return unsubscribe;
  }, []);

  const handleLogout = async () => {
    await signOut(auth);
    // Clear URL parameters when logging out
    if (typeof window !== 'undefined') {
      window.history.replaceState({}, document.title, '/');
    }
    navigation.replace('Home');
  };

  const sidebarItems = [
    { id: 'analytics', title: 'Analytics', icon: 'analytics' },
    { id: 'categories', title: 'Job Categories', icon: 'category' },
    { id: 'jobs', title: 'Jobs', icon: 'work' },
    { id: 'telegram', title: 'Telegram Channels', icon: 'chat' },
    { id: 'users', title: 'Users', icon: 'people' },
    { id: 'subscriptions', title: 'Subscriptions', icon: 'card-membership' }
  ];

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.white }]}>
      <View style={styles.adminContainer}>
        {/* Sidebar */}
        <View style={[styles.sidebar, { backgroundColor: colors.sidebarBg, borderRightColor: colors.sidebarBorder }]}>
          <View style={[styles.sidebarHeader, { borderBottomColor: colors.sidebarBorder }]}>
            <View style={styles.sidebarLogoContainer}>
              <View style={styles.logoIconContainer}>
                <Image source={require('./assets/favicon.png')} style={styles.sidebarLogoImage} />
              </View>
              <Text style={[styles.sidebarLogo, { color: colors.sidebarTextActive }]}>Admin Panel</Text>
            </View>
            <View style={styles.userContainer}>
              <View style={styles.userAvatar}>
                <Icon name="person" size={16} color={colors.sidebarAccent} />
              </View>
              <View style={{ flex: 1 }}>
                <Text style={[styles.sidebarUser, { color: colors.sidebarText }]}>
                  {user ? `${user.profile?.firstName || 'Admin'}` : 'Loading...'}
                </Text>
                {user && user.role && (
                  <Text style={[styles.sidebarUserRole, { color: colors.warmGray }]}>
                    {user.role.charAt(0).toUpperCase() + user.role.slice(1)}
                  </Text>
                )}
              </View>
            </View>
          </View>

          {sidebarItems.map((item) => (
            <TouchableOpacity
              key={item.id}
              style={[
                styles.sidebarItem,
                activeTab === item.id && { ...styles.sidebarItemActive, backgroundColor: colors.sidebarAccentLight }
              ]}
              onPress={() => handleTabChange(item.id)}
            >
              <View style={[
                styles.iconContainer,
                activeTab === item.id && styles.iconContainerActive
              ]}>
                <Icon 
                  name={item.icon} 
                  size={18} 
                  color={activeTab === item.id ? colors.sidebarAccent : colors.sidebarText} 
                />
              </View>
              <Text style={[
                styles.sidebarText,
                { color: colors.sidebarText },
                activeTab === item.id && { ...styles.sidebarTextActive, color: colors.sidebarTextActive }
              ]}>
                {item.title}
              </Text>
              {activeTab === item.id && <View style={styles.activeIndicator} />}
            </TouchableOpacity>
          ))}

          {/* Theme Switcher in Sidebar */}
          <TouchableOpacity
            onPress={toggleTheme}
            style={[
              styles.sidebarItem,
              { 
                marginTop: 'auto',
                borderTopWidth: 1,
                borderTopColor: colors.sidebarBorder,
                paddingTop: 16
              }
            ]}
          >
            <View style={styles.iconContainer}>
              <Icon 
                name={isDarkMode ? 'wb-sunny' : 'nights-stay'} 
                size={18} 
                color={isDarkMode ? '#FCD34D' : colors.sidebarText} 
              />
            </View>
            <Text style={[styles.sidebarText, { color: colors.sidebarText }]}>
              {isDarkMode ? 'Light Mode' : 'Dark Mode'}
            </Text>
          </TouchableOpacity>

          <TouchableOpacity style={styles.logoutButton} onPress={handleLogout}>
            <View style={styles.logoutIconContainer}>
              <Icon name="logout" size={18} color={colors.danger} />
            </View>
            <Text style={styles.logoutText}>Sign Out</Text>
          </TouchableOpacity>
        </View>

        {/* Main Content */}
        <View style={[styles.adminMainContent, { backgroundColor: colors.lightGray }]}>
          {activeTab === 'analytics' && <AnalyticsContent colors={colors} />}
          {activeTab === 'categories' && <CategoriesContent colors={colors} />}
          {activeTab === 'jobs' && <JobsContent colors={colors} />}
          {activeTab === 'telegram' && <TelegramChannelsScreen colors={colors} />}
          {activeTab === 'users' && <UsersContent colors={colors} />}
          {activeTab === 'subscriptions' && <SubscriptionsContent colors={colors} />}
        </View>
      </View>
    </SafeAreaView>
  );
}

// Categories Content
function CategoriesContent({ colors = lightColors }: { colors?: any }) {
  const [categories, setCategories] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [expandedCategories, setExpandedCategories] = useState<Set<string>>(new Set());

  const getIconFromEmoji = (emoji: string): string => {
    const emojiIconMap: { [key: string]: string } = {
      'ðŸ’»': 'computer',
      'ðŸ“¢': 'trending-up',
      'ðŸ’°': 'attach-money',
      'ðŸ¥': 'local-hospital',
      'ðŸŽ“': 'school',
      'ðŸŒ': 'public'
    };
    return emojiIconMap[emoji] || 'category';
  };

  const toggleCategory = (categoryId: string) => {
    setExpandedCategories(prev => {
      const newSet = new Set(prev);
      if (newSet.has(categoryId)) {
        newSet.delete(categoryId);
      } else {
        newSet.add(categoryId);
      }
      return newSet;
    });
  };

  const getSubcategories = (parentPath: string) => {
    return categories.filter(cat => cat.level === 1 && cat.parentPath === parentPath);
  };

  useEffect(() => {
    fetchCategories();
  }, []);

  const fetchCategories = async () => {
    try {
      setLoading(true);
      console.log('ðŸ” Fetching categories from Firebase...');
      
      // Use a simpler query first - just get all categories without ordering
      // Once the index is built, we can add back the orderBy clauses
      const categoriesQuery = collection(db, 'categories');
      
      console.log('ðŸ“¡ Executing query...');
      const categoriesSnapshot = await getDocs(categoriesQuery);
      
      console.log('ðŸ“Š Query results:', {
        empty: categoriesSnapshot.empty,
        size: categoriesSnapshot.size,
        docs: categoriesSnapshot.docs.length
      });
      
      const fetchedCategories = categoriesSnapshot.docs.map(doc => {
        const data = doc.data();
        console.log('ðŸ“ Category doc:', { id: doc.id, data });
        return {
          id: doc.id,
          ...data,
          icon: getIconFromEmoji(data.icon || 'ðŸ“')
        };
      });
      
      // Sort manually in the client for now
      fetchedCategories.sort((a: any, b: any) => {
        if (a.level !== b.level) {
          return (a.level || 0) - (b.level || 0); // Sort by level first
        }
        return (a.order || 0) - (b.order || 0); // Then by order
      });
      
      console.log('âœ… Fetched categories:', fetchedCategories);
      setCategories(fetchedCategories);
    } catch (error) {
      console.error('âŒ Error fetching categories:', error);
      const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';
      Alert.alert('Error', `Failed to load categories: ${errorMessage}`);
      // Fallback to empty array
      setCategories([]);
    } finally {
      setLoading(false);
    }
  };

  return (
    <View style={[styles.contentContainer, { backgroundColor: colors.lightGray }]}>
      <View style={styles.contentHeader}>
        <Icon name="category" size={24} color={colors.beeYellow} />
        <Text style={[styles.contentTitle, { color: colors.deepNavy }]}>Job Categories Management</Text>
      </View>

      {loading ? (
        <View style={[styles.loadingContainer, { backgroundColor: colors.white }]}>
          <ActivityIndicator size="large" color={colors.beeYellow} />
          <Text style={[styles.loadingText, { color: colors.warmGray }]}>Loading categories...</Text>
        </View>
      ) : (
        <View style={styles.listContainer}>
          {categories.length === 0 ? (
            <View style={[styles.emptyContainer, { backgroundColor: colors.white }]}>
              <Icon name="category" size={48} color={colors.warmGray} />
              <Text style={[styles.emptyText, { color: colors.deepNavy }]}>No categories found</Text>
              <Text style={[styles.emptySubtext, { color: colors.warmGray }]}>Categories will appear here once they are created</Text>
            </View>
          ) : (
            categories
              .filter(category => category.level === 0)
              .map((category) => {
                const subcategories = getSubcategories(category.path);
                const isExpanded = expandedCategories.has(category.id);
                const hasSubcategories = subcategories.length > 0;
                
                return (
                  <View key={category.id}>
                    <TouchableOpacity
                      onPress={() => hasSubcategories && toggleCategory(category.id)}
                      style={[
                        styles.listItem,
                        { backgroundColor: colors.white, borderColor: colors.lightGray }
                      ]}
                    >
                      <View style={styles.listIconContainer}>
                        <Icon name={category.icon} size={24} color={category.color || colors.beeYellow} />
                      </View>
                      <View style={styles.listInfo}>
                        <Text style={[styles.listTitle, { color: colors.deepNavy }]}>
                          {category.name}
                        </Text>
                        <Text style={[styles.listSubtitle, { color: colors.warmGray }]}>
                          {category.jobCount || 0} jobs â€¢ {category.path}
                          {hasSubcategories && ` â€¢ ${subcategories.length} subcategories`}
                        </Text>
                      </View>
                      {hasSubcategories && (
                        <Icon 
                          name={isExpanded ? 'keyboard-arrow-up' : 'keyboard-arrow-down'} 
                          size={24} 
                          color={colors.warmGray}
                          style={{ marginLeft: 8 }}
                        />
                      )}
                    </TouchableOpacity>
                    
                    {isExpanded && subcategories.map((subcategory) => (
                      <View 
                        key={subcategory.id} 
                        style={[
                          styles.listItem,
                          styles.subcategoryItem,
                          { backgroundColor: colors.white, borderColor: colors.lightGray }
                        ]}
                      >
                        <View style={styles.listIconContainer}>
                          <Icon name={subcategory.icon} size={20} color={subcategory.color || colors.warmGray} />
                        </View>
                        <View style={styles.listInfo}>
                          <Text style={[
                            styles.listTitle,
                            styles.subcategoryTitle,
                            { color: colors.deepNavy }
                          ]}>
                            {subcategory.name}
                          </Text>
                          <Text style={[styles.listSubtitle, { color: colors.warmGray }]}>
                            {subcategory.jobCount || 0} jobs â€¢ {subcategory.fullPath}
                          </Text>
                        </View>
                      </View>
                    ))}
                  </View>
                );
              })
          )}
        </View>
      )}
    </View>
  );
}

// Jobs Content
interface Job {
  id: string;
  title: string;
  company: string;
  category: string;
  contractType: string;
  location: string;
  salary?: string;
  jobSource: string;
  postedDate?: Date;
  createdAt?: Date;
  isRemote: boolean;
  tags: string[];
}

function JobsContent({ colors = lightColors }: { colors?: any }) {
  const [jobs, setJobs] = useState<Job[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [totalJobs, setTotalJobs] = useState(0);
  const [currentPage, setCurrentPage] = useState(1);
  const [lastDoc, setLastDoc] = useState<any>(null);
  const [firstDoc, setFirstDoc] = useState<any>(null);
  const [pageSnapshots, setPageSnapshots] = useState<Map<number, any>>(new Map());
  const jobsPerPage = 20;

  // Get total count of jobs
  const getTotalCount = async () => {
    try {
      const jobsRef = collection(db, 'jobs');
      const snapshot = await getDocs(jobsRef);
      setTotalJobs(snapshot.size);
    } catch (err) {
      console.error('Error getting total count:', err);
    }
  };

  const loadJobs = async (page: number = 1, direction: 'next' | 'prev' | 'first' = 'first') => {
    try {
      setLoading(true);
      console.log(`ðŸ“‹ Loading jobs from Firestore - Page ${page}`);
      
      const jobsRef = collection(db, 'jobs');
      let jobsQuery;

      if (direction === 'first' || page === 1) {
        // First page - no cursor
        jobsQuery = dbQuery(
          jobsRef,
          orderBy('createdAt', 'desc'),
          limit(jobsPerPage)
        );
      } else if (direction === 'next' && lastDoc) {
        // Next page - start after last document
        jobsQuery = dbQuery(
          jobsRef,
          orderBy('createdAt', 'desc'),
          startAfter(lastDoc),
          limit(jobsPerPage)
        );
      } else if (direction === 'prev' && pageSnapshots.has(page)) {
        // Previous page - use cached snapshot
        const cachedDoc = pageSnapshots.get(page);
        jobsQuery = dbQuery(
          jobsRef,
          orderBy('createdAt', 'desc'),
          startAfter(cachedDoc),
          limit(jobsPerPage)
        );
      } else {
        // Fallback to first page
        jobsQuery = dbQuery(
          jobsRef,
          orderBy('createdAt', 'desc'),
          limit(jobsPerPage)
        );
      }
      
      const querySnapshot = await getDocs(jobsQuery);
      
      if (querySnapshot.empty) {
        setJobs([]);
        setError('No jobs found');
        setLoading(false);
        return;
      }

      const jobsData: Job[] = [];
      
      querySnapshot.forEach((doc) => {
        const data = doc.data() as any;
        jobsData.push({
          id: doc.id,
          title: data.title || 'No title',
          company: data.company || 'Unknown company',
          category: data.category || 'Other',
          contractType: data.contractType || 'Full-time',
          location: data.location || 'Not specified',
          salary: data.salary,
          jobSource: data.jobSource || 'Unknown',
          postedDate: data.postedDate ? data.postedDate.toDate() : null,
          createdAt: data.createdAt ? data.createdAt.toDate() : null,
          isRemote: data.isRemote || false,
          tags: data.tags || []
        });
      });
      
      // Cache first document of current page for previous navigation
      const newPageSnapshots = new Map(pageSnapshots);
      if (querySnapshot.docs.length > 0) {
        newPageSnapshots.set(page, querySnapshot.docs[0]);
        setPageSnapshots(newPageSnapshots);
      }

      // Store last and first documents for pagination
      setLastDoc(querySnapshot.docs[querySnapshot.docs.length - 1]);
      setFirstDoc(querySnapshot.docs[0]);
      
      console.log(`âœ… Loaded ${jobsData.length} jobs from Firestore (Page ${page})`);
      setJobs(jobsData);
      setCurrentPage(page);
      setError(null);
      
    } catch (err) {
      console.error('âŒ Error loading jobs:', err);
      setError(err instanceof Error ? err.message : 'Failed to load jobs');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    getTotalCount();
    loadJobs(1, 'first');
  }, []);

  const goToNextPage = () => {
    if (jobs.length === jobsPerPage) {
      loadJobs(currentPage + 1, 'next');
    }
  };

  const goToPrevPage = () => {
    if (currentPage > 1) {
      loadJobs(currentPage - 1, 'prev');
    }
  };

  const totalPages = Math.ceil(totalJobs / jobsPerPage);
  const startIndex = (currentPage - 1) * jobsPerPage + 1;
  const endIndex = Math.min(currentPage * jobsPerPage, totalJobs);

  // Filter jobs based on search (client-side filter on current page only)
  const filteredJobs = jobs.filter(job => 
    searchQuery === '' ||
    job.title?.toLowerCase().includes(searchQuery.toLowerCase()) ||
    job.company?.toLowerCase().includes(searchQuery.toLowerCase()) ||
    job.category?.toLowerCase().includes(searchQuery.toLowerCase()) ||
    job.location?.toLowerCase().includes(searchQuery.toLowerCase())
  );

  const formatDate = (date: Date | null | undefined) => {
    if (!date) return 'N/A';
    return date.toLocaleDateString();
  };

  return (
    <View style={[styles.contentContainer, { backgroundColor: colors.lightGray }]}>
      {/* Header */}
      <View style={styles.usersHeader}>
        <Text style={[styles.contentTitle, { color: colors.deepNavy }]}>Jobs Management</Text>
        <View style={styles.usersStats}>
          <View style={[styles.statBadge, { backgroundColor: colors.cream, borderColor: colors.beeYellow }]}>
            <Text style={[styles.statBadgeLabel, { color: colors.warmGray }]}>Total Jobs</Text>
            <Text style={[styles.statBadgeValue, { color: colors.deepNavy }]}>{ totalJobs}</Text>
          </View>
          <TouchableOpacity 
            style={[styles.statBadge, { backgroundColor: colors.beeYellow }]}
            onPress={() => {
              getTotalCount();
              loadJobs(1, 'first');
            }}
          >
            <Icon name="refresh" size={20} color="#000000" />
            <Text style={[styles.statBadgeLabel, { color: '#000000' }]}>Refresh</Text>
          </TouchableOpacity>
        </View>
      </View>

      {/* Search Bar */}
      <View style={[styles.searchBarContainer, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
        <Icon name="search" size={20} color={colors.warmGray} />
        <TextInput
          style={[styles.searchInput, { color: colors.deepNavy }]}
          placeholder="Search jobs on current page..."
          placeholderTextColor={colors.warmGray}
          value={searchQuery}
          onChangeText={setSearchQuery}
        />
        {searchQuery.length > 0 && (
          <TouchableOpacity onPress={() => setSearchQuery('')}>
            <Icon name="close" size={20} color={colors.warmGray} />
          </TouchableOpacity>
        )}
      </View>

      {error && (
        <View style={{ padding: 15, backgroundColor: colors.danger, borderRadius: 8, marginBottom: 15 }}>
          <Text style={{ color: colors.white, fontWeight: 'bold' }}>âŒ Error</Text>
          <Text style={{ color: colors.white }}>{error}</Text>
        </View>
      )}

      {loading ? (
        <View style={[styles.loadingContainer, { backgroundColor: colors.white }]}>
          <ActivityIndicator size="large" color={colors.beeYellow} />
          <Text style={[styles.loadingText, { color: colors.warmGray }]}>Loading jobs...</Text>
        </View>
      ) : (
        <>
          {/* Jobs Table */}
          <View style={[styles.tableContainer, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
            <View style={[styles.tableHeader, { backgroundColor: colors.lightGray, borderBottomColor: colors.lightGray }]}>
              <Text style={[styles.tableHeaderCell, { flex: 2, color: colors.warmGray }]}>Title</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1.5, color: colors.warmGray }]}>Company</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Category</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Location</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Type</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Source</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Posted</Text>
            </View>

            <ScrollView style={styles.tableBody}>
              {filteredJobs.length === 0 ? (
                <View style={styles.emptyState}>
                  <Icon name="work-outline" size={48} color={colors.warmGray} />
                  <Text style={[styles.emptyStateText, { color: colors.warmGray }]}>
                    {searchQuery ? 'No jobs found matching your search' : 'No jobs available'}
                  </Text>
                </View>
              ) : (
                filteredJobs.map((job, index) => (
                  <View 
                    key={job.id} 
                    style={[
                      styles.tableRow,
                      { borderBottomColor: colors.lightGray },
                      index % 2 === 0 && { ...styles.tableRowEven, backgroundColor: colors.lightGray }
                    ]}
                  >
                    <Text style={[styles.tableCell, { flex: 2, color: colors.deepNavy }]} numberOfLines={2}>
                      {job.title}
                    </Text>
                    <Text style={[styles.tableCell, { flex: 1.5, color: colors.deepNavy }]} numberOfLines={1}>
                      {job.company}
                    </Text>
                    <Text style={[styles.tableCell, { flex: 1, color: colors.deepNavy }]} numberOfLines={1}>
                      {job.category}
                    </Text>
                    <View style={[styles.tableCell, { flex: 1 }]}>
                      <Text style={{ color: colors.deepNavy }} numberOfLines={1}>{job.location}</Text>
                      {job.isRemote && (
                        <View style={[styles.statusBadge, { marginTop: 4, backgroundColor: colors.cream }]}>
                          <Text style={[styles.statusBadgeText, { color: colors.deepNavy }]}>Remote</Text>
                        </View>
                      )}
                    </View>
                    <View style={[styles.tableCell, { flex: 1 }]}>
                      <View style={[styles.roleBadge, { backgroundColor: colors.lightGray }]}>
                        <Text style={[styles.roleBadgeText, { color: colors.deepNavy }]}>{job.contractType}</Text>
                      </View>
                    </View>
                    <Text style={[styles.tableCell, { flex: 1, color: colors.deepNavy }]} numberOfLines={1}>
                      {job.jobSource}
                    </Text>
                    <Text style={[styles.tableCell, { flex: 1, color: colors.deepNavy }]} numberOfLines={1}>
                      {formatDate(job.createdAt)}
                    </Text>
                  </View>
                ))
              )}
            </ScrollView>
          </View>

          {/* Pagination */}
          {totalPages > 1 && (
            <View style={[styles.paginationContainer, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
              <TouchableOpacity 
                style={[
                  styles.paginationButton,
                  { backgroundColor: colors.white, borderColor: colors.lightGray },
                  currentPage === 1 && styles.paginationButtonDisabled
                ]}
                onPress={goToPrevPage}
                disabled={currentPage === 1 || loading}
              >
                <Icon name="chevron-left" size={20} color={colors.deepNavy} />
              </TouchableOpacity>

              <View style={styles.paginationInfo}>
                <Text style={[styles.paginationText, { color: colors.deepNavy }]}>
                  Page {currentPage} of {totalPages}
                </Text>
                <Text style={[styles.paginationSubtext, { color: colors.warmGray }]}>
                  Showing {startIndex}-{endIndex} of {totalJobs} jobs
                </Text>
              </View>

              <TouchableOpacity 
                style={[
                  styles.paginationButton,
                  { backgroundColor: colors.white, borderColor: colors.lightGray },
                  (currentPage === totalPages || jobs.length < jobsPerPage) && styles.paginationButtonDisabled
                ]}
                onPress={goToNextPage}
                disabled={currentPage === totalPages || jobs.length < jobsPerPage || loading}
              >
                <Icon name="chevron-right" size={20} color={colors.deepNavy} />
              </TouchableOpacity>
            </View>
          )}
        </>
      )}
    </View>
  );
}

// Users Content
function UsersContent({ colors = lightColors }: { colors?: any }) {
  const [users, setUsers] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [currentPage, setCurrentPage] = useState(1);
  const [searchQuery, setSearchQuery] = useState('');
  const [updatingUserId, setUpdatingUserId] = useState<string | null>(null);
  const usersPerPage = 10;

  useEffect(() => {
    fetchUsers();
  }, []);

  const fetchUsers = async () => {
    try {
      setLoading(true);
      console.log('ðŸ” Fetching users from Firestore...');
      const usersRef = collection(db, 'users');
      
      // Try without ordering first to see if we get any users
      const querySnapshot = await getDocs(usersRef);
      
      console.log('ðŸ“Š Query snapshot size:', querySnapshot.size);
      
      const fetchedUsers: any[] = [];
      querySnapshot.forEach((doc) => {
        console.log('ðŸ‘¤ User found:', doc.id, doc.data());
        fetchedUsers.push({
          id: doc.id,
          ...doc.data()
        });
      });
      
      // Sort by createdAt if it exists, otherwise by email
      fetchedUsers.sort((a, b) => {
        if (a.createdAt && b.createdAt) {
          return b.createdAt.seconds - a.createdAt.seconds;
        }
        return (a.email || '').localeCompare(b.email || '');
      });
      
      console.log('âœ… Total users fetched:', fetchedUsers.length);
      setUsers(fetchedUsers);
    } catch (error) {
      console.error('âŒ Error fetching users:', error);
      alert('Error fetching users: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  const handleRoleChange = async (userId: string, newRole: string) => {
    try {
      setUpdatingUserId(userId);
      
      // Get current user data
      const currentUser = users.find(u => u.id === userId);
      if (!currentUser) return;
      
      const oldRole = currentUser.role || 'user';
      const userRef = doc(db, 'users', userId);
      
      await updateDoc(userRef, {
        role: newRole,
        updatedAt: new Date()
      });
      
      // Update local state
      setUsers(users.map(user => 
        user.id === userId ? { ...user, role: newRole } : user
      ));
      
      // Send email notification
      try {
        const notifyRoleChange = httpsCallable(functions, 'notifyRoleChange');
        await notifyRoleChange({
          userEmail: currentUser.email,
          userName: currentUser.displayName || currentUser.name || 'User',
          oldRole: oldRole,
          newRole: newRole
        });
        alert(`User role updated to ${newRole} successfully! Email notification sent.`);
      } catch (emailError) {
        console.error('Failed to send email notification:', emailError);
        alert(`User role updated to ${newRole} successfully! (Email notification failed)`);
      }
    } catch (error) {
      console.error('Error updating user role:', error);
      alert('Error updating user role: ' + (error as Error).message);
    } finally {
      setUpdatingUserId(null);
    }
  };

  const handleSubscriptionChange = async (userId: string, newSubscriptionId: string) => {
    try {
      setUpdatingUserId(userId);
      
      // Get current user data
      const currentUser = users.find(u => u.id === userId);
      if (!currentUser) return;
      
      const oldPlan = currentUser.subscriptionId || 'free';
      const userRef = doc(db, 'users', userId);
      
      // Determine subscription end date based on plan
      let subscriptionEndDate = null;
      if (newSubscriptionId !== 'free') {
        // Set end date to 1 year from now for paid plans
        subscriptionEndDate = new Date();
        subscriptionEndDate.setFullYear(subscriptionEndDate.getFullYear() + 1);
      }
      
      await updateDoc(userRef, {
        subscriptionId: newSubscriptionId,
        subscriptionStatus: 'active',
        subscriptionStartDate: new Date(),
        subscriptionEndDate: subscriptionEndDate,
        updatedAt: new Date()
      });
      
      // Update local state
      setUsers(users.map(user => 
        user.id === userId ? { 
          ...user, 
          subscriptionId: newSubscriptionId,
          subscriptionStatus: 'active',
          subscriptionStartDate: new Date(),
          subscriptionEndDate: subscriptionEndDate
        } : user
      ));
      
      // Send email notification
      try {
        const notifySubscriptionChange = httpsCallable(functions, 'notifySubscriptionChange');
        await notifySubscriptionChange({
          userEmail: currentUser.email,
          userName: currentUser.displayName || currentUser.name || 'User',
          oldPlan: oldPlan,
          newPlan: newSubscriptionId
        });
        alert(`User subscription updated to ${newSubscriptionId} successfully! Email notification sent.`);
      } catch (emailError) {
        console.error('Failed to send email notification:', emailError);
        alert(`User subscription updated to ${newSubscriptionId} successfully! (Email notification failed)`);
      }
    } catch (error) {
      console.error('Error updating user subscription:', error);
      alert('Error updating user subscription: ' + (error as Error).message);
    } finally {
      setUpdatingUserId(null);
    }
  };

  // Filter users based on search
  const filteredUsers = users.filter(user => 
    user.email?.toLowerCase().includes(searchQuery.toLowerCase()) ||
    user.displayName?.toLowerCase().includes(searchQuery.toLowerCase()) ||
    user.role?.toLowerCase().includes(searchQuery.toLowerCase())
  );

  // Pagination
  const totalPages = Math.ceil(filteredUsers.length / usersPerPage);
  const startIndex = (currentPage - 1) * usersPerPage;
  const endIndex = startIndex + usersPerPage;
  const currentUsers = filteredUsers.slice(startIndex, endIndex);

  const goToPage = (page: number) => {
    if (page >= 1 && page <= totalPages) {
      setCurrentPage(page);
    }
  };

  const formatDate = (timestamp: any) => {
    if (!timestamp) return 'N/A';
    try {
      return new Date(timestamp.seconds * 1000).toLocaleDateString();
    } catch {
      return 'N/A';
    }
  };

  return (
    <View style={[styles.contentContainer, { backgroundColor: colors.lightGray }]}>
      <View style={styles.usersHeader}>
        <Text style={[styles.contentTitle, { color: colors.deepNavy }]}>User Management</Text>
        <View style={styles.usersStats}>
          <View style={[styles.statBadge, { backgroundColor: colors.cream, borderColor: colors.beeYellow }]}>
            <Text style={[styles.statBadgeLabel, { color: colors.warmGray }]}>Total Users</Text>
            <Text style={[styles.statBadgeValue, { color: colors.deepNavy }]}>{users.length}</Text>
          </View>
          <View style={[styles.statBadge, { backgroundColor: colors.cream, borderColor: colors.beeYellow }]}>
            <Text style={[styles.statBadgeLabel, { color: colors.warmGray }]}>Active</Text>
            <Text style={[styles.statBadgeValue, { color: colors.deepNavy }]}>
              {users.filter(u => u.isActive !== false).length}
            </Text>
          </View>
        </View>
      </View>

      {/* Search Bar */}
      <View style={[styles.searchBarContainer, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
        <Icon name="search" size={20} color={colors.warmGray} />
        <TextInput
          style={[styles.searchInput, { color: colors.deepNavy }]}
          placeholder="Search by email, name, or role..."
          placeholderTextColor={colors.warmGray}
          value={searchQuery}
          onChangeText={setSearchQuery}
        />
        {searchQuery.length > 0 && (
          <TouchableOpacity onPress={() => setSearchQuery('')}>
            <Icon name="close" size={20} color={colors.warmGray} />
          </TouchableOpacity>
        )}
      </View>

      {loading ? (
        <View style={styles.loadingContainer}>
          <ActivityIndicator size="large" color={colors.beeYellow} />
          <Text style={[styles.loadingText, { color: colors.warmGray }]}>Loading users...</Text>
        </View>
      ) : (
        <>
          {/* Users Table */}
          <View style={[styles.tableContainer, { backgroundColor: colors.white, borderColor: colors.lightGray }]}>
            <View style={[styles.tableHeader, { backgroundColor: colors.lightGray, borderBottomColor: colors.lightGray }]}>
              <Text style={[styles.tableHeaderCell, { flex: 2, color: colors.warmGray }]}>Email</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1.5, color: colors.warmGray }]}>Display Name</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Role</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Subscription</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Status</Text>
              <Text style={[styles.tableHeaderCell, { flex: 1, color: colors.warmGray }]}>Created</Text>
              <Text style={[styles.tableHeaderCell, { flex: 2, color: colors.warmGray }]}>Actions</Text>
            </View>

            <ScrollView style={styles.tableBody}>
              {currentUsers.length === 0 ? (
                <View style={styles.emptyState}>
                  <Icon name="people-outline" size={48} color={colors.warmGray} />
                  <Text style={[styles.emptyStateText, { color: colors.warmGray }]}>
                    {searchQuery ? 'No users found matching your search' : 'No users yet'}
                  </Text>
                </View>
              ) : (
                currentUsers.map((user, index) => (
                  <View 
                    key={user.id} 
                    style={[
                      styles.tableRow,
                      { borderBottomColor: colors.lightGray },
                      index % 2 === 0 && { ...styles.tableRowEven, backgroundColor: colors.lightGray }
                    ]}
                  >
                    <Text style={[styles.tableCell, { flex: 2, color: colors.deepNavy }]} numberOfLines={1}>
                      {user.email || 'N/A'}
                    </Text>
                    <Text style={[styles.tableCell, { flex: 1.5, color: colors.deepNavy }]} numberOfLines={1}>
                      {user.displayName || user.name || 'N/A'}
                    </Text>
                    <View style={[styles.tableCell, { flex: 1 }]}>
                      <View style={[
                        styles.roleBadge,
                        { 
                          backgroundColor: user.role === 'admin' 
                            ? (colors.isDark ? '#3B2817' : '#FEF3C7')
                            : user.role === 'superadmin'
                            ? (colors.isDark ? '#3F1F1F' : '#FEE2E2')
                            : user.role === 'company'
                            ? (colors.isDark ? '#1E3A5F' : '#DBEAFE')
                            : colors.lightGray
                        }
                      ]}>
                        <Text style={[
                          styles.roleBadgeText, 
                          { 
                            color: user.role === 'admin' 
                              ? (colors.isDark ? '#FCD34D' : '#D97706')
                              : user.role === 'superadmin'
                              ? (colors.isDark ? '#FCA5A5' : '#DC2626')
                              : user.role === 'company'
                              ? (colors.isDark ? '#93C5FD' : '#2563EB')
                              : colors.deepNavy
                          }
                        ]}>
                          {user.role || 'user'}
                        </Text>
                      </View>
                    </View>
                    <View style={[styles.tableCell, { flex: 1 }]}>
                      <View style={[
                        styles.roleBadge,
                        { 
                          backgroundColor: user.subscriptionId === 'free' 
                            ? colors.lightGray
                            : user.subscriptionId === 'standard'
                            ? (colors.isDark ? '#3B2817' : '#FEF3C7')
                            : user.subscriptionId === 'enterprise'
                            ? (colors.isDark ? '#1E3A5F' : '#DBEAFE')
                            : colors.lightGray,
                          borderColor: user.subscriptionId === 'free' 
                            ? colors.warmGray
                            : user.subscriptionId === 'standard'
                            ? (colors.isDark ? '#F59E0B' : '#F59E0B')
                            : user.subscriptionId === 'enterprise'
                            ? (colors.isDark ? '#3B82F6' : '#3B82F6')
                            : colors.warmGray
                        }
                      ]}>
                        <Text style={[
                          styles.roleBadgeText,
                          { 
                            color: user.subscriptionId === 'free' 
                              ? colors.warmGray
                              : user.subscriptionId === 'standard'
                              ? (colors.isDark ? '#FCD34D' : '#D97706')
                              : user.subscriptionId === 'enterprise'
                              ? (colors.isDark ? '#93C5FD' : '#2563EB')
                              : colors.warmGray
                          }
                        ]}>
                          {user.subscriptionId || 'free'}
                        </Text>
                      </View>
                    </View>
                    <View style={[styles.tableCell, { flex: 1 }]}>
                      <View style={[
                        styles.statusBadge,
                        { 
                          backgroundColor: user.isActive === false 
                            ? (colors.isDark ? '#3F1F1F' : '#FEE2E2')
                            : (colors.isDark ? '#1F3F2F' : '#D1FAE5')
                        }
                      ]}>
                        <Text style={[
                          styles.statusBadgeText,
                          { 
                            color: user.isActive === false 
                              ? (colors.isDark ? '#FCA5A5' : '#DC2626')
                              : (colors.isDark ? '#86EFAC' : '#065F46')
                          }
                        ]}>
                          {user.isActive === false ? 'Inactive' : 'Active'}
                        </Text>
                      </View>
                    </View>
                    <Text style={[styles.tableCell, { flex: 1, color: colors.deepNavy }]} numberOfLines={1}>
                      {formatDate(user.createdAt)}
                    </Text>
                    <View style={[styles.tableCell, { flex: 2, flexDirection: 'row', alignItems: 'center', gap: 8 }]}>
                      {updatingUserId === user.id ? (
                        <ActivityIndicator size="small" color={colors.beeYellow} />
                      ) : (
                        <>
                          <View style={styles.roleSelectContainer}>
                            <select
                              value={user.role || 'user'}
                              onChange={(e) => handleRoleChange(user.id, e.target.value)}
                              style={{
                                padding: '6px 10px',
                                borderRadius: '6px',
                                border: `1px solid ${colors.lightGray}`,
                                backgroundColor: colors.white,
                                color: colors.deepNavy,
                                fontSize: '13px',
                                cursor: 'pointer',
                                outline: 'none',
                                width: '110px'
                              }}
                            >
                              <option value="user">User</option>
                              <option value="company">Company</option>
                              <option value="admin">Admin</option>
                              <option value="superadmin">Super Admin</option>
                            </select>
                          </View>
                          <View style={styles.roleSelectContainer}>
                            <select
                              value={user.subscriptionId || 'free'}
                              onChange={(e) => handleSubscriptionChange(user.id, e.target.value)}
                              style={{
                                padding: '6px 10px',
                                borderRadius: '6px',
                                border: `1px solid ${colors.lightGray}`,
                                backgroundColor: colors.white,
                                color: colors.deepNavy,
                                fontSize: '13px',
                                cursor: 'pointer',
                                outline: 'none',
                                width: '110px'
                              }}
                            >
                              <option value="free">Free</option>
                              <option value="standard">Standard</option>
                              <option value="enterprise">Enterprise</option>
                            </select>
                          </View>
                        </>
                      )}
                    </View>
                  </View>
                ))
              )}
            </ScrollView>
          </View>

          {/* Pagination */}
          {totalPages > 1 && (
            <View style={styles.paginationContainer}>
              <TouchableOpacity 
                style={[
                  styles.paginationButton,
                  currentPage === 1 && styles.paginationButtonDisabled
                ]}
                onPress={() => goToPage(currentPage - 1)}
                disabled={currentPage === 1}
              >
                <Icon name="chevron-left" size={20} color={lightColors.deepNavy} />
              </TouchableOpacity>

              <View style={styles.paginationInfo}>
                <Text style={styles.paginationText}>
                  Page {currentPage} of {totalPages}
                </Text>
                <Text style={styles.paginationSubtext}>
                  Showing {startIndex + 1}-{Math.min(endIndex, filteredUsers.length)} of {filteredUsers.length}
                </Text>
              </View>

              <TouchableOpacity 
                style={[
                  styles.paginationButton,
                  currentPage === totalPages && styles.paginationButtonDisabled
                ]}
                onPress={() => goToPage(currentPage + 1)}
                disabled={currentPage === totalPages}
              >
                <Icon name="chevron-right" size={20} color={lightColors.deepNavy} />
              </TouchableOpacity>
            </View>
          )}
        </>
      )}
    </View>
  );
}

// Subscriptions Content
function SubscriptionsContent({ colors = lightColors }: { colors?: any }) {
  const [editingPlan, setEditingPlan] = useState<string | null>(null);
  const [billingPeriod, setBillingPeriod] = useState<'monthly' | 'yearly'>('monthly');
  const [saving, setSaving] = useState(false);
  const [plans, setPlans] = useState(
    SUBSCRIPTION_PLANS.map(plan => ({
      ...plan,
      priceMonthly: plan.priceMonthly,
      priceYearly: plan.priceYearly,
      features: plan.features.map(f => ({ name: f.text, enabled: f.enabled }))
    }))
  );

  const handlePriceChange = (planId: string, field: 'priceMonthly' | 'priceYearly', value: string) => {
    setPlans(plans.map(plan => 
      plan.id === planId 
        ? { ...plan, [field]: parseFloat(value) || 0 }
        : plan
    ));
  };

  const toggleFeature = (planId: string, featureIndex: number) => {
    setPlans(plans.map(plan => {
      if (plan.id === planId) {
        const newFeatures = [...plan.features];
        newFeatures[featureIndex] = {
          ...newFeatures[featureIndex],
          enabled: !newFeatures[featureIndex].enabled
        };
        return { ...plan, features: newFeatures };
      }
      return plan;
    }));
  };

  const toggleAds = (planId: string) => {
    setPlans(plans.map(plan => 
      plan.id === planId 
        ? { ...plan, adsEnabled: !plan.adsEnabled }
        : plan
    ));
  };

  const savePlanChanges = async (planId: string) => {
    try {
      const plan = plans.find(p => p.id === planId);
      if (!plan) return;

      const planRef = doc(db, 'subscriptionPlans', planId);
      await setDoc(planRef, {
        id: plan.id,
        name: plan.name,
        priceMonthly: plan.priceMonthly,
        priceYearly: plan.priceYearly,
        icon: plan.icon,
        color: plan.color,
        popular: plan.popular,
        buttonText: plan.buttonText,
        features: plan.features,
        adsEnabled: plan.adsEnabled,
        updatedAt: new Date().toISOString()
      });
      
      alert('Plan updated successfully!');
      setEditingPlan(null);
    } catch (error) {
      console.error('Error updating plan:', error);
      alert('Error updating plan: ' + (error as Error).message);
    }
  };

  const saveAllPlans = async () => {
    try {
      setSaving(true);
      
      // Save all plans to Firestore
      const savePromises = plans.map(plan => {
        const planRef = doc(db, 'subscriptionPlans', plan.id);
        return setDoc(planRef, {
          id: plan.id,
          name: plan.name,
          priceMonthly: plan.priceMonthly,
          priceYearly: plan.priceYearly,
          icon: plan.icon,
          color: plan.color,
          popular: plan.popular,
          buttonText: plan.buttonText,
          features: plan.features,
          adsEnabled: plan.adsEnabled,
          updatedAt: new Date().toISOString()
        });
      });

      await Promise.all(savePromises);
      alert('All subscription plans saved successfully!');
    } catch (error) {
      console.error('Error saving plans:', error);
      alert('Error saving plans: ' + (error as Error).message);
    } finally {
      setSaving(false);
    }
  };

  return (
    <View style={[styles.contentContainer, { backgroundColor: colors.lightGray }]}>
      {/* Header with Save Button */}
      <View style={{ marginBottom: 32 }}>
        <View style={{ flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center', marginBottom: 8 }}>
          <View style={{ flex: 1 }}>
            <Text style={{ fontSize: 24, fontFamily: fonts.regular, color: colors.deepNavy, marginBottom: 4 }}>
              Subscription Plans
            </Text>
            <Text style={{ fontSize: 14, color: colors.warmGray, fontFamily: fonts.regular }}>
              Manage pricing, features, and ad settings
            </Text>
          </View>
          <TouchableOpacity
            onPress={saveAllPlans}
            disabled={saving}
            style={{
              backgroundColor: saving ? colors.warmGray : '#10B981',
              paddingHorizontal: 20,
              paddingVertical: 12,
              borderRadius: 10,
              flexDirection: 'row',
              alignItems: 'center',
              gap: 8,
              shadowColor: '#10B981',
              shadowOffset: { width: 0, height: 2 },
              shadowOpacity: 0.3,
              shadowRadius: 4
            }}
          >
            <Icon name="save" size={18} color="white" />
            <Text style={{ 
              color: 'white',
              fontSize: 14,
              fontFamily: fonts.regular,
              letterSpacing: 0.3
            }}>
              {saving ? 'Saving...' : 'Save All'}
            </Text>
          </TouchableOpacity>
        </View>
      </View>

      {/* Billing Period Toggle */}
      <View style={{ 
        flexDirection: 'row', 
        alignItems: 'center', 
        justifyContent: 'center',
        marginBottom: 40,
        gap: 4,
        backgroundColor: colors.lightGray,
        borderRadius: 10,
        padding: 4,
        alignSelf: 'center'
      }}>
        <TouchableOpacity
          onPress={() => setBillingPeriod('monthly')}
          style={{
            paddingHorizontal: 28,
            paddingVertical: 10,
            borderRadius: 8,
            backgroundColor: billingPeriod === 'monthly' ? colors.white : 'transparent',
            shadowColor: billingPeriod === 'monthly' ? '#000' : 'transparent',
            shadowOffset: { width: 0, height: 1 },
            shadowOpacity: 0.1,
            shadowRadius: 2,
            elevation: billingPeriod === 'monthly' ? 2 : 0
          }}
        >
          <Text style={{ 
            fontSize: 14,
            fontFamily: fonts.regular,
            color: billingPeriod === 'monthly' ? colors.deepNavy : colors.warmGray
          }}>
            Monthly
          </Text>
        </TouchableOpacity>
        <TouchableOpacity
          onPress={() => setBillingPeriod('yearly')}
          style={{
            paddingHorizontal: 28,
            paddingVertical: 10,
            borderRadius: 8,
            backgroundColor: billingPeriod === 'yearly' ? colors.white : 'transparent',
            shadowColor: billingPeriod === 'yearly' ? '#000' : 'transparent',
            shadowOffset: { width: 0, height: 1 },
            shadowOpacity: 0.1,
            shadowRadius: 2,
            elevation: billingPeriod === 'yearly' ? 2 : 0,
            flexDirection: 'row',
            alignItems: 'center',
            gap: 8
          }}
        >
          <Text style={{ 
            fontSize: 14,
            fontFamily: fonts.regular,
            color: billingPeriod === 'yearly' ? colors.deepNavy : colors.warmGray
          }}>
            Yearly
          </Text>
          <View style={{ 
            backgroundColor: '#10B981', 
            paddingHorizontal: 8, 
            paddingVertical: 2, 
            borderRadius: 6 
          }}>
            <Text style={{ color: 'white', fontSize: 10, fontFamily: fonts.regular }}>
              -17%
            </Text>
          </View>
        </TouchableOpacity>
      </View>

      <View style={{ 
        flexDirection: 'row', 
        flexWrap: 'wrap', 
        justifyContent: 'center',
        gap: 20
      }}>
        {plans.map((plan) => {
          const currentPrice = billingPeriod === 'monthly' ? plan.priceMonthly : plan.priceYearly;
          
          return (
          <View 
            key={plan.id}
            style={{
              width: '31%',
              minWidth: 280,
              backgroundColor: colors.white,
              borderRadius: 16,
              padding: 24,
              borderWidth: plan.popular ? 2 : 1,
              borderColor: plan.popular ? plan.color : colors.lightGray,
              position: 'relative',
              transition: 'all 0.2s ease'
            }}
          >
            {plan.popular && (
              <View style={{
                position: 'absolute',
                top: -12,
                left: 0,
                right: 0,
                alignItems: 'center'
              }}>
                <View style={{
                  backgroundColor: plan.color,
                  paddingHorizontal: 16,
                  paddingVertical: 6,
                  borderRadius: 20
                }}>
                  <Text style={{ 
                    color: 'white', 
                    fontSize: 11, 
                    fontFamily: fonts.regular,
                    textTransform: 'uppercase',
                    letterSpacing: 0.5
                  }}>
                    Most Popular
                  </Text>
                </View>
              </View>
            )}

            <View style={{ 
              width: 48, 
              height: 48, 
              borderRadius: 12, 
              backgroundColor: `${plan.color}15`,
              justifyContent: 'center',
              alignItems: 'center',
              marginBottom: 16,
              marginTop: plan.popular ? 8 : 0
            }}>
              <Icon name={plan.icon} size={24} color={plan.color} />
            </View>

            {/* Plan Name and Edit Button */}
            <View style={{ 
              flexDirection: 'row', 
              alignItems: 'center', 
              justifyContent: 'space-between',
              marginBottom: 12
            }}>
              <Text style={{ 
                fontSize: 22, 
                fontFamily: fonts.regular,
                color: colors.deepNavy,
                letterSpacing: -0.5
              }}>
                {plan.name}
              </Text>
              <TouchableOpacity
                onPress={() => setEditingPlan(editingPlan === plan.id ? null : plan.id)}
                style={{
                  backgroundColor: editingPlan === plan.id ? plan.color : colors.lightGray,
                  paddingHorizontal: 14,
                  paddingVertical: 7,
                  borderRadius: 8
                }}
              >
                <Text style={{ 
                  color: editingPlan === plan.id ? 'white' : colors.deepNavy,
                  fontSize: 13,
                  fontFamily: fonts.regular
                }}>
                  {editingPlan === plan.id ? 'Cancel' : 'Edit'}
                </Text>
              </TouchableOpacity>
            </View>

            {editingPlan === plan.id ? (
              <>
                {/* Price Editing */}
                <View style={{ marginBottom: 14 }}>
                  <Text style={{ fontSize: 12, color: colors.warmGray, marginBottom: 6, fontFamily: fonts.regular }}>
                    Monthly Price (Br)
                  </Text>
                  <input
                    type="number"
                    value={plan.priceMonthly}
                    onChange={(e) => handlePriceChange(plan.id, 'priceMonthly', e.target.value)}
                    style={{
                      width: '100%',
                      padding: 10,
                      fontSize: 14,
                      borderRadius: 8,
                      border: `2px solid ${plan.color}30`,
                      fontFamily: fonts.regular,
                      backgroundColor: colors.white,
                      color: colors.deepNavy,
                      outline: 'none'
                    }}
                  />
                </View>
                <View style={{ marginBottom: 14 }}>
                  <Text style={{ fontSize: 12, color: colors.warmGray, marginBottom: 6, fontFamily: fonts.regular }}>
                    Yearly Price (Br)
                  </Text>
                  <input
                    type="number"
                    value={plan.priceYearly}
                    onChange={(e) => handlePriceChange(plan.id, 'priceYearly', e.target.value)}
                    style={{
                      width: '100%',
                      padding: 10,
                      fontSize: 14,
                      borderRadius: 8,
                      border: `2px solid ${plan.color}30`,
                      fontFamily: fonts.regular,
                      backgroundColor: colors.white,
                      color: colors.deepNavy,
                      outline: 'none'
                    }}
                  />
                </View>

                {/* Enable Ads Toggle */}
                <View style={{ 
                  flexDirection: 'row', 
                  alignItems: 'center', 
                  justifyContent: 'space-between',
                  backgroundColor: colors.lightGray,
                  padding: 12,
                  borderRadius: 10,
                  marginBottom: 14
                }}>
                  <Text style={{ fontSize: 13, fontFamily: fonts.regular, color: colors.deepNavy }}>
                    Enable Ads
                  </Text>
                  <TouchableOpacity
                    onPress={() => toggleAds(plan.id)}
                    style={{
                      width: 44,
                      height: 24,
                      borderRadius: 12,
                      backgroundColor: plan.adsEnabled ? '#EF4444' : '#10B981',
                      padding: 2,
                      justifyContent: 'center'
                    }}
                  >
                    <View style={{
                      width: 20,
                      height: 20,
                      borderRadius: 10,
                      backgroundColor: 'white',
                      alignSelf: plan.adsEnabled ? 'flex-end' : 'flex-start',
                      shadowColor: '#000',
                      shadowOffset: { width: 0, height: 1 },
                      shadowOpacity: 0.2,
                      shadowRadius: 2
                    }} />
                  </TouchableOpacity>
                </View>
              </>
            ) : (
              <>
                <View style={{ flexDirection: 'row', alignItems: 'baseline', marginBottom: 4 }}>
                  <Text style={{ 
                    fontSize: 32, 
                    fontFamily: fonts.regular,
                    color: plan.color,
                    letterSpacing: -1
                  }}>
                    {currentPrice === 0 ? 'Free' : `${currentPrice} Br`}
                  </Text>
                  {currentPrice > 0 && (
                    <Text style={{ 
                      fontSize: 15, 
                      fontFamily: fonts.regular,
                      color: '#9CA3AF',
                      marginLeft: 6
                    }}>
                      / {billingPeriod === 'monthly' ? 'month' : 'year'}
                    </Text>
                  )}
                </View>

                {/* Ads Status Badge */}
                <View style={{
                  backgroundColor: plan.adsEnabled ? '#FEF2F2' : '#F0FDF4',
                  paddingHorizontal: 10,
                  paddingVertical: 5,
                  borderRadius: 12,
                  alignSelf: 'flex-start',
                  marginBottom: 12,
                  marginTop: 8,
                  borderWidth: 1,
                  borderColor: plan.adsEnabled ? '#FEE2E2' : '#DCFCE7'
                }}>
                  <Text style={{
                    fontSize: 11,
                    fontFamily: fonts.regular,
                    color: plan.adsEnabled ? '#EF4444' : '#10B981',
                    letterSpacing: 0.3
                  }}>
                    {plan.adsEnabled ? 'ADS ENABLED' : 'AD-FREE'}
                  </Text>
                </View>
              </>
            )}

            <View style={{ 
              height: 1, 
              backgroundColor: '#E5E7EB', 
              marginVertical: 16 
            }} />

            {/* Features List with Toggle */}
            <View style={{ marginBottom: 16 }}>
              <Text style={{ 
                fontSize: 13, 
                fontFamily: fonts.regular,
                color: '#111',
                marginBottom: 12,
                letterSpacing: 0.3
              }}>
                FEATURES
              </Text>
              {plan.features.map((feature, index) => (
                <View 
                  key={index}
                  style={{ 
                    flexDirection: 'row', 
                    alignItems: 'center',
                    justifyContent: 'space-between',
                    marginBottom: 10,
                    backgroundColor: editingPlan === plan.id ? colors.lightGray : 'transparent',
                    padding: editingPlan === plan.id ? 8 : 0,
                    borderRadius: 8
                  }}
                >
                  <View style={{ flexDirection: 'row', alignItems: 'flex-start', flex: 1 }}>
                    <Text style={{ 
                      color: feature.enabled ? plan.color : colors.warmGray, 
                      marginRight: 10,
                      fontSize: 16,
                      lineHeight: 20
                    }}>
                      {feature.enabled ? 'âœ“' : 'â—‹'}
                    </Text>
                    <Text style={{ 
                      flex: 1,
                      fontSize: 13, 
                      fontFamily: fonts.regular,
                      color: feature.enabled ? colors.deepNavy : colors.warmGray,
                      lineHeight: 20,
                      textDecorationLine: feature.enabled ? 'none' : 'line-through'
                    }}>
                      {feature.name}
                    </Text>
                  </View>
                  
                  {editingPlan === plan.id && (
                    <TouchableOpacity
                      onPress={() => toggleFeature(plan.id, index)}
                      style={{
                        width: 40,
                        height: 22,
                        borderRadius: 11,
                        backgroundColor: feature.enabled ? plan.color : colors.warmGray,
                        padding: 2,
                        justifyContent: 'center',
                        marginLeft: 8
                      }}
                    >
                      <View style={{
                        width: 18,
                        height: 18,
                        borderRadius: 9,
                        backgroundColor: 'white',
                        alignSelf: feature.enabled ? 'flex-end' : 'flex-start',
                        shadowColor: '#000',
                        shadowOffset: { width: 0, height: 1 },
                        shadowOpacity: 0.2,
                        shadowRadius: 2
                      }} />
                    </TouchableOpacity>
                  )}
                </View>
              ))}
            </View>

            {editingPlan === plan.id ? (
              <TouchableOpacity
                onPress={() => savePlanChanges(plan.id)}
                style={{
                  backgroundColor: plan.color,
                  borderRadius: 10,
                  paddingVertical: 12,
                  alignItems: 'center',
                  marginTop: 4,
                  shadowColor: plan.color,
                  shadowOffset: { width: 0, height: 2 },
                  shadowOpacity: 0.3,
                  shadowRadius: 4
                }}
              >
                <Text style={{ 
                  color: 'white',
                  fontSize: 14,
                  fontFamily: fonts.regular,
                  letterSpacing: 0.3
                }}>
                  Save Changes
                </Text>
              </TouchableOpacity>
            ) : (
              <TouchableOpacity
                style={{
                  backgroundColor: 'white',
                  borderWidth: 2,
                  borderColor: plan.color,
                  borderRadius: 10,
                  paddingVertical: 12,
                  alignItems: 'center',
                  marginTop: 4,
                  shadowColor: '#000',
                  shadowOffset: { width: 0, height: 2 },
                  shadowOpacity: 0.1,
                  shadowRadius: 4
                }}
              >
                <Text style={{ 
                  color: '#000000',
                  fontSize: 14,
                  fontFamily: fonts.regular,
                  letterSpacing: 0.3
                }}>
                  {plan.buttonText}
                </Text>
              </TouchableOpacity>
            )}
          </View>
          );
        })}
      </View>
    </View>
  );
}

// Analytics Content
// Analytics Content
function AnalyticsContent({ colors = lightColors }: { colors?: any }) {
  const [loading, setLoading] = useState(true);
  const [stats, setStats] = useState({
    totalUsers: 0,
    totalJobs: 0,
    totalCompanies: 0,
    totalChannels: 0,
    activeChannels: 0,
    activeUsers: 0,
    verifiedUsers: 0,
    jobsThisMonth: 0,
    subscriptions: {
      free: 0,
      standard: 0,
      enterprise: 0
    },
    usersByRole: {
      user: 0,
      company: 0,
      admin: 0,
      superadmin: 0
    }
  });

  useEffect(() => {
    fetchAnalytics();
  }, []);

  const fetchAnalytics = async () => {
    try {
      setLoading(true);
      
      // Fetch all collections in parallel
      const [usersSnapshot, jobsSnapshot, channelsSnapshot] = await Promise.all([
        getDocs(collection(db, 'users')),
        getDocs(collection(db, 'jobs')),
        getDocs(collection(db, 'telegramChannels'))
      ]);

      // Calculate user stats
      const users = usersSnapshot.docs.map(doc => doc.data());
      const activeUsers = users.filter(u => u.isActive !== false).length;
      const verifiedUsers = users.filter(u => u.isVerified === true).length;
      
      // Count by role
      const usersByRole = {
        user: users.filter(u => u.role === 'user' || !u.role).length,
        company: users.filter(u => u.role === 'company').length,
        admin: users.filter(u => u.role === 'admin').length,
        superadmin: users.filter(u => u.role === 'superadmin').length
      };

      // Count by subscription
      const subscriptions = {
        free: users.filter(u => !u.subscriptionId || u.subscriptionId === 'free').length,
        standard: users.filter(u => u.subscriptionId === 'standard').length,
        enterprise: users.filter(u => u.subscriptionId === 'enterprise').length
      };

      // Calculate job stats
      const jobs = jobsSnapshot.docs.map(doc => doc.data());
      const uniqueCompanies = new Set(jobs.map(j => j.company).filter(c => c)).size;
      
      // Jobs this month
      const startOfMonth = new Date();
      startOfMonth.setDate(1);
      startOfMonth.setHours(0, 0, 0, 0);
      const jobsThisMonth = jobs.filter(j => {
        const jobDate = j.postedDate?.toDate?.() || new Date(j.postedDate);
        return jobDate >= startOfMonth;
      }).length;

      // Calculate channel stats
      const channels = channelsSnapshot.docs.map(doc => doc.data());
      const activeChannels = channels.filter(c => c.isActive && c.scrapingEnabled).length;

      setStats({
        totalUsers: usersSnapshot.size,
        totalJobs: jobsSnapshot.size,
        totalCompanies: uniqueCompanies,
        totalChannels: channelsSnapshot.size,
        activeChannels,
        activeUsers,
        verifiedUsers,
        jobsThisMonth,
        subscriptions,
        usersByRole
      });
    } catch (error) {
      console.error('Error fetching analytics:', error);
      alert('Error loading analytics data');
    } finally {
      setLoading(false);
    }
  };

  const StatCard = ({ icon, title, value, subtitle, color: cardColor }: any) => (
    <View style={{
      flex: 1,
      minWidth: 250,
      backgroundColor: colors.white,
      borderRadius: 16,
      padding: 24,
      marginBottom: 20,
      marginRight: 20,
      borderWidth: 1,
      borderColor: colors.lightGray,
      shadowColor: '#000',
      shadowOffset: { width: 0, height: 2 },
      shadowOpacity: 0.05,
      shadowRadius: 8
    }}>
      <View style={{ flexDirection: 'row', alignItems: 'center', marginBottom: 12 }}>
        <View style={{
          width: 48,
          height: 48,
          borderRadius: 12,
          backgroundColor: `${cardColor}20`,
          justifyContent: 'center',
          alignItems: 'center',
          marginRight: 12
        }}>
          <Icon name={icon} size={24} color={cardColor} />
        </View>
        <Text style={{ fontSize: 14, fontFamily: fonts.regular, color: colors.warmGray }}>
          {title}
        </Text>
      </View>
      <Text style={{ fontSize: 36, fontFamily: fonts.regular, color: colors.deepNavy, marginBottom: 4 }}>
        {value.toLocaleString()}
      </Text>
      {subtitle && (
        <Text style={{ fontSize: 13, fontFamily: fonts.regular, color: colors.warmGray }}>
          {subtitle}
        </Text>
      )}
    </View>
  );

  if (loading) {
    return (
      <View style={[styles.contentContainer, { justifyContent: 'center', alignItems: 'center', backgroundColor: colors.lightGray }]}>
        <ActivityIndicator size="large" color={colors.beeYellow} />
        <Text style={{ marginTop: 16, fontSize: 16, color: colors.warmGray, fontFamily: fonts.regular }}>
          Loading analytics...
        </Text>
      </View>
    );
  }

  return (
    <ScrollView style={[styles.contentContainer, { backgroundColor: colors.lightGray }]}>
      {/* Header */}
      <View style={{ marginBottom: 32 }}>
        <View style={{ flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center', marginBottom: 8 }}>
          <View>
            <Text style={{ fontSize: 24, fontFamily: fonts.regular, color: colors.deepNavy, marginBottom: 4 }}>
              Analytics
            </Text>
            <Text style={{ fontSize: 14, color: colors.warmGray, fontFamily: fonts.regular }}>
              Overview of your platform's key metrics
            </Text>
          </View>
          <TouchableOpacity
            onPress={fetchAnalytics}
            style={{
              backgroundColor: colors.beeYellow,
              paddingHorizontal: 20,
              paddingVertical: 12,
              borderRadius: 10,
              flexDirection: 'row',
              alignItems: 'center',
              gap: 8
            }}
          >
            <Icon name="refresh" size={18} color="#000000" />
            <Text style={{ color: '#000000', fontSize: 14, fontFamily: fonts.regular }}>
              Refresh
            </Text>
          </TouchableOpacity>
        </View>
      </View>

      {/* Main Stats */}
      <Text style={{ fontSize: 18, fontFamily: fonts.regular, color: colors.deepNavy, marginBottom: 16 }}>
        Overview
      </Text>
      <View style={{ flexDirection: 'row', flexWrap: 'wrap', marginBottom: 32 }}>
        <StatCard
          icon="people"
          title="Total Users"
          value={stats.totalUsers}
          subtitle={`${stats.activeUsers} active, ${stats.verifiedUsers} verified`}
          color="#3B82F6"
        />
        <StatCard
          icon="work"
          title="Total Jobs"
          value={stats.totalJobs}
          subtitle={`${stats.jobsThisMonth} posted this month`}
          color="#10B981"
        />
        <StatCard
          icon="business"
          title="Companies"
          value={stats.totalCompanies}
          subtitle="Unique companies posting"
          color="#F59E0B"
        />
        <StatCard
          icon="rss-feed"
          title="Telegram Channels"
          value={stats.totalChannels}
          subtitle={`${stats.activeChannels} active & scraping`}
          color="#8B5CF6"
        />
      </View>

      {/* Users by Role */}
      <Text style={{ fontSize: 18, fontFamily: fonts.regular, color: colors.deepNavy, marginBottom: 16 }}>
        Users by Role
      </Text>
      <View style={{ flexDirection: 'row', flexWrap: 'wrap', marginBottom: 32 }}>
        <StatCard
          icon="person"
          title="Regular Users"
          value={stats.usersByRole.user}
          color="#6B7280"
        />
        <StatCard
          icon="business-center"
          title="Companies"
          value={stats.usersByRole.company}
          color="#F59E0B"
        />
        <StatCard
          icon="admin-panel-settings"
          title="Admins"
          value={stats.usersByRole.admin}
          color="#EF4444"
        />
        <StatCard
          icon="verified-user"
          title="Super Admins"
          value={stats.usersByRole.superadmin}
          color="#8B5CF6"
        />
      </View>

      {/* Subscriptions */}
      <Text style={{ fontSize: 18, fontFamily: fonts.regular, color: colors.deepNavy, marginBottom: 16 }}>
        Subscription Plans
      </Text>
      <View style={{ flexDirection: 'row', flexWrap: 'wrap', marginBottom: 32 }}>
        <StatCard
          icon="star-outline"
          title="Free Plan"
          value={stats.subscriptions.free}
          subtitle={`${((stats.subscriptions.free / stats.totalUsers) * 100).toFixed(1)}% of users`}
          color="#808080"
        />
        <StatCard
          icon="star"
          title="Standard Plan"
          value={stats.subscriptions.standard}
          subtitle={`${((stats.subscriptions.standard / stats.totalUsers) * 100).toFixed(1)}% of users`}
          color="#F4C430"
        />
        <StatCard
          icon="business"
          title="Enterprise Plan"
          value={stats.subscriptions.enterprise}
          subtitle={`${((stats.subscriptions.enterprise / stats.totalUsers) * 100).toFixed(1)}% of users`}
          color="#1A365D"
        />
      </View>
    </ScrollView>
  );
}

// Navigation Setup
const Stack = createNativeStackNavigator();

// Theme Switcher Component
function ThemeSwitcher({ isDarkMode, onToggle }: { isDarkMode: boolean; onToggle: () => void }) {
  return (
    <TouchableOpacity
      onPress={onToggle}
      style={{
        position: 'absolute',
        top: 20,
        right: 20,
        zIndex: 1000,
        backgroundColor: isDarkMode ? '#374151' : '#FFFFFF',
        borderRadius: 25,
        width: 50,
        height: 50,
        justifyContent: 'center',
        alignItems: 'center',
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: isDarkMode ? 0.4 : 0.15,
        shadowRadius: 8,
        elevation: 5,
        borderWidth: 1,
        borderColor: isDarkMode ? '#4B5563' : '#E5E7EB'
      }}
    >
      <Icon
        name={isDarkMode ? 'wb-sunny' : 'nights-stay'}
        size={24}
        color={isDarkMode ? '#FCD34D' : '#F59E0B'}
      />
    </TouchableOpacity>
  );
}

// Home Screen Component
function HomeScreen({ navigation }: any) {
  const [jobs, setJobs] = useState<any[]>([]);
  const [allJobs, setAllJobs] = useState<any[]>([]);
  const [filteredJobs, setFilteredJobs] = useState<any[]>([]);
  const [telegramChannels, setTelegramChannels] = useState<any[]>([]);
  const [categories, setCategories] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [searchText, setSearchText] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('');
  const [selectedContractType, setSelectedContractType] = useState('');
  const [isRemote, setIsRemote] = useState(false);
  const [user, setUser] = useState<any>(null);
  const [userData, setUserData] = useState<any>(null);
  
  // Theme and Language states
  const [isDarkMode, setIsDarkMode] = useState(false);
  const [currentLanguage, setCurrentLanguage] = useState('en'); // 'en', 'am', 'ti', 'or'
  const [isLanguageDropdownOpen, setIsLanguageDropdownOpen] = useState(false);
  const [dropdownPosition, setDropdownPosition] = useState({ top: 60, right: 20 });
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const languageButtonRef = useRef<TouchableOpacity>(null);
  const channelScrollViewRef = useRef<ScrollView>(null);
  
  // Auth state listener
  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, async (authUser) => {
      setUser(authUser);
      if (authUser) {
        // Fetch user data from Firestore
        try {
          const userDocRef = doc(db, 'users', authUser.uid);
          const userDoc = await getDoc(userDocRef);
          if (userDoc.exists()) {
            setUserData(userDoc.data());
          }
        } catch (error) {
          console.error('Error fetching user data:', error);
        }
      } else {
        setUserData(null);
      }
    });
    return unsubscribe;
  }, []);
  
  // Responsive design
  const [dimensions, setDimensions] = useState(Dimensions.get('window'));
  const isMobile = dimensions.width < 480;
  const isTablet = dimensions.width >= 480 && dimensions.width < 768;
  const isDesktop = dimensions.width >= 768;

  useEffect(() => {
    const subscription = Dimensions.addEventListener('change', ({ window }) => {
      setDimensions(window);
    });
    return () => subscription?.remove();
  }, []);
  
  // Helper variables for current theme and language
  const colors = getColors(isDarkMode);
  const t = translations[currentLanguage as keyof typeof translations];
  
  // Language options for dropdown
  const languageOptions = [
    { code: 'en', label: 'English' },
    { code: 'am', label: 'áŠ áˆ›áˆ­áŠ›' },
    { code: 'ti', label: 'á‰µáŒáˆ­áŠ›' },
    { code: 'or', label: 'Afaan Oromoo' }
  ];
  
  const getCurrentLanguage = () => {
    return languageOptions.find(lang => lang.code === currentLanguage) || languageOptions[0];
  };
  
  // Dynamic styles based on current theme
  const dynamicStyles = StyleSheet.create({
    container: {
      ...styles.container,
      backgroundColor: colors.white,
    },
    toolbar: {
      ...styles.toolbar,
      backgroundColor: colors.white,
    },
    appTitle: {
      ...styles.appTitle,
      color: colors.deepNavy,
    },
    searchContainer: {
      ...styles.searchContainer,
      backgroundColor: colors.lightGray,
    },
    searchInput: {
      ...styles.searchInput,
      color: colors.deepNavy,
    },
    leftContent: {
      ...styles.leftContent,
      backgroundColor: colors.cream,
    },
    channelsSection: {
      ...styles.channelsSection,
      backgroundColor: colors.white,
    },
    channelCard: {
      ...styles.channelCard,
      backgroundColor: colors.cream,
      borderColor: colors.beeYellow,
    },
    jobsSection: {
      ...styles.jobsSection,
      backgroundColor: colors.white,
    },
    sectionTitle: {
      ...styles.sectionTitle,
      color: colors.deepNavy,
    },
    // Job card styles
    jobCard: {
      ...styles.jobCard,
      backgroundColor: colors.white,
      borderColor: colors.lightGray,
      maxWidth: isMobile ? '100%' : '32%',
    },
    // Filter sidebar styles
    filterSidebar: {
      ...styles.filterSidebar,
      backgroundColor: colors.white,
      borderLeftColor: colors.sidebarBorder,
    },
    filterTitle: {
      ...styles.filterTitle,
      color: colors.deepNavy,
    },
    filterLabel: {
      ...styles.filterLabel,
      color: colors.deepNavy,
    },
    filterOption: {
      ...styles.filterOption,
      backgroundColor: colors.lightGray,
    },
    filterOptionText: {
      ...styles.filterOptionText,
      color: colors.deepNavy,
    },
    jobsCount: {
      ...styles.jobsCount,
      color: colors.warmGray,
    },
    // Job card text styles
    jobTitle: {
      ...styles.jobTitle,
      color: colors.deepNavy,
    },
    jobCompany: {
      ...styles.jobCompany,
      color: colors.warmGray,
    },
    jobCategory: {
      ...styles.jobCategory,
      color: colors.softBlue,
    },
    jobLocation: {
      ...styles.jobLocation,
      color: colors.warmGray,
    },
    jobSalary: {
      ...styles.jobSalary,
      color: colors.success,
    },
    jobBadgeText: {
      ...styles.jobBadgeText,
      color: colors.deepNavy,
    },
    jobSource: {
      ...styles.jobSource,
      color: colors.warmGray,
    },
    jobDate: {
      ...styles.jobDate,
      color: colors.warmGray,
    },
    // Download button styles
    downloadButton: {
      ...styles.downloadButton,
      backgroundColor: colors.beeYellow,
    },
    downloadButtonText: {
      ...styles.downloadButtonText,
      color: colors.deepNavy,
    },
    
    // Modern Header Dynamic Styles
    modernHeader: {
      backgroundColor: colors.white,
      borderBottomWidth: 2,
      borderBottomColor: isDarkMode ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.08)',
      shadowColor: '#000',
      shadowOffset: { width: 0, height: 2 },
      shadowOpacity: isDarkMode ? 0.3 : 0.1,
      shadowRadius: 8,
      elevation: 4,
    },
    modernBrandText: {
      fontSize: 20,
      fontWeight: '700',
      color: colors.deepNavy,
    },
    modernNavText: {
      fontSize: 14,
      fontWeight: '500',
      color: colors.warmGray,
    },
    
    // Hero Section Dynamic Styles
    heroSection: {
      backgroundColor: colors.white,
    },
    heroTitle: {
      fontSize: 48,
      fontWeight: '800',
      color: colors.deepNavy,
      marginBottom: 16,
      lineHeight: 56,
    },
    heroSubtitle: {
      fontSize: 18,
      color: colors.warmGray,
      marginBottom: 32,
      lineHeight: 28,
    },
    modernSearchContainer: {
      flexDirection: 'row',
      alignItems: 'center',
      backgroundColor: colors.lightGray,
      borderRadius: 24,
      paddingHorizontal: 20,
      paddingVertical: 4,
      gap: 16,
      marginBottom: 32,
    },
    modernSearchInput: {
      flex: 1,
      fontSize: 16,
      color: colors.deepNavy,
      paddingVertical: 12,
    },
    heroStatNumber: {
      fontSize: 24,
      fontWeight: '700',
      color: colors.deepNavy,
      marginBottom: 4,
    },
    heroStatLabel: {
      fontSize: 14,
      color: colors.warmGray,
    },
    heroImageText: {
      fontSize: 16,
      fontWeight: '600',
      color: colors.warmGray,
      marginTop: 12,
    },
    
    // Mobile Menu Dynamic Styles
    mobileMenu: {
      position: 'absolute',
      top: 80,
      left: 20,
      right: 20,
      backgroundColor: colors.white,
      borderRadius: 12,
      shadowColor: colors.charcoal,
      shadowOffset: { width: 0, height: 4 },
      shadowOpacity: 0.15,
      shadowRadius: 12,
      elevation: 8,
    },
    mobileMenuTitle: {
      fontSize: 18,
      fontWeight: '700',
      color: colors.deepNavy,
    },
    mobileMenuItemText: {
      fontSize: 16,
      fontWeight: '500',
      color: colors.deepNavy,
    },
    mobileMenuSectionTitle: {
      fontSize: 14,
      fontWeight: '600',
      color: colors.warmGray,
      marginBottom: 12,
    },
    sectionSubtitle: {
      fontSize: 20,
      color: '#6c757d',
      fontFamily: fonts.regular,
      textAlign: 'center',
      maxWidth: 700,
      alignSelf: 'center',
      lineHeight: 32,
    },
    aboutText: {
      fontSize: 17,
      lineHeight: 30,
      color: '#495057',
      fontFamily: fonts.regular,
      marginBottom: 0,
      textAlign: 'center',
    },
    aboutFeatureTitle: {
      fontSize: 19,
      fontWeight: '700',
      color: '#212529',
      marginBottom: 8,
      letterSpacing: 0.3,
    },
    aboutFeatureDescription: {
      fontSize: 15,
      lineHeight: 24,
      color: '#6c757d',
      fontFamily: fonts.regular,
    },
    pricingTierName: {
      fontSize: 28,
      fontWeight: '700',
      color: '#212529',
      marginBottom: 12,
      letterSpacing: 0.5,
    },
    pricingPrice: {
      fontSize: 56,
      fontWeight: '800',
      color: '#212529',
      marginBottom: 4,
      letterSpacing: -1,
    },
    pricingPeriod: {
      fontSize: 16,
      color: '#6c757d',
      fontFamily: fonts.regular,
      letterSpacing: 0.3,
    },
    pricingFeatureText: {
      fontSize: 15,
      lineHeight: 24,
      color: '#495057',
      fontFamily: fonts.regular,
      flex: 1,
    },
  });
  
  // Theme and language handlers
  const toggleTheme = () => {
    setIsDarkMode(!isDarkMode);
  };
  
  const changeLanguage = async (langCode: string) => {
    setCurrentLanguage(langCode);
    setIsLanguageDropdownOpen(false); // Close dropdown after selection
    try {
      await AsyncStorage.setItem('selectedLanguage', langCode);
    } catch (error) {
      console.error('Error saving language preference:', error);
    }
  };
  
  const toggleLanguageDropdown = () => {
    if (!isLanguageDropdownOpen && languageButtonRef.current) {
      languageButtonRef.current.measureInWindow((x, y, width, height) => {
        setDropdownPosition({
          top: y + height + 5, // 5px below the button
          right: window.innerWidth - x - width, // Align right edge with button's right edge
        });
      });
    }
    setIsLanguageDropdownOpen(!isLanguageDropdownOpen);
  };

  useEffect(() => {
    const loadLanguage = async () => {
      try {
        const savedLanguage = await AsyncStorage.getItem('selectedLanguage');
        if (savedLanguage) {
          setCurrentLanguage(savedLanguage);
        }
      } catch (error) {
        console.error('Error loading language preference:', error);
      }
    };
    
    loadLanguage();
    fetchJobs();
    fetchTelegramChannels();
    fetchCategories();
  }, []);

  useEffect(() => {
    filterJobs();
  }, [allJobs, searchText, selectedCategory, selectedContractType, isRemote]);

  // Auto-scroll effect for infinite channel scroll
  useEffect(() => {
    if (telegramChannels.length === 0) return;
    
    let scrollPosition = 0;
    const scrollSpeed = 1; // pixels per interval
    const intervalTime = 30; // milliseconds
    
    const autoScroll = setInterval(() => {
      if (channelScrollViewRef.current) {
        scrollPosition += scrollSpeed;
        
        // Calculate total content width (channels * card width)
        const cardWidth = 120; // Width of simplified card
        const totalWidth = telegramChannels.length * cardWidth;
        
        // Reset to beginning when reaching the end for infinite loop effect
        if (scrollPosition >= totalWidth / 2) {
          scrollPosition = 0;
        }
        
        channelScrollViewRef.current.scrollTo({
          x: scrollPosition,
          animated: false,
        });
      }
    }, intervalTime);
    
    return () => clearInterval(autoScroll);
  }, [telegramChannels]);

  const filterJobs = () => {
    let filtered = [...allJobs];

    // Search filter
    if (searchText.trim()) {
      const searchLower = searchText.toLowerCase();
      filtered = filtered.filter(job => 
        (job.title || '').toLowerCase().includes(searchLower) ||
        (job.company || '').toLowerCase().includes(searchLower) ||
        (job.description || '').toLowerCase().includes(searchLower) ||
        (job.category || '').toLowerCase().includes(searchLower) ||
        (job.location || '').toLowerCase().includes(searchLower)
      );
    }

    // Category filter
    if (selectedCategory) {
      filtered = filtered.filter(job => 
        job.categoryId === selectedCategory || 
        job.mainCategoryId === selectedCategory ||
        job.category === selectedCategory
      );
    }

    // Contract type filter
    if (selectedContractType) {
      filtered = filtered.filter(job => job.contractType === selectedContractType);
    }

    // Remote filter
    if (isRemote) {
      filtered = filtered.filter(job => job.isRemote === true);
    }

    setFilteredJobs(filtered);
    setJobs(filtered);
  };

  const fetchJobs = async () => {
    try {
      const jobsQuery = dbQuery(
        collection(db, 'jobs'),
        orderBy('createdAt', 'desc'),
        limit(9)
      );
      const jobsSnapshot = await getDocs(jobsQuery);
      const fetchedJobs = jobsSnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data() as any
      }));
      setAllJobs(fetchedJobs);
      setJobs(fetchedJobs);
      setFilteredJobs(fetchedJobs);
    } catch (error) {
      console.error('Error fetching jobs:', error);
    } finally {
      setLoading(false);
    }
  };

  const fetchTelegramChannels = async () => {
    try {
      // Using local embedded images instead of Firebase
      const fetchedChannels = [
        { id: '1', name: 'Addis Ababa Jobs', imageUrl: require('./assets/channels/addis_ababa_jobs.jpg') },
        { id: '2', name: 'Addis Jobs', imageUrl: require('./assets/channels/addis_jobs.jpg') },
        { id: '3', name: 'Afriwork', imageUrl: require('./assets/channels/afriwork.jpg') },
        { id: '4', name: 'Dagmawi Babl Jobs', imageUrl: require('./assets/channels/dagmawi_babl_jobs.jpg') },
        { id: '5', name: 'Effoy Jobs', imageUrl: require('./assets/channels/effoy_jobs.jpg') },
        { id: '6', name: 'Ethio Jobs Vacancy', imageUrl: require('./assets/channels/ethio_jobs_vacancy.jpg') },
        { id: '7', name: 'Ethio Jobs', imageUrl: require('./assets/channels/ethio_jobs.jpg') },
        { id: '8', name: 'Ethiopian Vacancy', imageUrl: require('./assets/channels/ethiopian_vacancy.jpg') },
        { id: '9', name: 'Fana Jobs', imageUrl: require('./assets/channels/fana_jobs.jpg') },
        { id: '10', name: 'Fana Online Jobs', imageUrl: require('./assets/channels/fana_online_jobs.jpg') },
        { id: '11', name: 'Hahu Jobs', imageUrl: require('./assets/channels/hahu_jobs.jpg') },
        { id: '12', name: 'Harmee Jobs', imageUrl: require('./assets/channels/harmee_jobs.jpg') },
        { id: '13', name: 'Josad Software Jobs', imageUrl: require('./assets/channels/josad_software_jobs.jpg') },
        { id: '14', name: 'Tikus Jobs', imageUrl: require('./assets/channels/tikus_jobs.jpg') },
      ];
      setTelegramChannels(fetchedChannels);
    } catch (error) {
      console.error('Error loading telegram channels:', error);
    }
  };

  const fetchCategories = async () => {
    try {
      const categoriesQuery = collection(db, 'categories');
      const categoriesSnapshot = await getDocs(categoriesQuery);
      const fetchedCategories = categoriesSnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      // Sort manually in the client
      fetchedCategories.sort((a: any, b: any) => {
        if (a.level !== b.level) {
          return (a.level || 0) - (b.level || 0);
        }
        return (a.order || 0) - (b.order || 0);
      });
      setCategories(fetchedCategories);
    } catch (error) {
      console.error('Error fetching categories:', error);
    }
  };

  const handleLogin = () => {
    console.log('HandleLogin called, navigation:', navigation);
    try {
      // Clear any URL parameters before navigating to login
      if (typeof window !== 'undefined') {
        window.history.replaceState({}, document.title, window.location.pathname);
      }
      if (navigation && navigation.navigate) {
        navigation.navigate('Login');
      } else {
        console.error('Navigation object is not available or navigate method missing');
      }
    } catch (error) {
      console.error('Error navigating to Login:', error);
    }
  };

  const handleSearch = () => {
    // Navigate to Jobs page with search query
    if (searchText.trim()) {
      navigation.navigate('Jobs', { searchQuery: searchText });
    } else {
      navigation.navigate('Jobs');
    }
  };

  const handleGooglePlayDownload = () => {
    const playStoreUrl = 'https://play.google.com/store/apps/details?id=com.kelem.nibjobs&pcampaignid=web_share';
    if (typeof window !== 'undefined') {
      window.open(playStoreUrl, '_blank');
    }
  };

  const handleAppStoreDownload = () => {
    const appStoreUrl = 'https://apps.apple.com/app/nibjobs/id123456789'; // Replace with actual App Store ID when available
    if (typeof window !== 'undefined') {
      window.open(appStoreUrl, '_blank');
    }
  };

  const renderJobCard = ({ item: job }: any) => (
    <TouchableOpacity 
      style={dynamicStyles.jobCard} 
      activeOpacity={0.85}
      onPress={() => {
        if (user) {
          navigation.navigate('JobDetails', { id: job.id, job });
        } else {
          navigation.navigate('Signup', { 
            message: 'Please sign up to access all features and view job details. Signing up is completely free!' 
          });
        }
      }}
    >
      {/* Header with company badge */}
      <View style={styles.jobCardSimpleHeader}>
        <View style={styles.jobCompanyBadge}>
          <Icon name="business" size={16} color={colors.softBlue} />
        </View>
        {job.isRemote && (
          <View style={styles.remoteTag}>
            <Text style={styles.remoteTagText}>Remote</Text>
          </View>
        )}
      </View>
      
      {/* Job Info */}
      <View style={styles.jobCardBody}>
        <Text style={dynamicStyles.jobTitle} numberOfLines={2}>{job.title || 'Job Title'}</Text>
        <Text style={dynamicStyles.jobCompany} numberOfLines={1}>{job.company || 'Company'}</Text>
        
        <View style={styles.jobMetaContainer}>
          <View style={styles.jobMetaItem}>
            <Icon name="location-on" size={14} color={colors.warmGray} />
            <Text style={dynamicStyles.jobLocation} numberOfLines={1}>{job.location || 'Location'}</Text>
          </View>
        </View>
        
        {job.salary && (
          <View style={styles.jobSalaryContainer}>
            <Icon name="payments" size={14} color={colors.success} />
            <Text style={dynamicStyles.jobSalary} numberOfLines={1}>{job.salary}</Text>
          </View>
        )}
      </View>
      
      {/* Footer */}
      <View style={styles.jobCardSimpleFooter}>
        <Text style={dynamicStyles.jobDate}>
          {job.createdAt ? new Date(job.createdAt.seconds * 1000).toLocaleDateString() : 'Recently'}
        </Text>
        <Icon name="arrow-forward" size={16} color={colors.beeYellow} />
      </View>
    </TouchableOpacity>
  );

  const renderChannelCard = ({ item: channel }: any) => (
    <TouchableOpacity style={styles.channelCard} activeOpacity={0.9}>
      <View style={styles.channelAvatarContainer}>
        {channel.imageUrl ? (
          <Image
            source={channel.imageUrl}
            style={styles.channelAvatar}
            resizeMode="cover"
          />
        ) : (
          <View style={styles.channelAvatarPlaceholder}>
            <Icon name="telegram" size={32} color={colors.white} />
          </View>
        )}
      </View>
      
      <Text style={styles.channelName} numberOfLines={2}>
        {channel.name || channel.username || 'Channel'}
      </Text>
    </TouchableOpacity>
  );

  const formatMemberCount = (count: number) => {
    if (count >= 1000000) {
      return `${(count / 1000000).toFixed(1)}M`;
    } else if (count >= 1000) {
      return `${(count / 1000).toFixed(1)}K`;
    }
    return count.toString();
  };

  return (
    <SafeAreaView style={dynamicStyles.container}>
      {/* Modern Minimalist Header */}
      <View style={dynamicStyles.modernHeader}>
        <View style={styles.modernHeaderContent}>
          {/* Mobile Menu Button & Logo */}
          <View style={styles.modernLogoSection}>
            {isMobile && (
              <TouchableOpacity 
                style={styles.modernIconButton} 
                onPress={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
              >
                <Icon 
                  name={isMobileMenuOpen ? "close" : "menu"} 
                  size={20} 
                  color={colors.deepNavy} 
                />
              </TouchableOpacity>
            )}
            
            <TouchableOpacity style={styles.modernLogoContainer}>
              <View style={styles.modernLogoBadge}>
                <Image source={require('./assets/favicon.png')} style={styles.modernLogo} />
              </View>
            </TouchableOpacity>
            
            {!isMobile && (
              <View style={styles.modernNavigation}>
                <TouchableOpacity 
                  style={styles.modernNavItem}
                  onPress={() => navigation.navigate('Jobs')}
                >
                  <Text style={dynamicStyles.modernNavText}>Jobs</Text>
                </TouchableOpacity>
                <TouchableOpacity 
                  style={styles.modernNavItem}
                  onPress={() => navigation.navigate('Companies')}
                >
                  <Text style={dynamicStyles.modernNavText}>Companies</Text>
                </TouchableOpacity>
              </View>
            )}
          </View>

          {/* Right Actions */}
          <View style={styles.modernHeaderRight}>
            <View style={styles.modernQuickActions}>
              <TouchableOpacity 
                ref={languageButtonRef}
                style={styles.modernLanguageButton} 
                onPress={toggleLanguageDropdown}
              >
                <Text style={styles.modernLanguageText}>{getCurrentLanguage().code.toUpperCase()}</Text>
                <Icon 
                  name={isLanguageDropdownOpen ? "expand-less" : "expand-more"} 
                  size={16} 
                  color={colors.deepNavy} 
                />
              </TouchableOpacity>
            </View>

            {!isMobile && (
              <View style={styles.modernDownloadButtons}>
                <TouchableOpacity onPress={handleGooglePlayDownload}>
                  <Image source={require('./assets/google_play.png')} style={styles.modernDownloadButton} />
                </TouchableOpacity>
              </View>
            )}
            
            {!isMobile && !user && (
              <TouchableOpacity style={styles.modernSecondaryButton} onPress={handleLogin}>
                <Text style={styles.modernSecondaryButtonText}>{t.login}</Text>
              </TouchableOpacity>
            )}
            
            {!user && (
              <TouchableOpacity style={styles.modernPrimaryButton} onPress={() => navigation.navigate('Signup')}>
                <Icon name="person-add" size={18} color={colors.white} />
                <Text style={styles.modernPrimaryButtonText}>{t.signUp}</Text>
              </TouchableOpacity>
            )}
            
            {user && (
              <View style={{ flexDirection: 'row', alignItems: 'center', gap: 12 }}>
                {/* User Profile */}
                <View style={{ flexDirection: 'row', alignItems: 'center', gap: 8 }}>
                  {userData?.profilePicture ? (
                    <Image 
                      source={{ uri: userData.profilePicture }} 
                      style={{
                        width: 36,
                        height: 36,
                        borderRadius: 18,
                        borderWidth: 2,
                        borderColor: colors.beeYellow,
                      }}
                    />
                  ) : (
                    <View style={{
                      width: 36,
                      height: 36,
                      borderRadius: 18,
                      backgroundColor: colors.beeYellow,
                      alignItems: 'center',
                      justifyContent: 'center',
                    }}>
                      <Text style={{
                        fontSize: 16,
                        fontWeight: '600',
                        color: colors.deepNavy,
                      }}>
                        {(userData?.displayName || user.email || 'U')[0].toUpperCase()}
                      </Text>
                    </View>
                  )}
                  {!isMobile && (
                    <Text style={{
                      fontSize: 14,
                      fontWeight: '600',
                      color: colors.deepNavy,
                      fontFamily: 'Inter-SemiBold',
                    }}>
                      {userData?.displayName || user.email?.split('@')[0] || 'User'}
                    </Text>
                  )}
                </View>
                
                {/* Logout Button */}
                <TouchableOpacity 
                  style={{
                    paddingHorizontal: 16,
                    paddingVertical: 8,
                    borderRadius: 8,
                    borderWidth: 1,
                    borderColor: colors.danger,
                    flexDirection: 'row',
                    alignItems: 'center',
                    gap: 6,
                  }}
                  onPress={async () => {
                    await signOut(auth);
                    navigation.navigate('Home');
                  }}
                >
                  <Icon name="logout" size={18} color={colors.danger} />
                  {!isMobile && (
                    <Text style={{
                      fontSize: 14,
                      fontWeight: '600',
                      color: colors.danger,
                      fontFamily: 'Inter-SemiBold',
                    }}>
                      Logout
                    </Text>
                  )}
                </TouchableOpacity>
              </View>
            )}
          </View>
        </View>
      </View>

      {/* Mobile Menu Overlay */}
      {isMobileMenuOpen && isMobile && (
        <View style={styles.mobileMenuOverlay}>
          <TouchableOpacity 
            style={styles.mobileMenuBackdrop}
            onPress={() => setIsMobileMenuOpen(false)}
          />
          <View style={dynamicStyles.mobileMenu}>
            <View style={styles.mobileMenuHeader}>
              <Text style={dynamicStyles.mobileMenuTitle}>Menu</Text>
              <TouchableOpacity 
                style={styles.modernIconButton}
                onPress={() => setIsMobileMenuOpen(false)}
              >
                <Icon name="close" size={20} color={colors.deepNavy} />
              </TouchableOpacity>
            </View>
            
            <View style={styles.mobileMenuContent}>
              {/* Login and Signup Buttons */}
              <View style={{ paddingHorizontal: 20, paddingVertical: 8 }}>
                <TouchableOpacity 
                  style={{
                    backgroundColor: colors.beeYellow,
                    paddingVertical: 14,
                    paddingHorizontal: 20,
                    borderRadius: 12,
                    flexDirection: 'row',
                    alignItems: 'center',
                    justifyContent: 'center',
                    gap: 8,
                    marginBottom: 12,
                  }}
                  onPress={handleLogin}
                >
                  <Icon name="login" size={20} color={colors.deepNavy} />
                  <Text style={{ 
                    fontSize: 16, 
                    fontWeight: '600', 
                    color: colors.deepNavy,
                    fontFamily: 'Inter-SemiBold'
                  }}>
                    {t.login}
                  </Text>
                </TouchableOpacity>

                <TouchableOpacity 
                  style={{
                    backgroundColor: 'transparent',
                    paddingVertical: 14,
                    paddingHorizontal: 20,
                    borderRadius: 12,
                    borderWidth: 2,
                    borderColor: colors.beeYellow,
                    flexDirection: 'row',
                    alignItems: 'center',
                    justifyContent: 'center',
                    gap: 8,
                  }}
                  onPress={() => {
                    setIsMobileMenuOpen(false);
                    navigation.navigate('Signup');
                  }}
                >
                  <Icon name="person-add" size={20} color={colors.beeYellow} />
                  <Text style={{ 
                    fontSize: 16, 
                    fontWeight: '600', 
                    color: colors.beeYellow,
                    fontFamily: 'Inter-SemiBold'
                  }}>
                    {t.signUp}
                  </Text>
                </TouchableOpacity>
              </View>

              <View style={styles.mobileMenuDivider} />

              <TouchableOpacity 
                style={styles.mobileMenuItem}
                onPress={() => {
                  setIsMobileMenuOpen(false);
                  navigation.navigate('Jobs');
                }}
              >
                <Icon name="work" size={20} color={colors.beeYellow} />
                <Text style={dynamicStyles.mobileMenuItemText}>Jobs</Text>
              </TouchableOpacity>
              
              <TouchableOpacity 
                style={styles.mobileMenuItem}
                onPress={() => {
                  setIsMobileMenuOpen(false);
                  navigation.navigate('Companies');
                }}
              >
                <Icon name="business" size={20} color={colors.beeYellow} />
                <Text style={dynamicStyles.mobileMenuItemText}>Companies</Text>
              </TouchableOpacity>
              
              <TouchableOpacity style={styles.mobileMenuItem}>
                <Icon name="business" size={20} color={colors.beeYellow} />
                <Text style={dynamicStyles.mobileMenuItemText}>Companies</Text>
              </TouchableOpacity>
              
              <TouchableOpacity style={styles.mobileMenuItem}>
                <Icon name="telegram" size={20} color={colors.beeYellow} />
                <Text style={dynamicStyles.mobileMenuItemText}>Channels</Text>
              </TouchableOpacity>
              
              <View style={styles.mobileMenuDivider} />
              
              <View style={styles.mobileMenuDownloads}>
                <Text style={dynamicStyles.mobileMenuSectionTitle}>Download App</Text>
                <TouchableOpacity onPress={handleGooglePlayDownload} style={styles.mobileMenuDownloadItem}>
                  <Image source={require('./assets/google_play.png')} style={styles.mobileDownloadButton} />
                </TouchableOpacity>
              </View>
            </View>
          </View>
        </View>
      )}

      {/* Full-screen language dropdown overlay - positioned outside toolbar for maximum z-index */}
      {isLanguageDropdownOpen && (
        <View style={styles.fullScreenDropdownOverlay}>
          {/* Invisible touch area to close dropdown */}
          <TouchableOpacity 
            style={styles.fullScreenTouchArea}
            onPress={() => setIsLanguageDropdownOpen(false)}
            activeOpacity={1}
          />
          
          {/* Language dropdown positioned absolutely */}
          <View style={[styles.absoluteLanguageDropdown, { top: dropdownPosition.top, right: dropdownPosition.right }]}>
            {languageOptions.map((language, index) => (
              <TouchableOpacity
                key={language.code}
                style={[
                  styles.languageOption,
                  currentLanguage === language.code && styles.languageOptionActive,
                  index === languageOptions.length - 1 && { borderBottomWidth: 0 }
                ]}
                onPress={() => changeLanguage(language.code)}
              >
                <Text style={styles.languageLabel}>{language.label}</Text>
                {currentLanguage === language.code && (
                  <Icon name="check" size={16} color={colors.beeYellow} />
                )}
              </TouchableOpacity>
            ))}
          </View>
        </View>
      )}

      <View style={styles.mainContent}>
        <ScrollView 
          style={dynamicStyles.leftContent}
          showsVerticalScrollIndicator={true}
        >
          {/* Hero Section */}
          <View style={dynamicStyles.heroSection}>
            <View style={styles.heroContent}>
              <View style={styles.heroTextSection}>
                <Text style={dynamicStyles.heroTitle}>Find Your Dream Job</Text>
                <Text style={dynamicStyles.heroSubtitle}>
                  Discover amazing opportunities from top companies in Ethiopia
                </Text>
                
                {/* Modern Search Bar */}
                <View style={dynamicStyles.modernSearchContainer}>
                  <Icon name="search" size={24} color={colors.warmGray} />
                  <TextInput
                    style={dynamicStyles.modernSearchInput}
                    placeholder="Search jobs"
                    value={searchText}
                    onChangeText={setSearchText}
                    onSubmitEditing={handleSearch}
                  />
                  <TouchableOpacity style={styles.modernSearchButton} onPress={handleSearch}>
                    <Icon name="arrow-forward" size={20} color={colors.white} />
                  </TouchableOpacity>
                </View>
                
                {/* Quick Stats */}
                <View style={styles.heroStats}>
                  <View style={styles.heroStat}>
                    <Text style={dynamicStyles.heroStatNumber}>1000+</Text>
                    <Text style={dynamicStyles.heroStatLabel}>Jobs Available</Text>
                  </View>
                  <View style={styles.heroStat}>
                    <Text style={dynamicStyles.heroStatNumber}>{telegramChannels.length}+</Text>
                    <Text style={dynamicStyles.heroStatLabel}>Job Channels</Text>
                  </View>
                  <View style={styles.heroStat}>
                    <Text style={dynamicStyles.heroStatNumber}>1000+</Text>
                    <Text style={dynamicStyles.heroStatLabel}>Companies</Text>
                  </View>
                </View>
                
                {/* Download App Button */}
                <TouchableOpacity 
                  onPress={handleGooglePlayDownload} 
                  activeOpacity={0.8}
                  style={{ 
                    marginTop: 24,
                    alignSelf: 'flex-start',
                    padding: 0,
                  }}
                >
                  <Image 
                    source={require('./assets/google_play.png')} 
                    style={{
                      height: isMobile ? 72 : 66,
                      width: isMobile ? 216 : 198,
                      resizeMode: 'cover',
                      alignSelf: 'flex-start',
                    }} 
                  />
                </TouchableOpacity>
              </View>
              
              {!isMobile && (
                <View style={styles.heroImageSection}>
                  <Image 
                    source={require('./assets/mascot.png')} 
                    style={styles.heroMascotImage}
                    resizeMode="contain"
                  />
                </View>
              )}
            </View>
          </View>

          {/* Telegram Channels Horizontal Scroll */}
          <View style={styles.channelsSectionWrapper}>
            <View style={dynamicStyles.channelsSection}>
              <View style={styles.sectionHeader}>
                <Text style={dynamicStyles.sectionTitle}>{t.exploreChannels}</Text>
                <Text style={dynamicStyles.sectionSubtitle}>
                  Aggregating jobs from multiple sources and presenting them to you in one place
                </Text>
              </View>
              <View style={styles.channelsContainer}>
                <ScrollView 
                  ref={channelScrollViewRef}
                  horizontal 
                  showsHorizontalScrollIndicator={false} 
                  style={styles.channelsScroll}
                  contentContainerStyle={styles.channelsScrollContainer}
                  scrollEventThrottle={16}
                >
                  {/* Duplicate channels for infinite scroll effect */}
                  {[...telegramChannels, ...telegramChannels].map((channel, index) => (
                    <View key={`${channel.id || 'ch'}-${index}`} style={styles.channelCardWrapper}>
                      {renderChannelCard({ item: channel })}
                    </View>
                  ))}
                </ScrollView>
              </View>
            </View>
          </View>

          {/* About Us Section */}
          <View style={styles.aboutSection}>
            <View style={styles.sectionHeader}>
              <Text style={dynamicStyles.sectionTitle}>About NibJobs</Text>
              <Text style={dynamicStyles.sectionSubtitle}>
                Connecting Ethiopia's Talent with Opportunities
              </Text>
            </View>
            
            <View style={styles.aboutContent}>
              <View style={styles.aboutTextContainer}>
                <Text style={dynamicStyles.aboutText}>
                  NibJobs is Ethiopia's premier job portal, dedicated to bridging the gap between talented professionals and exciting career opportunities across the nation. We understand the unique challenges of the Ethiopian job market and provide innovative solutions to help both job seekers and employers succeed.
                </Text>
                
                <View style={styles.aboutFeatures}>
                  <View style={styles.aboutFeature}>
                    <View style={styles.aboutFeatureIconContainer1}>
                      <Icon name="business" size={28} color="#fff" />
                    </View>
                    <View style={styles.aboutFeatureText}>
                      <Text style={dynamicStyles.aboutFeatureTitle}>Top Companies</Text>
                      <Text style={dynamicStyles.aboutFeatureDescription}>
                        Connect with leading employers across various industries
                      </Text>
                    </View>
                  </View>
                  
                  <View style={styles.aboutFeature}>
                    <View style={styles.aboutFeatureIconContainer2}>
                      <Icon name="notifications-active" size={28} color="#fff" />
                    </View>
                    <View style={styles.aboutFeatureText}>
                      <Text style={dynamicStyles.aboutFeatureTitle}>Instant Alerts</Text>
                      <Text style={dynamicStyles.aboutFeatureDescription}>
                        Get notified immediately when relevant jobs are posted
                      </Text>
                    </View>
                  </View>
                  
                  <View style={styles.aboutFeature}>
                    <View style={styles.aboutFeatureIconContainer3}>
                      <Icon name="language" size={28} color="#fff" />
                    </View>
                    <View style={styles.aboutFeatureText}>
                      <Text style={dynamicStyles.aboutFeatureTitle}>Multilingual Support</Text>
                      <Text style={dynamicStyles.aboutFeatureDescription}>
                        Available in English, Amharic, Tigrinya, and Oromiffa
                      </Text>
                    </View>
                  </View>
                </View>
              </View>
            </View>
          </View>

          {/* Jobs Section with Popular Filters */}
          <View style={dynamicStyles.jobsSection}>
            <View style={styles.jobsSectionHeader}>
              <Text style={dynamicStyles.sectionTitle}>{t.recentJobs}</Text>
            </View>
            
            {/* Jobs Grid */}
            <View style={styles.jobsGridContainer}>
              {loading ? (
                <View style={styles.loadingContainer}>
                  <ActivityIndicator size="large" color={colors.beeYellow} />
                  <Text style={styles.loadingText}>Loading jobs...</Text>
                </View>
              ) : (
                <FlatList
                  data={jobs.slice(0, 9)}
                  renderItem={renderJobCard}
                  keyExtractor={(item) => item.id}
                  numColumns={isMobile ? 1 : 3}
                  key={isMobile ? 'one-column' : 'three-columns'}
                  showsVerticalScrollIndicator={false}
                  contentContainerStyle={styles.jobsGrid}
                  scrollEnabled={false}
                  columnWrapperStyle={!isMobile ? styles.jobsGridRow : null}
                />
              )}
            </View>
            
            {/* Login and View More Jobs Button */}
            <View style={styles.viewMoreContainer}>
              <TouchableOpacity 
                style={styles.viewMoreButton}
                onPress={() => {
                  if (user) {
                    navigation.navigate('Jobs');
                  } else {
                    navigation.navigate('Signup', { 
                      message: 'Please sign up to access all features and browse all jobs. Signing up is completely free!' 
                    });
                  }
                }}
              >
                <Text style={styles.viewMoreButtonText}>{user ? 'View All Jobs' : 'Login and View More Jobs'}</Text>
                <Icon name="arrow-forward" size={20} color={colors.white} />
              </TouchableOpacity>
            </View>
          </View>

          {/* Pricing Section */}
          <View style={styles.pricingSection}>
            <View style={styles.sectionHeader}>
              <Text style={dynamicStyles.sectionTitle}>Choose Your Plan</Text>
              <Text style={dynamicStyles.sectionSubtitle}>
                Select the perfect plan for your needs
              </Text>
            </View>
            
            <View style={styles.pricingGrid}>
              {SUBSCRIPTION_PLANS.map((plan) => (
                <View 
                  key={plan.id}
                  style={[
                    styles.pricingCard,
                    plan.popular && styles.pricingCardPopular
                  ]}
                >
                  {plan.popular && (
                    <View style={styles.pricingBadge}>
                      <Text style={styles.pricingBadgeText}>POPULAR</Text>
                    </View>
                  )}
                  
                  <View style={styles.pricingHeader}>
                    <Icon 
                      name={plan.icon} 
                      size={40} 
                      color={plan.color} 
                      style={styles.pricingIcon} 
                    />
                    <Text style={dynamicStyles.pricingTierName}>{plan.name}</Text>
                    <Text style={dynamicStyles.pricingPrice}>{plan.priceMonthly} br</Text>
                    <Text style={dynamicStyles.pricingPeriod}>per month</Text>
                  </View>
                  
                  <View style={styles.pricingFeatures}>
                    {plan.features.map((feature, index) => (
                      <View 
                        key={index}
                        style={[
                          styles.pricingFeature,
                          !feature.enabled && styles.pricingFeatureDisabled
                        ]}
                      >
                        <Icon 
                          name={feature.enabled ? "check-circle" : "cancel"} 
                          size={20} 
                          color={feature.enabled ? colors.success : colors.danger} 
                        />
                        <Text style={dynamicStyles.pricingFeatureText}>
                          {feature.text}
                        </Text>
                      </View>
                    ))}
                  </View>
                  
                  <TouchableOpacity 
                    style={[
                      styles.pricingButton,
                      !plan.popular && styles.pricingButtonOutline
                    ]}
                  >
                    <Text 
                      style={[
                        styles.pricingButtonText,
                        !plan.popular && styles.pricingButtonOutlineText
                      ]}
                    >
                      {plan.buttonText}
                    </Text>
                  </TouchableOpacity>
                </View>
              ))}
            </View>
          </View>

          {/* Footer Section */}
          <View style={styles.footerSection}>
            <View style={styles.footerContent}>
              {/* Footer Top */}
              <View style={styles.footerTop}>
                {/* Company Info */}
                <View style={styles.footerColumn}>
                  <View style={styles.footerLogoSection}>
                    <Image source={require('./assets/favicon.png')} style={styles.footerLogo} />
                    <Text style={styles.footerBrandName}>NibJobs</Text>
                  </View>
                  <Text style={styles.footerDescription}>
                    Ethiopia's premier job portal connecting talented professionals with exciting career opportunities.
                  </Text>
                  <View style={styles.footerSocial}>
                    <TouchableOpacity 
                      style={styles.footerSocialButton}
                      onPress={() => Linking.openURL('https://www.facebook.com/nibjobs')}
                    >
                      <Icon name="facebook" size={20} color={colors.white} />
                    </TouchableOpacity>
                    <TouchableOpacity 
                      style={styles.footerSocialButton}
                      onPress={() => Linking.openURL('https://www.youtube.com/@kelem510')}
                    >
                      <Icon name="youtube" size={20} color={colors.white} />
                    </TouchableOpacity>
                  </View>
                  
                  {/* Download App Button */}
                  <TouchableOpacity 
                    onPress={handleGooglePlayDownload} 
                    activeOpacity={0.8}
                    style={{ 
                      marginTop: 20,
                    }}
                  >
                    <Image 
                      source={require('./assets/google_play.png')} 
                      style={{
                        height: 50,
                        width: 150,
                        resizeMode: 'contain',
                      }} 
                    />
                  </TouchableOpacity>
                </View>

                {/* Quick Links */}
                <View style={styles.footerColumn}>
                  <Text style={styles.footerColumnTitle}>For Job Seekers</Text>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => {
                      if (user) {
                        navigation.navigate('Jobs');
                      } else {
                        navigation.navigate('Signup', { 
                          message: 'Please sign up to access all features and browse all jobs. Signing up is completely free!' 
                        });
                      }
                    }}
                  >
                    <Text style={styles.footerLinkText}>Browse Jobs</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('JobAlerts')}
                  >
                    <Text style={styles.footerLinkText}>Job Alerts</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('CareerAdvice')}
                  >
                    <Text style={styles.footerLinkText}>Career Advice</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('ResumeTips')}
                  >
                    <Text style={styles.footerLinkText}>Resume Tips</Text>
                  </TouchableOpacity>
                </View>

                {/* Employers */}
                <View style={styles.footerColumn}>
                  <Text style={styles.footerColumnTitle}>For Employers</Text>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={handleLogin}
                  >
                    <Text style={styles.footerLinkText}>Post a Job</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => {
                      // Scroll to pricing section
                      navigation.navigate('Home');
                    }}
                  >
                    <Text style={styles.footerLinkText}>Pricing Plans</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={handleLogin}
                  >
                    <Text style={styles.footerLinkText}>Employer Dashboard</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('RecruitmentTips')}
                  >
                    <Text style={styles.footerLinkText}>Recruitment Tips</Text>
                  </TouchableOpacity>
                </View>

                {/* Company */}
                <View style={styles.footerColumn}>
                  <Text style={styles.footerColumnTitle}>Company</Text>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('Home')}
                  >
                    <Text style={styles.footerLinkText}>About Us</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={handleLogin}
                  >
                    <Text style={styles.footerLinkText}>Contact</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('Privacy')}
                  >
                    <Text style={styles.footerLinkText}>Privacy Policy</Text>
                  </TouchableOpacity>
                  <TouchableOpacity 
                    style={styles.footerLink}
                    onPress={() => navigation.navigate('Privacy')}
                  >
                    <Text style={styles.footerLinkText}>Terms of Service</Text>
                  </TouchableOpacity>
                </View>
              </View>

              {/* Footer Bottom */}
              <View style={styles.footerBottom}>
                <Text style={styles.footerCopyright}>
                  Â© {new Date().getFullYear()} NibJobs. All rights reserved.
                </Text>
                <View style={styles.footerBottomLinks}>
                  <TouchableOpacity onPress={() => navigation.navigate('Privacy')}>
                    <Text style={styles.footerBottomLinkText}>Privacy</Text>
                  </TouchableOpacity>
                  <Text style={styles.footerDivider}>â€¢</Text>
                  <TouchableOpacity onPress={() => navigation.navigate('Privacy')}>
                    <Text style={styles.footerBottomLinkText}>Terms</Text>
                  </TouchableOpacity>
                  <Text style={styles.footerDivider}>â€¢</Text>
                  <TouchableOpacity onPress={() => navigation.navigate('Privacy')}>
                    <Text style={styles.footerBottomLinkText}>Cookies</Text>
                  </TouchableOpacity>
                </View>
              </View>
            </View>
          </View>
        </ScrollView>
      </View>
    </SafeAreaView>
  );
}

// Privacy Policy Screen
function PrivacyPolicyScreen({ navigation }: any) {
  return (
    <SafeAreaView style={styles.container}>
      <ScrollView style={styles.contentPage}>
        <View style={styles.contentPageHeader}>
          <TouchableOpacity 
            style={styles.contentPageBackButton}
            onPress={() => navigation.goBack()}
          >
            <Icon name="arrow-back" size={24} color={lightColors.deepNavy} />
          </TouchableOpacity>
          <Text style={styles.contentPageTitle}>Privacy Policy</Text>
        </View>
        
        <View style={styles.contentPageBody}>
          <Text style={styles.contentPageLastUpdated}>Last updated: {new Date().toLocaleDateString()}</Text>
          
          <Text style={styles.contentPageSection}>1. Information We Collect</Text>
          <Text style={styles.contentPageText}>
            We collect information you provide directly to us, including your name, email address, phone number, resume, and job preferences when you create an account or apply for jobs through NibJobs.
          </Text>
          
          <Text style={styles.contentPageSection}>2. How We Use Your Information</Text>
          <Text style={styles.contentPageText}>
            We use the information we collect to provide, maintain, and improve our services, including matching you with relevant job opportunities, sending job alerts, and communicating with you about our services.
          </Text>
          
          <Text style={styles.contentPageSection}>3. Information Sharing</Text>
          <Text style={styles.contentPageText}>
            We share your information with employers when you apply for jobs. We do not sell your personal information to third parties. We may share anonymized data for analytics purposes.
          </Text>
          
          <Text style={styles.contentPageSection}>4. Data Security</Text>
          <Text style={styles.contentPageText}>
            We implement appropriate security measures to protect your personal information from unauthorized access, alteration, or destruction. However, no method of transmission over the internet is 100% secure.
          </Text>
          
          <Text style={styles.contentPageSection}>5. Your Rights</Text>
          <Text style={styles.contentPageText}>
            You have the right to access, update, or delete your personal information at any time. You can also opt out of job alerts and marketing communications.
          </Text>
          
          <Text style={styles.contentPageSection}>6. Contact Us</Text>
          <Text style={styles.contentPageText}>
            If you have any questions about this Privacy Policy, please contact us at privacy@nibjobs.com
          </Text>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Job Alerts Screen
function JobAlertsScreen({ navigation }: any) {
  return (
    <SafeAreaView style={styles.container}>
      <ScrollView style={styles.contentPage}>
        <View style={styles.contentPageHeader}>
          <TouchableOpacity 
            style={styles.contentPageBackButton}
            onPress={() => navigation.goBack()}
          >
            <Icon name="arrow-back" size={24} color={lightColors.deepNavy} />
          </TouchableOpacity>
          <Text style={styles.contentPageTitle}>Job Alerts</Text>
        </View>
        
        <View style={styles.contentPageBody}>
          <View style={styles.featureHeroSection}>
            <Icon name="notifications-active" size={64} color={lightColors.beeYellow} />
            <Text style={styles.featureHeroTitle}>Never Miss a Job Opportunity</Text>
            <Text style={styles.featureHeroSubtitle}>
              Get instant notifications when jobs matching your preferences are posted
            </Text>
          </View>
          
          <Text style={styles.contentPageSection}>How Job Alerts Work</Text>
          <Text style={styles.contentPageText}>
            Set up personalized job alerts based on your skills, experience, and career interests. We'll notify you immediately when relevant opportunities are posted.
          </Text>
          
          <Text style={styles.contentPageSection}>Alert Preferences</Text>
          <Text style={styles.contentPageText}>
            â€¢ Choose your preferred job categories{'\n'}
            â€¢ Set location preferences{'\n'}
            â€¢ Filter by salary range{'\n'}
            â€¢ Select notification frequency (instant, daily, or weekly){'\n'}
            â€¢ Customize alert channels (email, SMS, push notifications)
          </Text>
          
          <Text style={styles.contentPageSection}>Stay Ahead of the Competition</Text>
          <Text style={styles.contentPageText}>
            Be the first to know about new opportunities. Job alerts give you a competitive advantage by notifying you as soon as jobs are posted, allowing you to apply early.
          </Text>
          
          <TouchableOpacity 
            style={styles.contentPageCTA}
            onPress={() => navigation.navigate('Signup')}
          >
            <Text style={styles.contentPageCTAText}>Sign Up for Job Alerts</Text>
            <Icon name="arrow-forward" size={20} color={lightColors.white} />
          </TouchableOpacity>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Career Advice Screen
function CareerAdviceScreen({ navigation }: any) {
  return (
    <SafeAreaView style={styles.container}>
      <ScrollView style={styles.contentPage}>
        <View style={styles.contentPageHeader}>
          <TouchableOpacity 
            style={styles.contentPageBackButton}
            onPress={() => navigation.goBack()}
          >
            <Icon name="arrow-back" size={24} color={lightColors.deepNavy} />
          </TouchableOpacity>
          <Text style={styles.contentPageTitle}>Career Advice</Text>
        </View>
        
        <View style={styles.contentPageBody}>
          <View style={styles.featureHeroSection}>
            <Icon name="school" size={64} color={lightColors.beeYellow} />
            <Text style={styles.featureHeroTitle}>Advance Your Career</Text>
            <Text style={styles.featureHeroSubtitle}>
              Expert guidance to help you navigate your professional journey
            </Text>
          </View>
          
          <Text style={styles.contentPageSection}>Interview Preparation</Text>
          <Text style={styles.contentPageText}>
            Master the art of interviewing with our comprehensive guides. Learn how to answer common questions, prepare for technical interviews, and make a lasting impression on potential employers.
          </Text>
          
          <Text style={styles.contentPageSection}>Career Development</Text>
          <Text style={styles.contentPageText}>
            Discover strategies for professional growth, skill development, and career advancement. Learn how to set career goals, build your professional network, and identify growth opportunities.
          </Text>
          
          <Text style={styles.contentPageSection}>Salary Negotiation</Text>
          <Text style={styles.contentPageText}>
            Understand your market value and learn effective negotiation techniques. Get insights on salary ranges for different roles and industries in Ethiopia's job market.
          </Text>
          
          <Text style={styles.contentPageSection}>Work-Life Balance</Text>
          <Text style={styles.contentPageText}>
            Maintain a healthy balance between professional ambitions and personal well-being. Discover tips for managing stress, setting boundaries, and achieving career satisfaction.
          </Text>
          
          <TouchableOpacity 
            style={styles.contentPageCTA}
            onPress={() => navigation.navigate('Signup')}
          >
            <Text style={styles.contentPageCTAText}>Join NibJobs Today</Text>
            <Icon name="arrow-forward" size={20} color={lightColors.white} />
          </TouchableOpacity>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Resume Tips Screen
function ResumeTipsScreen({ navigation }: any) {
  return (
    <SafeAreaView style={styles.container}>
      <ScrollView style={styles.contentPage}>
        <View style={styles.contentPageHeader}>
          <TouchableOpacity 
            style={styles.contentPageBackButton}
            onPress={() => navigation.goBack()}
          >
            <Icon name="arrow-back" size={24} color={lightColors.deepNavy} />
          </TouchableOpacity>
          <Text style={styles.contentPageTitle}>Resume Tips</Text>
        </View>
        
        <View style={styles.contentPageBody}>
          <View style={styles.featureHeroSection}>
            <Icon name="description" size={64} color={lightColors.beeYellow} />
            <Text style={styles.featureHeroTitle}>Create a Standout Resume</Text>
            <Text style={styles.featureHeroSubtitle}>
              Professional guidance for crafting resumes that get noticed
            </Text>
          </View>
          
          <Text style={styles.contentPageSection}>Resume Formatting</Text>
          <Text style={styles.contentPageText}>
            â€¢ Use a clean, professional layout{'\n'}
            â€¢ Keep it concise (1-2 pages maximum){'\n'}
            â€¢ Use consistent formatting and fonts{'\n'}
            â€¢ Include proper contact information{'\n'}
            â€¢ Save as PDF for universal compatibility
          </Text>
          
          <Text style={styles.contentPageSection}>Key Sections to Include</Text>
          <Text style={styles.contentPageText}>
            Professional Summary: A brief overview of your experience and career objectives{'\n\n'}
            Work Experience: List relevant positions with measurable achievements{'\n\n'}
            Education: Include degrees, certifications, and relevant coursework{'\n\n'}
            Skills: Highlight both technical and soft skills{'\n\n'}
            Achievements: Showcase awards, recognitions, and notable accomplishments
          </Text>
          
          <Text style={styles.contentPageSection}>Writing Tips</Text>
          <Text style={styles.contentPageText}>
            â€¢ Use action verbs (achieved, managed, developed, led){'\n'}
            â€¢ Quantify achievements with numbers and metrics{'\n'}
            â€¢ Tailor your resume for each job application{'\n'}
            â€¢ Proofread carefully for errors{'\n'}
            â€¢ Keep language professional and concise
          </Text>
          
          <Text style={styles.contentPageSection}>Common Mistakes to Avoid</Text>
          <Text style={styles.contentPageText}>
            âœ— Including irrelevant personal information{'\n'}
            âœ— Using unprofessional email addresses{'\n'}
            âœ— Listing duties instead of achievements{'\n'}
            âœ— Having spelling or grammatical errors{'\n'}
            âœ— Using generic, one-size-fits-all resumes
          </Text>
          
          <TouchableOpacity 
            style={styles.contentPageCTA}
            onPress={() => navigation.navigate('Signup')}
          >
            <Text style={styles.contentPageCTAText}>Upload Your Resume</Text>
            <Icon name="arrow-forward" size={20} color={lightColors.white} />
          </TouchableOpacity>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// Recruitment Tips Screen
function RecruitmentTipsScreen({ navigation }: any) {
  return (
    <SafeAreaView style={styles.container}>
      <ScrollView style={styles.contentPage}>
        <View style={styles.contentPageHeader}>
          <TouchableOpacity 
            style={styles.contentPageBackButton}
            onPress={() => navigation.goBack()}
          >
            <Icon name="arrow-back" size={24} color={lightColors.deepNavy} />
          </TouchableOpacity>
          <Text style={styles.contentPageTitle}>Recruitment Tips</Text>
        </View>
        
        <View style={styles.contentPageBody}>
          <View style={styles.featureHeroSection}>
            <Icon name="business-center" size={64} color={lightColors.beeYellow} />
            <Text style={styles.featureHeroTitle}>Hire Top Talent</Text>
            <Text style={styles.featureHeroSubtitle}>
              Best practices for attracting and recruiting exceptional candidates
            </Text>
          </View>
          
          <Text style={styles.contentPageSection}>Writing Effective Job Posts</Text>
          <Text style={styles.contentPageText}>
            â€¢ Use clear, descriptive job titles{'\n'}
            â€¢ Provide detailed role responsibilities{'\n'}
            â€¢ List required and preferred qualifications{'\n'}
            â€¢ Include salary range and benefits{'\n'}
            â€¢ Highlight company culture and values{'\n'}
            â€¢ Add a clear call-to-action
          </Text>
          
          <Text style={styles.contentPageSection}>Screening Candidates</Text>
          <Text style={styles.contentPageText}>
            Develop a systematic screening process to identify the most qualified candidates. Review resumes for relevant experience, skills, and cultural fit. Use phone screens to assess communication skills and basic qualifications before scheduling full interviews.
          </Text>
          
          <Text style={styles.contentPageSection}>Interview Best Practices</Text>
          <Text style={styles.contentPageText}>
            â€¢ Prepare structured interview questions{'\n'}
            â€¢ Use behavioral and situational questions{'\n'}
            â€¢ Allow candidates to ask questions{'\n'}
            â€¢ Take detailed notes{'\n'}
            â€¢ Involve multiple team members{'\n'}
            â€¢ Provide timely feedback to candidates
          </Text>
          
          <Text style={styles.contentPageSection}>Building Your Employer Brand</Text>
          <Text style={styles.contentPageText}>
            Showcase your company culture, values, and employee benefits. Maintain an active presence on job platforms, share employee testimonials, and highlight career development opportunities. A strong employer brand attracts higher quality candidates.
          </Text>
          
          <Text style={styles.contentPageSection}>Diversity and Inclusion</Text>
          <Text style={styles.contentPageText}>
            Implement inclusive hiring practices to build diverse teams. Use gender-neutral language in job posts, establish diverse interview panels, and eliminate bias from your recruitment process.
          </Text>
          
          <TouchableOpacity 
            style={styles.contentPageCTA}
            onPress={() => navigation.navigate('Signup')}
          >
            <Text style={styles.contentPageCTAText}>Start Recruiting</Text>
            <Icon name="arrow-forward" size={20} color={lightColors.white} />
          </TouchableOpacity>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
}

// 404 Not Found Screen
function NotFoundScreen({ navigation }: any) {
  return (
    <SafeAreaView style={styles.container}>
      <View style={styles.notFoundContainer}>
        <Image 
          source={require('./assets/mascot_2.jpeg')} 
          style={styles.notFoundImage}
          resizeMode="contain"
        />
        <Text style={styles.notFoundTitle}>404 - Page Not Found</Text>
        <Text style={styles.notFoundSubtitle}>
          Oops! The page you're looking for doesn't exist.
        </Text>
        
        <View style={styles.notFoundButtonsContainer}>
          <TouchableOpacity 
            style={styles.notFoundPrimaryButton}
            onPress={() => navigation.navigate('Home')}
          >
            <Icon name="home" size={20} color={lightColors.white} />
            <Text style={styles.notFoundPrimaryButtonText}>Go to Home</Text>
          </TouchableOpacity>
          
          <TouchableOpacity 
            style={styles.notFoundSecondaryButton}
            onPress={() => navigation.navigate('Login')}
          >
            <Icon name="login" size={20} color={lightColors.deepNavy} />
            <Text style={styles.notFoundSecondaryButtonText}>Login</Text>
          </TouchableOpacity>
        </View>
      </View>
    </SafeAreaView>
  );
}

export default function App() {
  const [initializing, setInitializing] = useState(true);
  const [user, setUser] = useState<any>(null);
  const [isDarkMode, setIsDarkMode] = useState(false);
  const [themeLoaded, setThemeLoaded] = useState(false);
  const fontsLoaded = useAppFonts();

  // Load theme preference on mount
  useEffect(() => {
    loadThemePreference();
  }, []);

  const loadThemePreference = async () => {
    try {
      const savedTheme = await AsyncStorage.getItem('isDarkMode');
      if (savedTheme !== null) {
        setIsDarkMode(savedTheme === 'true');
      }
    } catch (error) {
      console.error('Error loading theme preference:', error);
    } finally {
      setThemeLoaded(true);
    }
  };

  const toggleTheme = async () => {
    try {
      const newTheme = !isDarkMode;
      setIsDarkMode(newTheme);
      await AsyncStorage.setItem('isDarkMode', String(newTheme));
    } catch (error) {
      console.error('Error saving theme preference:', error);
    }
  };

  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, (authUser) => {
      setUser(authUser);
      if (initializing) setInitializing(false);
    });
    return unsubscribe;
  }, [initializing]);

  // Get current theme colors
  const colors = isDarkMode ? darkColors : lightColors;

  if (initializing || !fontsLoaded || !themeLoaded) {
    return (
      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: lightColors.beeYellow }}>
        <ActivityIndicator size="large" color="#F4C430" />
        <Text style={[styles.loadingSubtext, { marginTop: 16 }]}>Loading...</Text>
      </View>
    );
  }

  const linking = {
    prefixes: ['http://localhost:19006', 'nibjobs://'],
    config: {
      screens: {
        Home: '',
        Login: 'login',
        Signup: 'signup',
        VerificationRequired: 'verification-required',
        ForgotPassword: 'forgot-password',
        Jobs: 'jobs',
        Companies: 'companies',
        Bookmarks: 'bookmarks',
        Settings: 'settings',
        SettingsProfile: 'settings/profile',
        SettingsAppearance: 'settings/appearance',
        SettingsLanguage: 'settings/language',
        SettingsInterests: 'settings/interests',
        SettingsSubscription: 'settings/subscription',
        JobDetails: 'job/:id',
        AdminPanel: 'admin',
        Privacy: 'privacy',
        JobAlerts: 'job-alerts',
        CareerAdvice: 'career-advice',
        ResumeTips: 'resume-tips',
        RecruitmentTips: 'recruitment-tips',
        NotFound: '*',
      },
    },
  };

  return (
    <NavigationContainer linking={linking}>
      <Stack.Navigator screenOptions={{ headerShown: false }}>
        <Stack.Screen name="Home" component={HomeScreen} />
        <Stack.Screen name="Login">
          {(props) => <LoginScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="Signup">
          {(props) => <SignupScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="VerificationRequired">
          {(props) => <VerificationRequiredScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="ForgotPassword">
          {(props) => <ForgotPasswordScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="Jobs">
          {(props) => <JobsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="Companies">
          {(props) => <CompaniesScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="Bookmarks">
          {(props) => <BookmarksScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="Settings">
          {(props) => <SettingsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="SettingsProfile">
          {(props) => <SettingsProfileScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="SettingsAppearance">
          {(props) => <SettingsAppearanceScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="SettingsLanguage">
          {(props) => <SettingsLanguageScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="SettingsInterests">
          {(props) => <SettingsInterestsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="SettingsSubscription">
          {(props) => <SettingsSubscriptionScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="JobDetails">
          {(props) => <JobDetailsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="AdminPanel">
          {(props) => <AdminPanelScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="Privacy">
          {(props) => <PrivacyPolicyScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="JobAlerts">
          {(props) => <JobAlertsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="CareerAdvice">
          {(props) => <CareerAdviceScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="ResumeTips">
          {(props) => <ResumeTipsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="RecruitmentTips">
          {(props) => <RecruitmentTipsScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
        <Stack.Screen name="NotFound">
          {(props) => <NotFoundScreen {...props} isDarkMode={isDarkMode} toggleTheme={toggleTheme} colors={colors} />}
        </Stack.Screen>
      </Stack.Navigator>
    </NavigationContainer>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: lightColors.white,
  },
  loadingContainer: {
    flex: 1,
    width: '100%',
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: lightColors.beeYellow,
  },
  loadingText: {
    fontSize: 32,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 10,
  },
  loadingSubtext: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  loginContainer: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    padding: 40,
    backgroundColor: lightColors.white,
  },
  loginHeader: {
    alignItems: 'center',
    marginBottom: 40,
  },
  loginLogo: {
    fontSize: 60,
    marginBottom: 16,
  },
  loginTitle: {
    fontSize: 32,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 8,
  },
  loginSubtitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  verificationMessageContainer: {
    alignItems: 'center',
    paddingVertical: 40,
  },
  verificationTitle: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 16,
    textAlign: 'center',
  },
  verificationMessage: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginBottom: 12,
    lineHeight: 24,
  },
  verificationEmail: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.beeYellow,
    marginBottom: 20,
    textAlign: 'center',
  },
  successMessageContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#e8f5e9',
    padding: 16,
    borderRadius: 12,
    marginTop: 20,
    marginBottom: 20,
  },
  successMessageText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.success,
    flex: 1,
  },
  buttonDisabled: {
    opacity: 0.6,
  },
  modalOverlay: {
    flex: 1,
    backgroundColor: 'rgba(0, 0, 0, 0.5)',
    justifyContent: 'center',
    alignItems: 'center',
    padding: 20,
  },
  modalContent: {
    backgroundColor: lightColors.white,
    borderRadius: 16,
    padding: 24,
    width: '100%',
    maxWidth: 400,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.25,
    shadowRadius: 4,
    elevation: 5,
  },
  modalTitle: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 8,
    textAlign: 'center',
  },
  modalDescription: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 24,
    textAlign: 'center',
    lineHeight: 20,
  },
  modalButtons: {
    flexDirection: 'row',
    marginTop: 16,
  },
  loginForm: {
    width: '100%',
    maxWidth: 400,
  },
  inputGroup: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.lightGray,
    borderRadius: 12,
    paddingHorizontal: 16,
    paddingVertical: 4,
    borderWidth: 2,
    borderColor: 'transparent',
  },
  inputError: {
    borderColor: lightColors.danger,
    backgroundColor: '#fef2f2',
  },
  errorText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.danger,
    marginTop: 8,
    marginBottom: 8,
  },
  inputIcon: {
    marginRight: 12,
  },
  modernInput: {
    flex: 1,
    height: 50,
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  modernLoginButton: {
    backgroundColor: lightColors.beeYellow,
    height: 56,
    borderRadius: 12,
    justifyContent: 'center',
    alignItems: 'center',
    marginTop: 24,
    paddingHorizontal: 24,
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  loginButtonDisabled: {
    backgroundColor: lightColors.warmGray,
    shadowOpacity: 0.1,
  },
  buttonContent: {
    flexDirection: 'row',
    alignItems: 'center',
  },
  loadingButtonContent: {
    flexDirection: 'row',
    alignItems: 'center',
  },
  modernLoginButtonText: {
    color: lightColors.deepNavy,
    fontSize: 16,
    fontFamily: fonts.regular,
    marginRight: 8,
  },
  modernSecondaryButton: {
    backgroundColor: 'transparent',
    height: 56,
    borderRadius: 12,
    justifyContent: 'center',
    alignItems: 'center',
    marginTop: 40,
    borderWidth: 2,
    borderColor: lightColors.beeYellow,
  },
  modernSecondaryButtonText: {
    color: lightColors.beeYellow,
    fontSize: 16,
    fontFamily: fonts.regular,
  },
  successMessageContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: `${lightColors.success}20`,
    padding: 12,
    borderRadius: 8,
    marginVertical: 16,
  },
  successMessageText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.success,
    marginLeft: 8,
  },
  backToHome: {
    flexDirection: 'row',
    alignItems: 'center',
    marginTop: 32,
    paddingVertical: 8,
  },
  backToHomeText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.softBlue,
    marginLeft: 8,
  },
  inputContainer: {
    marginBottom: 20,
  },
  // Jobs Page Styles
  jobsToolbar: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingHorizontal: 24,
    paddingVertical: 12,
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
    overflow: 'visible',
  },
  jobsToolbarLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 16,
    flex: 1,
    overflow: 'visible',
  },
  toolbarLogo: {
    width: 36,
    height: 36,
    marginRight: 8,
  },
  jobsToolbarRight: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  toolbarNavButton: {
    paddingHorizontal: 16,
    paddingVertical: 8,
  },
  toolbarBookmarksButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
  },
  toolbarNavButtonText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  toolbarSearchContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.cream,
    borderRadius: 8,
    paddingHorizontal: 12,
    paddingVertical: 8,
    gap: 8,
    flex: 1,
    maxWidth: 400,
  },
  toolbarSearchInput: {
    flex: 1,
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    outlineStyle: 'none',
  },
  toolbarIconButton: {
    padding: 8,
    position: 'relative',
  },
  bookmarkBadge: {
    position: 'absolute',
    top: 2,
    right: 2,
    backgroundColor: lightColors.beeYellow,
    borderRadius: 10,
    minWidth: 18,
    height: 18,
    justifyContent: 'center',
    alignItems: 'center',
    paddingHorizontal: 4,
  },
  bookmarkBadgeText: {
    fontSize: 10,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  toolbarLanguageContainer: {
    position: 'relative',
    zIndex: 1000,
  },
  toolbarLanguageButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    paddingHorizontal: 12,
    paddingVertical: 8,
    backgroundColor: lightColors.cream,
    borderRadius: 8,
  },
  toolbarLanguageText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  languageMenu: {
    position: 'absolute',
    top: 45,
    right: 0,
    backgroundColor: lightColors.white,
    borderRadius: 8,
    paddingVertical: 8,
    minWidth: 180,
    maxHeight: 300,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 5,
    zIndex: 1001,
    borderWidth: 1,
    borderColor: lightColors.lightGray,
  },
  languageMenuItem: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 10,
  },
  languageMenuItemText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  languageMenuItemTextActive: {
    color: lightColors.beeYellow,
    fontWeight: '600',
  },
  toolbarUserName: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  toolbarSettingsButton: {
    padding: 8,
  },
  toolbarLogoutButton: {
    padding: 8,
  },
  toolbarProfilePicture: {
    width: 36,
    height: 36,
    borderRadius: 18,
    borderWidth: 2,
    borderColor: lightColors.beeYellow,
  },
  toolbarProfilePlaceholder: {
    width: 36,
    height: 36,
    borderRadius: 18,
    backgroundColor: lightColors.beeYellow,
    justifyContent: 'center',
    alignItems: 'center',
  },
  toolbarLoginButton: {
    paddingHorizontal: 16,
    paddingVertical: 8,
    borderWidth: 1,
    borderColor: lightColors.deepNavy,
    borderRadius: 8,
  },
  toolbarLoginButtonText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  toolbarSignupButton: {
    paddingHorizontal: 16,
    paddingVertical: 8,
    backgroundColor: lightColors.beeYellow,
    borderRadius: 8,
  },
  toolbarSignupButtonText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  // Theme Toggle Switch Styles
  toolbarThemeToggle: {
    marginRight: 12,
  },
  themeToggleTrack: {
    width: 64,
    height: 28,
    borderRadius: 14,
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 4,
    position: 'relative',
  },
  themeToggleIconLeft: {
    position: 'absolute',
    left: 6,
    zIndex: 1,
  },
  themeToggleIconRight: {
    position: 'absolute',
    right: 6,
    zIndex: 1,
  },
  themeToggleKnob: {
    width: 24,
    height: 24,
    borderRadius: 12,
    justifyContent: 'center',
    alignItems: 'center',
    position: 'absolute',
    left: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.2,
    shadowRadius: 2,
    elevation: 2,
    transition: 'left 0.2s ease',
  },
  themeToggleKnobActive: {
    left: 38,
  },
  // Settings Screen Styles
  settingsHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 24,
    paddingVertical: 16,
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
    gap: 16,
  },
  settingsBackButton: {
    padding: 8,
  },
  settingsTitle: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  settingsContainer: {
    flex: 1,
    backgroundColor: lightColors.cream,
  },
  settingsSplitContainer: {
    flex: 1,
    flexDirection: 'row',
  },
  settingsSidebar: {
    flex: 1,
    borderRightWidth: 1,
    borderRightColor: lightColors.lightGray,
    minWidth: 280,
    maxWidth: 320,
  },
  // Modern Profile Header
  modernProfileHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    padding: 20,
    gap: 12,
    borderBottomWidth: 1,
    marginBottom: 8,
  },
  modernProfileImage: {
    width: 56,
    height: 56,
    borderRadius: 28,
  },
  modernProfileImagePlaceholder: {
    width: 56,
    height: 56,
    borderRadius: 28,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernProfileInfo: {
    flex: 1,
  },
  modernProfileName: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 2,
  },
  modernProfileEmail: {
    fontSize: 13,
    fontFamily: fonts.regular,
  },
  modernProfileUsername: {
    fontSize: 12,
    fontFamily: fonts.regular,
    fontWeight: '500',
  },
  // Modern Menu Items
  modernMenuContainer: {
    paddingVertical: 8,
  },
  modernMenuItem: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 20,
    paddingVertical: 14,
    gap: 12,
    borderLeftWidth: 3,
    borderLeftColor: 'transparent',
  },
  modernMenuItemActive: {
    borderLeftWidth: 3,
  },
  modernMenuTextContainer: {
    flex: 1,
  },
  modernMenuTitle: {
    fontSize: 15,
    fontFamily: fonts.regular,
    fontWeight: '500',
  },
  modernMenuTitleActive: {
    fontWeight: '600',
  },
  // Modern Logout Button
  modernLogoutButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 16,
    marginTop: 16,
    marginHorizontal: 20,
    gap: 8,
    borderTopWidth: 1,
  },
  modernLogoutText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  settingsContentArea: {
    flex: 4,
  },
  settingsContentScroll: {
    flex: 1,
  },
  settingsContentSection: {
    padding: 32,
  },
  settingsContentTitle: {
    fontSize: 32,
    fontFamily: fonts.regular,
    fontWeight: '700',
    marginBottom: 8,
  },
  settingsContentSubtitle: {
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 32,
  },
  settingsSection: {
    gap: 16,
  },
  settingsSectionTitle: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 8,
  },
  settingsSectionSubtitle: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 16,
  },
  settingsCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 20,
    alignItems: 'center',
    gap: 12,
  },
  settingsUserEmail: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  settingsLoadingContainer: {
    padding: 40,
    alignItems: 'center',
  },
  categoriesGrid: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 12,
  },
  categoryCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 16,
    borderWidth: 2,
    borderColor: lightColors.lightGray,
    minWidth: 150,
  },
  categoryCardSelected: {
    borderColor: lightColors.beeYellow,
    backgroundColor: lightColors.cream,
  },
  categoryCardContent: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    gap: 8,
  },
  categoryCardText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  categoryCardTextSelected: {
    color: lightColors.deepNavy,
    fontWeight: '600',
  },
  settingsSaveButton: {
    backgroundColor: lightColors.beeYellow,
    borderRadius: 8,
    paddingVertical: 10,
    paddingHorizontal: 24,
    marginRight: 24,
    marginBottom: 24,
    marginTop: 16,
    alignSelf: 'flex-end',
    alignItems: 'center',
    justifyContent: 'center',
    minWidth: 120,
  },
  settingsSaveButtonDisabled: {
    opacity: 0.6,
  },
  // New Modern Settings Styles
  settingsProfileHeader: {
    paddingHorizontal: 20,
    paddingVertical: 24,
    borderBottomWidth: 1,
    borderBottomColor: '#E5E5E5',
  },
  settingsProfileContent: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
  settingsProfileLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    flex: 1,
  },
  settingsProfileImage: {
    width: 64,
    height: 64,
    borderRadius: 32,
  },
  settingsProfileImagePlaceholder: {
    width: 64,
    height: 64,
    borderRadius: 32,
    justifyContent: 'center',
    alignItems: 'center',
  },
  settingsProfileDetails: {
    marginLeft: 16,
    flex: 1,
  },
  settingsProfileName: {
    fontSize: 18,
    fontFamily: fonts.regular,
    fontWeight: '700',
    marginBottom: 2,
  },
  settingsProfileEmail: {
    fontSize: 13,
    fontFamily: fonts.regular,
    marginBottom: 4,
  },
  settingsProfileUsername: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    marginTop: 2,
  },
  settingsEditButton: {
    width: 40,
    height: 40,
    borderRadius: 20,
    justifyContent: 'center',
    alignItems: 'center',
  },
  settingsStatsContainer: {
    flexDirection: 'row',
    paddingHorizontal: 20,
    paddingVertical: 16,
    gap: 12,
  },
  settingsStatCard: {
    flex: 1,
    paddingVertical: 16,
    borderRadius: 12,
    alignItems: 'center',
    justifyContent: 'center',
  },
  settingsStatNumber: {
    fontSize: 18,
    fontFamily: fonts.regular,
    fontWeight: '700',
    marginTop: 8,
  },
  settingsStatLabel: {
    fontSize: 11,
    fontFamily: fonts.regular,
    marginTop: 2,
    textTransform: 'uppercase',
    letterSpacing: 0.5,
  },
  settingsListContainer: {
    paddingHorizontal: 20,
    paddingBottom: 32,
  },
  settingsSectionHeader: {
    fontSize: 11,
    fontFamily: fonts.regular,
    fontWeight: '700',
    letterSpacing: 1,
    marginBottom: 12,
    marginTop: 8,
  },
  settingsListItem: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingVertical: 16,
    borderBottomWidth: 1,
  },
  settingsListItemLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    flex: 1,
    gap: 16,
  },
  settingsListIcon: {
    width: 40,
    height: 40,
    borderRadius: 12,
    justifyContent: 'center',
    alignItems: 'center',
  },
  settingsListTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 2,
  },
  settingsListSubtitle: {
    fontSize: 13,
    fontFamily: fonts.regular,
  },
  settingsLogoutButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 14,
    borderRadius: 12,
    borderWidth: 1.5,
    marginTop: 32,
    gap: 8,
  },
  settingsLogoutText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  settingsAppInfo: {
    alignItems: 'center',
    paddingVertical: 24,
    paddingBottom: 32,
  },
  settingsAppVersion: {
    fontSize: 13,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 4,
  },
  settingsAppCopyright: {
    fontSize: 11,
    fontFamily: fonts.regular,
  },
  },
  settingsModalHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 16,
    paddingVertical: 12,
    borderBottomWidth: 1,
  },
  settingsModalBackButton: {
    width: 40,
    height: 40,
    justifyContent: 'center',
    alignItems: 'center',
  },
  settingsModalTitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    fontWeight: '700',
  },
  settingsSaveButtonText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    fontWeight: '600',
  },
  // New Settings Styles
  settingsProfileCard: {
    flexDirection: 'row',
    alignItems: 'center',
    padding: 20,
    borderRadius: 12,
    gap: 16,
  },
  settingsProfileImage: {
    width: 80,
    height: 80,
    borderRadius: 40,
  },
  settingsProfileImagePlaceholder: {
    width: 80,
    height: 80,
    borderRadius: 40,
    justifyContent: 'center',
    alignItems: 'center',
  },
  settingsProfileInfo: {
    flex: 1,
  },
  settingsProfileName: {
    fontSize: 20,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 4,
  },
  settingsProfileEmail: {
    fontSize: 14,
    fontFamily: fonts.regular,
  },
  settingsMenuItem: {
    flexDirection: 'row',
    alignItems: 'center',
    padding: 16,
    borderRadius: 12,
    marginBottom: 12,
    gap: 12,
  },
  settingsMenuIconContainer: {
    width: 48,
    height: 48,
    borderRadius: 24,
    justifyContent: 'center',
    alignItems: 'center',
  },
  settingsMenuContent: {
    flex: 1,
  },
  settingsMenuTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 4,
  },
  settingsMenuSubtitle: {
    fontSize: 13,
    fontFamily: fonts.regular,
  },
  settingsLogoutButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    padding: 16,
    borderRadius: 12,
    borderWidth: 2,
    gap: 8,
  },
  settingsLogoutButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  // Profile Settings Styles
  settingsInputGroup: {
    padding: 16,
    borderRadius: 12,
    marginBottom: 12,
  },
  settingsInputLabel: {
    fontSize: 14,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 8,
  },
  settingsTextInput: {
    fontSize: 16,
    fontFamily: fonts.regular,
    padding: 12,
    borderRadius: 8,
    outlineStyle: 'none',
  },
  settingsTextAreaInput: {
    minHeight: 100,
    paddingTop: 12,
  },
  settingsTextInputDisabled: {
    opacity: 0.6,
  },
  settingsInputHint: {
    fontSize: 12,
    fontFamily: fonts.regular,
    marginTop: 4,
  },
  profilePictureContainer: {
    alignItems: 'center',
    gap: 12,
  },
  profilePicturePreview: {
    width: 120,
    height: 120,
    borderRadius: 60,
  },
  profilePicturePlaceholder: {
    width: 120,
    height: 120,
    borderRadius: 60,
    justifyContent: 'center',
    alignItems: 'center',
  },
  uploadPhotoButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 8,
    paddingVertical: 12,
    paddingHorizontal: 24,
    borderRadius: 8,
    marginTop: 8,
  },
  uploadPhotoButtonText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  // Modern Profile Section Styles
  modernProfilePictureSection: {
    alignItems: 'center',
    marginBottom: 32,
    gap: 16,
  },
  modernProfilePicturePreview: {
    width: 140,
    height: 140,
    borderRadius: 70,
  },
  modernProfilePicturePlaceholder: {
    width: 140,
    height: 140,
    borderRadius: 70,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernUploadButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 10,
    paddingVertical: 12,
    paddingHorizontal: 28,
    borderRadius: 8,
  },
  modernUploadButtonText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  modernInputCard: {
    padding: 20,
    borderRadius: 12,
    marginBottom: 16,
  },
  modernInputLabel: {
    fontSize: 14,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 12,
  },
  modernTextInput: {
    fontSize: 16,
    fontFamily: fonts.regular,
    padding: 14,
    borderRadius: 8,
    outlineStyle: 'none',
  },
  modernTextArea: {
    minHeight: 120,
    paddingTop: 14,
  },
  modernTextInputDisabled: {
    opacity: 0.6,
  },
  modernInputHint: {
    fontSize: 13,
    fontFamily: fonts.regular,
    marginTop: 8,
  },
  modernSaveButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 8,
    paddingVertical: 14,
    paddingHorizontal: 32,
    borderRadius: 8,
    marginTop: 16,
    alignSelf: 'flex-start',
  },
  modernSaveButtonDisabled: {
    opacity: 0.6,
  },
  modernSaveButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  // Modern Toggle Styles
  modernToggleRow: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
  modernToggleLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 16,
    flex: 1,
  },
  modernIconCircle: {
    width: 48,
    height: 48,
    borderRadius: 24,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernToggleTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 2,
  },
  modernToggleSubtitle: {
    fontSize: 13,
    fontFamily: fonts.regular,
  },
  // Appearance Settings Styles
  settingsToggleItem: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    padding: 16,
    borderRadius: 12,
    marginBottom: 12,
  },
  settingsToggleLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  settingsToggleTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 4,
  },
  settingsToggleSubtitle: {
    fontSize: 13,
    fontFamily: fonts.regular,
  },
  toggleSwitch: {
    width: 52,
    height: 28,
    borderRadius: 14,
    backgroundColor: lightColors.lightGray,
    padding: 2,
    justifyContent: 'center',
  },
  toggleSwitchActive: {
    backgroundColor: lightColors.beeYellow,
  },
  toggleKnob: {
    width: 24,
    height: 24,
    borderRadius: 12,
    backgroundColor: lightColors.white,
  },
  toggleKnobActive: {
    marginLeft: 24,
  },
  // Language Settings Styles
  settingsSelectionItem: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    padding: 16,
    borderRadius: 12,
    marginBottom: 12,
    borderWidth: 1,
  },
  settingsSelectionLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  settingsSelectionText: {
    fontSize: 16,
    fontFamily: fonts.regular,
  },
  // Interests/Categories Styles
  settingsCategoriesGrid: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 12,
    marginTop: 16,
  },
  settingsCategoryChip: {
    paddingVertical: 10,
    paddingHorizontal: 16,
    borderRadius: 20,
    borderWidth: 1,
  },
  settingsCategoryChipText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    fontWeight: '500',
  },
  // Subscription Styles
  settingsCurrentPlanCard: {
    padding: 24,
    borderRadius: 12,
    alignItems: 'center',
    gap: 8,
    marginBottom: 16,
  },
  settingsCurrentPlanName: {
    fontSize: 20,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  settingsCurrentPlanPrice: {
    fontSize: 24,
    fontFamily: fonts.regular,
    fontWeight: '700',
  },
  settingsPlanCard: {
    padding: 20,
    borderRadius: 12,
    marginBottom: 16,
    borderWidth: 1,
  },
  settingsPlanHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'flex-start',
    marginBottom: 16,
  },
  settingsPlanName: {
    fontSize: 18,
    fontFamily: fonts.regular,
    fontWeight: '600',
    marginBottom: 4,
  },
  settingsPlanPrice: {
    fontSize: 20,
    fontFamily: fonts.regular,
    fontWeight: '700',
  },
  settingsPlanFeatures: {
    gap: 10,
    marginBottom: 16,
  },
  settingsPlanFeature: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  settingsPlanFeatureText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    flex: 1,
  },
  settingsUpgradeButton: {
    padding: 12,
    borderRadius: 8,
    alignItems: 'center',
  },
  settingsUpgradeButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  settingsCurrentBadge: {
    paddingVertical: 6,
    paddingHorizontal: 12,
    borderRadius: 20,
  },
  settingsCurrentBadgeText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  // Subscription Styles
  currentPlanCard: {
    padding: 24,
    borderRadius: 12,
    alignItems: 'center',
    gap: 12,
  },
  currentPlanName: {
    fontSize: 20,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  planCard: {
    padding: 20,
    borderRadius: 12,
    marginBottom: 16,
    borderWidth: 1,
  },
  planHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 16,
  },
  planName: {
    fontSize: 18,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  planPrice: {
    fontSize: 20,
    fontFamily: fonts.regular,
    fontWeight: '700',
  },
  planFeatures: {
    gap: 10,
    marginBottom: 16,
  },
  planFeatureItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  planFeatureText: {
    fontSize: 14,
    fontFamily: fonts.regular,
  },
  planUpgradeButton: {
    padding: 12,
    borderRadius: 8,
    alignItems: 'center',
  },
  planUpgradeButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  planCurrentBadge: {
    padding: 8,
    borderRadius: 8,
    alignItems: 'center',
  },
  planCurrentBadgeText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    fontWeight: '600',
  },
  jobsPageHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingHorizontal: 24,
    paddingVertical: 16,
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
  },
  jobsPageHeaderLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  headerLogoImage: {
    width: 32,
    height: 32,
    resizeMode: 'contain',
  },
  jobsPageTitle: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  logoutButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    paddingHorizontal: 16,
    paddingVertical: 8,
    backgroundColor: lightColors.lightGray,
    borderRadius: 8,
  },
  logoutButtonText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  jobsPageContainer: {
    flex: 1,
    backgroundColor: lightColors.cream,
  },
  jobsPageSearchSection: {
    padding: 24,
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
  },
  jobsContentWithSidebar: {
    flexDirection: 'row',
    padding: 24,
    gap: 24,
    alignItems: 'flex-start',
  },
  jobsGridSection: {
    flex: 8,
    minWidth: 0,
  },
  filterSidebar: {
    flex: 1,
    minWidth: 250,
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 8,
    elevation: 3,
  },
  filterSidebarTitle: {
    fontSize: 18,
    fontFamily: fonts.semibold,
    color: lightColors.deepNavy,
    marginBottom: 20,
    paddingBottom: 12,
    borderBottomWidth: 2,
    borderBottomColor: lightColors.beeYellow,
  },
  filterSidebarSection: {
    marginBottom: 20,
  },
  filterSidebarLabel: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.warmGray,
    marginBottom: 10,
  },
  filterChipsContainer: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 8,
  },
  filterChipSmall: {
    paddingHorizontal: 12,
    paddingVertical: 6,
    backgroundColor: lightColors.lightGray,
    borderRadius: 16,
    borderWidth: 1,
    borderColor: 'transparent',
  },
  filterChipTextSmall: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  jobsPageMainTitle: {
    fontSize: 32,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 24,
  },
  
  // ===== MODERN JOBS PAGE STYLES =====
  // Hero Section
  jobsHeroSection: {
    backgroundColor: lightColors.deepNavy,
    paddingVertical: 60,
    paddingHorizontal: 24,
    position: 'relative',
    overflow: 'hidden',
  },
  heroBackgroundImage: {
    opacity: 0.3,
  },
  heroDarkOverlay: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    backgroundColor: 'rgba(26, 54, 93, 0.85)',
  },
  heroBackgroundDecor: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
  },
  heroCircle1: {
    position: 'absolute',
    width: 400,
    height: 400,
    borderRadius: 200,
    top: -200,
    right: -100,
    opacity: 0.5,
  },
  heroCircle2: {
    position: 'absolute',
    width: 300,
    height: 300,
    borderRadius: 150,
    bottom: -100,
    left: -50,
    opacity: 0.3,
  },
  jobsHeroContent: {
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
    zIndex: 1,
  },
  heroTextContainer: {
    marginBottom: 32,
  },
  jobsHeroTitle: {
    fontSize: 42,
    fontFamily: fonts.bold,
    color: lightColors.white,
    marginBottom: 12,
    textAlign: 'center',
    lineHeight: 52,
  },
  jobsHeroSubtitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.cream,
    textAlign: 'center',
  },
  heroSearchContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.white,
    borderRadius: 50,
    paddingHorizontal: 8,
    paddingVertical: 8,
    marginBottom: 40,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 8 },
    shadowOpacity: 0.2,
    shadowRadius: 16,
    elevation: 12,
  },
  searchIconContainer: {
    paddingLeft: 16,
    paddingRight: 8,
  },
  heroSearchInput: {
    flex: 1,
    fontSize: 16,
    fontFamily: fonts.regular,
    paddingVertical: 12,
    paddingHorizontal: 8,
  },
  searchClearButton: {
    padding: 8,
  },
  searchButton: {
    paddingHorizontal: 28,
    paddingVertical: 12,
    backgroundColor: lightColors.deepNavy,
    borderRadius: 40,
    marginLeft: 8,
  },
  searchButtonText: {
    fontSize: 15,
    fontFamily: fonts.medium,
    color: lightColors.white,
  },
  statsRow: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    alignItems: 'center',
  },
  statItem: {
    alignItems: 'center',
  },
  statIconCircle: {
    width: 56,
    height: 56,
    borderRadius: 28,
    justifyContent: 'center',
    alignItems: 'center',
    marginBottom: 12,
  },
  statNumber: {
    fontSize: 32,
    fontFamily: fonts.bold,
    color: lightColors.beeYellow,
  },
  statLabel: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.cream,
    marginTop: 4,
  },
  statDivider: {
    width: 1,
    height: 80,
    backgroundColor: `${lightColors.cream}40`,
  },

  // Category Pills
  categoriesSection: {
    paddingVertical: 20,
    paddingHorizontal: 24,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
  },
  categoriesScrollContent: {
    paddingRight: 24,
  },
  categoryPill: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 20,
    paddingVertical: 10,
    marginRight: 12,
    backgroundColor: lightColors.cream,
    borderRadius: 25,
    borderWidth: 1,
    gap: 8,
  },
  categoryPillText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
  },

  // Results Header
  resultsHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'flex-start',
    marginBottom: 24,
    flexWrap: 'wrap',
    gap: 16,
  },
  resultsLeftSection: {
    flex: 1,
    minWidth: 250,
  },
  resultsRightSection: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 16,
  },
  resultsCount: {
    fontSize: 20,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    marginBottom: 8,
  },
  activeFiltersRow: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 8,
    marginTop: 8,
  },
  activeFilterChip: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 16,
    gap: 6,
  },
  activeFilterText: {
    fontSize: 12,
    fontFamily: fonts.medium,
  },
  sortContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  sortLabel: {
    fontSize: 14,
    fontFamily: fonts.regular,
  },
  sortButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 6,
    backgroundColor: lightColors.cream,
    borderRadius: 8,
  },
  sortButtonText: {
    fontSize: 14,
    fontFamily: fonts.medium,
  },
  viewToggle: {
    flexDirection: 'row',
    gap: 8,
  },
  viewToggleButton: {
    padding: 10,
    borderRadius: 8,
  },

  // Modern Job Card - Enhanced
  modernJobCard: {
    flex: 1,
    maxWidth: '48%',
    backgroundColor: lightColors.white,
    borderRadius: 16,
    padding: 20,
    marginBottom: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.08,
    shadowRadius: 12,
    elevation: 3,
    borderWidth: 1,
    borderColor: `${lightColors.lightGray}40`,
    position: 'relative',
  },
  modernJobCardList: {
    flex: 1,
    maxWidth: '100%',
    width: '100%',
  },
  featuredJobCard: {
    borderColor: lightColors.beeYellow,
    borderWidth: 2,
    shadowOpacity: 0.12,
    shadowRadius: 16,
  },
  featuredBadge: {
    position: 'absolute',
    top: 12,
    right: 12,
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 10,
    paddingVertical: 5,
    backgroundColor: lightColors.beeYellow,
    borderRadius: 12,
    gap: 4,
    zIndex: 1,
  },
  featuredBadgeText: {
    fontSize: 11,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    textTransform: 'uppercase',
    letterSpacing: 0.5,
  },
  modernCardHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 16,
  },
  cardHeaderActions: {
    flexDirection: 'row',
    gap: 8,
  },
  companyLogo: {
    width: 52,
    height: 52,
    borderRadius: 13,
    backgroundColor: lightColors.deepNavy,
    justifyContent: 'center',
    alignItems: 'center',
  },
  companyLogoText: {
    fontSize: 22,
    fontFamily: fonts.bold,
    color: lightColors.white,
  },
  bookmarkButton: {
    width: 36,
    height: 36,
    borderRadius: 18,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernCardBody: {
    marginBottom: 16,
  },
  modernJobTitle: {
    fontSize: 19,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    marginBottom: 8,
    lineHeight: 26,
  },
  modernCompanyName: {
    fontSize: 15,
    fontFamily: fonts.medium,
    color: lightColors.warmGray,
    marginBottom: 14,
  },
  tagsRow: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 8,
    marginBottom: 14,
  },
  modernTag: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 10,
    paddingVertical: 6,
    borderRadius: 8,
    borderWidth: 1,
    gap: 4,
  },
  modernTagText: {
    fontSize: 12,
    fontFamily: fonts.medium,
  },
  modernMetaRow: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 10,
  },
  modernMetaItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    flex: 1,
  },
  modernMetaText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    flex: 1,
  },
  salarySection: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 8,
    backgroundColor: `${lightColors.success}10`,
    borderRadius: 8,
    gap: 6,
  },
  salaryText: {
    fontSize: 15,
    fontFamily: fonts.bold,
    color: lightColors.success,
  },
  modernCardFooter: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingTop: 16,
    borderTopWidth: 1,
  },
  jobDateContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  modernJobDate: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  modernApplyButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 18,
    paddingVertical: 10,
    backgroundColor: lightColors.deepNavy,
    borderRadius: 8,
    gap: 6,
  },
  modernApplyText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.white,
  },

  // Modern Grid
  modernJobsGrid: {
    paddingBottom: 20,
  },
  modernJobsRow: {
    justifyContent: 'flex-start',
    gap: 20,
    marginBottom: 0,
  },

  // Modern Loading & Empty States
  modernLoadingContainer: {
    paddingVertical: 100,
    alignItems: 'center',
    justifyContent: 'center',
  },
  modernLoadingText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginTop: 16,
  },
  modernEmptyState: {
    paddingVertical: 80,
    alignItems: 'center',
    justifyContent: 'center',
  },
  emptyStateIcon: {
    width: 120,
    height: 120,
    borderRadius: 60,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
    marginBottom: 24,
  },
  emptyStateTitle: {
    fontSize: 24,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    marginBottom: 12,
  },
  emptyStateDescription: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginBottom: 24,
    paddingHorizontal: 40,
  },
  emptyStateButton: {
    paddingHorizontal: 32,
    paddingVertical: 14,
    backgroundColor: lightColors.deepNavy,
    borderRadius: 25,
  },
  emptyStateButtonText: {
    fontSize: 15,
    fontFamily: fonts.medium,
    color: lightColors.white,
  },

  // Modern Pagination
  modernPagination: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingVertical: 24,
    paddingHorizontal: 20,
    backgroundColor: lightColors.white,
    borderRadius: 12,
    marginTop: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.05,
    shadowRadius: 8,
    elevation: 2,
  },
  modernPaginationButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 10,
    borderRadius: 8,
    borderWidth: 1,
    gap: 6,
  },
  modernPaginationButtonDisabled: {
    opacity: 0.4,
  },
  modernPaginationButtonText: {
    fontSize: 14,
    fontFamily: fonts.medium,
  },
  modernPaginationNumbers: {
    flexDirection: 'row',
    gap: 8,
  },
  modernPageNumber: {
    width: 40,
    height: 40,
    borderRadius: 8,
    borderWidth: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernPageNumberText: {
    fontSize: 14,
    fontFamily: fonts.medium,
  },

  // Modern Filter Sidebar - Revamped
  filterHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 24,
    paddingBottom: 20,
    borderBottomWidth: 2,
    borderBottomColor: lightColors.lightGray,
    gap: 14,
  },
  filterTitle: {
    fontSize: 24,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    letterSpacing: -0.5,
  },
  clearFiltersButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 12,
    paddingHorizontal: 18,
    marginBottom: 24,
    borderRadius: 10,
    gap: 8,
    backgroundColor: `${lightColors.softBlue}15`,
    borderWidth: 1,
    borderColor: `${lightColors.softBlue}30`,
    shadowColor: lightColors.softBlue,
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 2,
  },
  clearFiltersText: {
    fontSize: 14,
    fontFamily: fonts.bold,
    color: lightColors.softBlue,
    letterSpacing: 0.3,
  },
  filterGroup: {
    marginBottom: 28,
    backgroundColor: `${lightColors.cream}80`,
    borderRadius: 14,
    padding: 18,
    borderWidth: 1,
    borderColor: `${lightColors.lightGray}60`,
  },
  filterGroupHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 16,
    paddingVertical: 6,
    paddingHorizontal: 4,
  },
  filterGroupTitleContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
    flex: 1,
  },
  filterGroupIconCircle: {
    width: 36,
    height: 36,
    borderRadius: 18,
    justifyContent: 'center',
    alignItems: 'center',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.08,
    shadowRadius: 3,
    elevation: 2,
  },
  expandIconCircle: {
    width: 32,
    height: 32,
    borderRadius: 16,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: lightColors.cream,
  },
  filterGroupTitle: {
    fontSize: 17,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    letterSpacing: -0.3,
  },
  filterOptions: {
    gap: 10,
  },
  filterOption: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingVertical: 14,
    paddingHorizontal: 18,
    backgroundColor: lightColors.white,
    borderRadius: 12,
    gap: 14,
    borderWidth: 1.5,
    borderColor: `${lightColors.lightGray}60`,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.05,
    shadowRadius: 3,
    elevation: 1,
  },
  filterOptionActive: {
    shadowColor: lightColors.deepNavy,
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.15,
    shadowRadius: 6,
    elevation: 3,
  },
  filterOptionIconCircle: {
    width: 32,
    height: 32,
    borderRadius: 16,
    justifyContent: 'center',
    alignItems: 'center',
  },
  filterOptionText: {
    fontSize: 15,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
    flex: 1,
  },
  checkmarkCircle: {
    width: 24,
    height: 24,
    borderRadius: 12,
    backgroundColor: lightColors.beeYellow,
    justifyContent: 'center',
    alignItems: 'center',
    marginLeft: 'auto',
  },
  
  // ===== END MODERN STYLES =====
  
  categoriesScrollView: {
    marginTop: 16,
  },
  categoryFilterChip: {
    paddingHorizontal: 16,
    paddingVertical: 8,
    marginRight: 12,
    backgroundColor: lightColors.lightGray,
    borderRadius: 20,
    borderWidth: 1,
    borderColor: 'transparent',
  },
  categoryFilterChipActive: {
    backgroundColor: lightColors.beeYellow,
    borderColor: lightColors.honeyGold,
  },
  categoryFilterChipText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  categoryFilterChipTextActive: {
    color: lightColors.deepNavy,
  },
  // Additional Filters
  additionalFiltersContainer: {
    paddingHorizontal: 24,
    paddingTop: 16,
    paddingBottom: 8,
    backgroundColor: lightColors.white,
  },
  filterRow: {
    marginBottom: 12,
    flexDirection: 'row',
    alignItems: 'center',
  },
  filterLabel: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.warmGray,
    marginRight: 12,
    minWidth: 80,
  },
  filterChip: {
    paddingHorizontal: 14,
    paddingVertical: 6,
    marginRight: 8,
    backgroundColor: lightColors.lightGray,
    borderRadius: 16,
    borderWidth: 1,
    borderColor: 'transparent',
  },
  filterChipText: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  // Popular filters (landing page recent jobs)
  popularFiltersContainer: {
    paddingHorizontal: 0,
    paddingVertical: 0,
    backgroundColor: lightColors.white,
    marginBottom: 8,
  },
  popularFiltersContent: {
    alignItems: 'center',
    paddingHorizontal: 8,
  },
  popularFilterChip: {
    paddingHorizontal: 14,
    paddingVertical: 6,
    marginRight: 10,
    backgroundColor: lightColors.lightGray,
    borderRadius: 20,
    borderWidth: 1,
    borderColor: 'transparent',
  },
  popularFilterChipActive: {
    backgroundColor: lightColors.beeYellow,
    borderColor: lightColors.honeyGold,
  },
  popularFilterText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  popularFilterTextActive: {
    color: lightColors.deepNavy,
  },
  jobsPageJobsSection: {
    padding: 24,
  },

  // Compact job card & view more styles for landing page
  viewMoreContainer: {
    paddingHorizontal: 24,
    paddingBottom: 32,
    alignItems: 'center',
    backgroundColor: lightColors.white,
  },
  viewMoreButton: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.beeYellow,
    paddingHorizontal: 20,
    paddingVertical: 12,
    borderRadius: 14,
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.18,
    shadowRadius: 8,
    elevation: 3,
  },
  viewMoreButtonText: {
    color: lightColors.white,
    fontSize: 15,
    fontFamily: fonts.regular,
    marginRight: 8,
  },

  // Simple compact job card parts
  jobCardSimpleHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 12,
  },
  jobCompanyBadge: {
    width: 36,
    height: 36,
    borderRadius: 8,
    backgroundColor: `${lightColors.softBlue}15`,
    justifyContent: 'center',
    alignItems: 'center',
  },
  remoteTag: {
    backgroundColor: `${lightColors.success}15`,
    paddingHorizontal: 10,
    paddingVertical: 4,
    borderRadius: 12,
  },
  remoteTagText: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: lightColors.success,
  },
  jobCardBody: {
    marginBottom: 12,
  },
  jobMetaContainer: {
    marginTop: 8,
    marginBottom: 4,
  },
  jobMetaItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
  },
  jobSalaryContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    marginTop: 4,
  },
  jobCardSimpleFooter: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingTop: 12,
    borderTopWidth: 1,
    borderTopColor: lightColors.lightGray,
  },
  emptyStateContainer: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 80,
  },
  emptyStateText: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginTop: 16,
  },
  emptyStateSubtext: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 8,
  },
  adminContainer: {
    flex: 1,
    flexDirection: 'row',
  },
  sidebar: {
    width: 280,
    backgroundColor: '#FFFFFF',
    paddingVertical: 0,
    borderRightWidth: 1,
    borderRightColor: '#F3F4F6',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 0 },
    shadowOpacity: 0.08,
    shadowRadius: 24,
  },
  sidebarHeader: {
    paddingHorizontal: 24,
    paddingTop: 32,
    paddingBottom: 24,
    borderBottomWidth: 1,
    borderBottomColor: '#F3F4F6',
    marginBottom: 24,
  },
  sidebarLogo: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: '#111827',
    marginLeft: 12,
    letterSpacing: -0.5,
  },
  sidebarUser: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: '#6B7280',
    marginLeft: 8,
  },
  sidebarUserRole: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: '#9CA3AF',
    marginLeft: 8,
    marginTop: 2,
    textTransform: 'capitalize',
  },
  sidebarItem: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 14,
    marginHorizontal: 12,
    marginVertical: 2,
    borderRadius: 12,
    position: 'relative',
    transition: 'all 0.2s ease',
  },
  sidebarItemActive: {
    backgroundColor: '#FEF3C7',
    borderWidth: 0,
  },
  sidebarIcon: {
    fontSize: 22,
    marginRight: 16,
  },
  sidebarText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#6B7280',
    flex: 1,
    letterSpacing: 0.2,
  },
  sidebarTextActive: {
    color: '#111827',
    fontFamily: fonts.regular,
  },
  logoutButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 14,
    marginTop: 'auto',
    marginHorizontal: 12,
    marginBottom: 24,
    borderRadius: 12,
    backgroundColor: '#FEF2F2',
    borderWidth: 0,
  },
  logoutIcon: {
    fontSize: 22,
    marginRight: 16,
  },
  logoutText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#DC2626',
    letterSpacing: 0.2,
  },
  adminMainContent: {
    flex: 1,
    backgroundColor: '#F9FAFB',
  },
  contentContainer: {
    flex: 1,
    padding: 32,
  },
  contentTitle: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: '#111827',
    marginBottom: 8,
  },
  statsContainer: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    marginBottom: 32,
    gap: 20,
  },
  statCard: {
    backgroundColor: '#FFFFFF',
    padding: 24,
    borderRadius: 16,
    alignItems: 'flex-start',
    flex: 1,
    marginHorizontal: 0,
    borderWidth: 1,
    borderColor: '#F3F4F6',
    borderLeftWidth: 1,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.04,
    shadowRadius: 8,
  },
  statNumber: {
    fontSize: 36,
    fontWeight: '700',
    color: '#111827',
    letterSpacing: -1,
  },
  statLabel: {
    fontSize: 14,
    color: '#6B7280',
    marginTop: 6,
    fontWeight: '500',
  },
  welcomeText: {
    fontSize: 16,
    color: '#6B7280',
    lineHeight: 24,
  },
  addButton: {
    backgroundColor: '#F59E0B',
    paddingHorizontal: 24,
    paddingVertical: 14,
    borderRadius: 12,
    alignItems: 'center',
    marginBottom: 20,
    shadowColor: '#F59E0B',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.15,
    shadowRadius: 12,
    transition: 'all 0.2s ease',
  },
  addButtonText: {
    color: '#FFFFFF',
    fontSize: 15,
    fontFamily: fonts.regular,
    letterSpacing: 0.3,
  },
  listContainer: {
    flex: 1,
  },
  listItem: {
    backgroundColor: '#FFFFFF',
    flexDirection: 'row',
    alignItems: 'center',
    padding: 20,
    borderRadius: 12,
    marginBottom: 10,
  },
  listIcon: {
    fontSize: 24,
    marginRight: 15,
  },
  listInfo: {
    flex: 1,
  },
  listTitle: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#111827',
    marginBottom: 5,
  },
  listSubtitle: {
    fontSize: 14,
    color: '#6B7280',
  },
  statusBadge: {
    fontSize: 12,
    fontWeight: 'bold',
    marginTop: 5,
  },
  listActions: {
    flexDirection: 'row',
    gap: 10,
  },
  editButton: {
    backgroundColor: '#3B82F6',
    paddingHorizontal: 16,
    paddingVertical: 10,
    borderRadius: 10,
    transition: 'all 0.2s ease',
  },
  deleteButton: {
    backgroundColor: '#EF4444',
    paddingHorizontal: 16,
    paddingVertical: 10,
    borderRadius: 10,
    transition: 'all 0.2s ease',
  },
  actionText: {
    color: '#FFFFFF',
    fontSize: 14,
    fontFamily: fonts.regular,
    letterSpacing: 0.2,
  },
  comingSoon: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginTop: 100,
    fontStyle: 'italic',
  },
  // Users Management Styles
  usersHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 24,
    flexWrap: 'wrap',
    gap: 16,
  },
  usersStats: {
    flexDirection: 'row',
    gap: 12,
  },
  statBadge: {
    backgroundColor: lightColors.cream,
    paddingHorizontal: 16,
    paddingVertical: 8,
    borderRadius: 12,
    borderWidth: 2,
    borderColor: lightColors.beeYellow,
    alignItems: 'center',
  },
  statBadgeLabel: {
    fontSize: 12,
    color: lightColors.warmGray,
    fontFamily: fonts.regular,
    marginBottom: 4,
  },
  statBadgeValue: {
    fontSize: 20,
    color: lightColors.deepNavy,
    fontFamily: fonts.regular,
  },
  searchBarContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#FFFFFF',
    borderRadius: 12,
    paddingHorizontal: 18,
    paddingVertical: 14,
    marginBottom: 20,
    borderWidth: 1.5,
    borderColor: '#E5E7EB',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.04,
    shadowRadius: 8,
    elevation: 1,
  },
  searchInput: {
    flex: 1,
    marginLeft: 12,
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#111827',
    outlineStyle: 'none',
  },
  tableContainer: {
    backgroundColor: '#FFFFFF',
    borderRadius: 16,
    borderWidth: 1,
    borderColor: '#F3F4F6',
    overflow: 'hidden',
    flex: 1,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.06,
    shadowRadius: 16,
    elevation: 3,
  },
  tableHeader: {
    flexDirection: 'row',
    backgroundColor: '#F9FAFB',
    paddingVertical: 18,
    paddingHorizontal: 20,
    borderBottomWidth: 1,
    borderBottomColor: '#E5E7EB',
  },
  tableHeaderCell: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: '#6B7280',
    textTransform: 'uppercase',
    letterSpacing: 0.8,
  },
  tableBody: {
    flex: 1,
  },
  tableRow: {
    flexDirection: 'row',
    paddingVertical: 18,
    paddingHorizontal: 20,
    borderBottomWidth: 1,
    borderBottomColor: '#F3F4F6',
    alignItems: 'center',
    transition: 'background-color 0.15s ease',
  },
  tableRowEven: {
    backgroundColor: 'transparent',
  },
  tableCell: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#111827',
  },
  roleBadge: {
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 20,
    backgroundColor: '#F3F4F6',
    alignSelf: 'flex-start',
  },
  roleBadgeAdmin: {
    backgroundColor: '#FEF3C7',
  },
  roleBadgeSuperAdmin: {
    backgroundColor: '#FEE2E2',
  },
  roleBadgeCompany: {
    backgroundColor: '#DBEAFE',
  },
  roleSelectContainer: {
    flex: 1,
  },
  roleBadgeText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#111827',
    textTransform: 'capitalize',
    letterSpacing: 0.3,
  },
  statusBadge: {
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 20,
    backgroundColor: '#D1FAE5',
    alignSelf: 'flex-start',
  },
  statusBadgeInactive: {
    backgroundColor: '#FEE2E2',
  },
  statusBadgeText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#065F46',
    letterSpacing: 0.3,
  },
  emptyState: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 60,
  },
  emptyStateText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 16,
    textAlign: 'center',
  },
  loadingContainer: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 60,
  },
  loadingText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 16,
  },
  paginationContainer: {
    flexDirection: 'column',
    justifyContent: 'center',
    alignItems: 'center',
    gap: 16,
    marginTop: 20,
    marginHorizontal: 24,
    marginBottom: 24,
    paddingHorizontal: 24,
    paddingVertical: 24,
    backgroundColor: lightColors.white,
    borderRadius: 12,
    borderWidth: 1,
    borderColor: lightColors.lightGray,
  },
  paginationButton: {
    width: 40,
    height: 40,
    borderRadius: 8,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: lightColors.lightGray,
  },
  paginationButtonDisabled: {
    opacity: 0.4,
  },
  paginationInfo: {
    alignItems: 'center',
  },
  paginationText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    fontWeight: '500',
  },
  paginationControls: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  paginationNumbers: {
    flexDirection: 'row',
    gap: 8,
  },
  paginationNumberButton: {
    width: 40,
    height: 40,
    borderRadius: 8,
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    backgroundColor: lightColors.cream,
    borderColor: lightColors.lightGray,
  },
  paginationNumberText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    fontWeight: '500',
  },
  paginationSubtext: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 4,
  },
  // Missing styles - Modern Sidebar Design
  sidebarLogoContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 12,
  },
  logoIconContainer: {
    width: 32,
    height: 32,
    borderRadius: 8,
    backgroundColor: lightColors.sidebarAccentLight,
    justifyContent: 'center',
    alignItems: 'center',
  },
  userContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    marginTop: 8,
  },
  userAvatar: {
    width: 24,
    height: 24,
    borderRadius: 12,
    backgroundColor: lightColors.sidebarAccentLight,
    justifyContent: 'center',
    alignItems: 'center',
  },
  iconContainer: {
    width: 32,
    height: 32,
    borderRadius: 8,
    backgroundColor: 'transparent',
    justifyContent: 'center',
    alignItems: 'center',
    marginRight: 12,
  },
  iconContainerActive: {
    backgroundColor: lightColors.white,
  },
  activeIndicator: {
    position: 'absolute',
    right: 16,
    width: 6,
    height: 6,
    borderRadius: 3,
    backgroundColor: lightColors.sidebarAccent,
  },
  logoutIconContainer: {
    width: 32,
    height: 32,
    borderRadius: 8,
    backgroundColor: 'transparent',
    justifyContent: 'center',
    alignItems: 'center',
    marginRight: 12,
  },
  contentHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 20,
  },
  listIconContainer: {
    width: 44,
    height: 44,
    borderRadius: 22,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
    marginRight: 16,
  },
  // Job Grid Styles
  jobsGrid: {
    paddingTop: 0,
    paddingBottom: 24,
  },
  jobsGridRow: {
    gap: 16,
    justifyContent: 'flex-start',
  },
  jobRow: {
    justifyContent: 'space-between',
    marginHorizontal: -4, // Negative margin to offset card margins
  },
  jobCard: {
    backgroundColor: '#ffffff',
    borderRadius: 12,
    padding: 16,
    margin: 0,
    marginBottom: 16,
    flex: 1,
    minWidth: 0,
    maxWidth: '32%',
    borderWidth: 1,
    borderColor: '#e9ecef',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.06,
    shadowRadius: 8,
    elevation: 2,
    overflow: 'hidden',
  },
  jobCardHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    padding: 16,
    paddingBottom: 12,
  },
  jobIconCircle: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: '#fff3cd',
    alignItems: 'center',
    justifyContent: 'center',
  },
  jobTypeBadge: {
    backgroundColor: '#e9ecef',
    paddingHorizontal: 10,
    paddingVertical: 4,
    borderRadius: 12,
  },
  jobTypeBadgeText: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: '#495057',
    textTransform: 'uppercase',
    letterSpacing: 0.5,
  },
  jobCategoryBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#e7f3ff',
    paddingHorizontal: 10,
    paddingVertical: 4,
    borderRadius: 12,
    marginTop: 8,
    alignSelf: 'flex-start',
    gap: 4,
  },
  jobCategoryText: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: '#2c5aa0',
    textTransform: 'capitalize',
  },
  remoteBadge: {
    backgroundColor: '#d4edda',
    paddingHorizontal: 8,
    paddingVertical: 2,
    borderRadius: 8,
  },
  remoteBadgeText: {
    fontSize: 10,
    fontFamily: fonts.regular,
    color: '#155724',
    textTransform: 'uppercase',
  },
  jobCardContent: {
    paddingHorizontal: 16,
    paddingBottom: 16,
  },
  jobMetaRow: {
    marginTop: 12,
    gap: 8,
  },
  jobMetaItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  jobSalaryRow: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    marginTop: 8,
    paddingTop: 12,
    borderTopWidth: 1,
    borderTopColor: '#f8f9fa',
  },
  jobCardFooter: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 12,
    backgroundColor: '#f8f9fa',
    borderTopWidth: 1,
    borderTopColor: '#e9ecef',
  },
  placeholderCard: {
    backgroundColor: 'transparent',
    borderWidth: 0,
    shadowOpacity: 0,
    elevation: 0,
  },
  jobIconContainer: {
    alignItems: 'center',
    marginBottom: 8,
  },
  jobIcon: {
    fontSize: 24,
    color: lightColors.deepNavy,
  },
  jobInfo: {
    flex: 1,
  },
  jobTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: '#212529',
    marginBottom: 6,
    lineHeight: 22,
  },
  jobCompany: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#6c757d',
    marginBottom: 0,
  },
  jobCategory: {
    fontSize: 9,
    fontFamily: fonts.regular,
    color: lightColors.softBlue,
    marginBottom: 3,
    textAlign: 'center',
  },
  jobLocation: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: '#6c757d',
    flex: 1,
  },
  jobSalary: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#198754',
    flex: 1,
  },
  jobBadgesContainer: {
    flexDirection: 'column',
    alignItems: 'center',
    marginBottom: 6,
  },
  jobBadge: {
    paddingHorizontal: 6,
    paddingVertical: 2,
    borderRadius: 8,
    marginBottom: 2,
    minWidth: 50,
  },
  jobBadgeText: {
    fontSize: 9,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    textAlign: 'center',
  },
  jobSource: {
    fontSize: 9,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 2,
    textAlign: 'center',
  },
  jobDate: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#6c757d',
  },
  // Category Management Styles
  emptyContainer: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    paddingVertical: 60,
  },
  emptyText: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 16,
    marginBottom: 8,
  },
  emptySubtext: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
  },
  subcategoryItem: {
    backgroundColor: lightColors.lightGray,
    borderLeftWidth: 4,
    borderLeftColor: lightColors.beeYellow,
    marginLeft: 20,
  },
  subcategoryTitle: {
    fontSize: 14,
    color: lightColors.charcoal,
  },
  // Home Screen Styles
  toolbar: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 12,
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.sidebarBorder,
    elevation: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
  },
  toolbarLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    flex: 1,
  },
  appIcon: {
    fontSize: 28,
    marginRight: 8,
  },
  appTitle: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  toolbarCenter: {
    flex: 2,
    paddingHorizontal: 16,
  },
  searchContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.lightGray,
    borderRadius: 20,
    paddingHorizontal: 12,
    paddingVertical: 8,
  },
  searchInput: {
    flex: 1,
    marginLeft: 8,
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  toolbarRight: {
    flexDirection: 'row',
    alignItems: 'center',
    flex: 1,
    justifyContent: 'flex-end',
  },
  toolbarButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 6,
    marginLeft: 8,
  },
  toolbarButtonText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginLeft: 4,
  },
  // Download app buttons
  downloadButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 8,
    marginHorizontal: 4,
    backgroundColor: lightColors.beeYellow,
    borderRadius: 8,
    elevation: 2,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
  },
  downloadButtonText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginLeft: 4,
  },
  downloadButtonImage: {
    height: 40,
    width: 135,
    marginHorizontal: 4,
  },
  downloadButtonsContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    marginHorizontal: 8,
  },
  // Icon-only theme switcher
  iconButton: {
    padding: 8,
    borderRadius: 8,
    backgroundColor: lightColors.lightGray,
    alignItems: 'center',
    justifyContent: 'center',
    marginHorizontal: 4,
  },
  // Language dropdown styles
  languageDropdownContainer: {
    position: 'relative',
    marginHorizontal: 8,
    // Removed z-index since we're using full-screen overlay now
  },
  languageDropdownButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 8,
    backgroundColor: lightColors.lightGray,
    borderRadius: 8,
    borderWidth: 1,
    borderColor: lightColors.warmGray,
  },
  languageCode: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginRight: 4,
  },
  languageDropdown: {
    position: 'absolute',
    top: 42,
    right: 0,
    backgroundColor: lightColors.white,
    borderRadius: 8,
    borderWidth: 1,
    borderColor: lightColors.warmGray,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.25,
    shadowRadius: 8,
    elevation: 10, // Higher elevation for Android
    minWidth: 160,
    zIndex: 10000, // Highest z-index to ensure it's on top
  },
  languageOption: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 10,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
  },
  languageOptionActive: {
    backgroundColor: lightColors.cream,
  },
  languageLabel: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    flex: 1,
  },
  dropdownOverlay: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    zIndex: 999,
  },
  // Full-screen dropdown overlay styles
  fullScreenDropdownOverlay: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    zIndex: 999999, // Extremely high z-index to ensure it's on top
  },
  fullScreenTouchArea: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
  },
  absoluteLanguageDropdown: {
    position: 'absolute',
    // top and right will be set dynamically via inline styles
    backgroundColor: lightColors.white,
    borderRadius: 8,
    borderWidth: 1,
    borderColor: lightColors.warmGray,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 12,
    elevation: 20, // Very high elevation for Android
    minWidth: 160,
    zIndex: 9999999, // Maximum z-index
  },
  homeContent: {
    flex: 1,
    backgroundColor: lightColors.cream,
  },
  mainContent: {
    flex: 1,
    backgroundColor: '#ffffff',
  },
  leftContent: {
    flex: 1,
    backgroundColor: '#ffffff',
  },
  channelsSectionWrapper: {
    width: '100%',
    backgroundColor: '#ffffff',
  },
  channelsSection: {
    backgroundColor: '#ffffff',
    paddingVertical: 60,
    paddingHorizontal: 24,
    marginBottom: 0,
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
  },
  channelsContainer: {
    width: '100%',
    marginTop: 32,
  },
  channelsScroll: {
    paddingLeft: 0,
    paddingRight: 0,
  },
  channelsScrollContainer: {
    paddingHorizontal: 24,
    gap: 16,
  },
  sectionTitle: {
    fontSize: 40,
    fontFamily: fonts.regular,
    color: '#212529',
    textAlign: 'center',
    marginBottom: 16,
    letterSpacing: -0.5,
  },
  channelsHint: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginTop: 12,
    fontStyle: 'italic',
  },
  channelCardWrapper: {
    marginRight: 10,
  },
  channelCard: {
    backgroundColor: '#ffffff',
    borderRadius: 16,
    padding: 12,
    width: 110,
    alignItems: 'center',
    borderWidth: 1,
    borderColor: '#e9ecef',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.06,
    shadowRadius: 8,
    elevation: 3,
  },
  channelCardTop: {
    position: 'relative',
    alignItems: 'center',
    paddingTop: 24,
    paddingBottom: 16,
    backgroundColor: '#f8f9fa',
  },
  channelAvatarContainer: {
    marginBottom: 8,
  },
  channelAvatar: {
    width: 60,
    height: 60,
    borderRadius: 30,
    borderWidth: 2,
    borderColor: '#ffffff',
  },
  channelAvatarPlaceholder: {
    width: 60,
    height: 60,
    borderRadius: 30,
    backgroundColor: '#0088cc',
    justifyContent: 'center',
    alignItems: 'center',
    borderWidth: 2,
    borderColor: '#ffffff',
  },
  channelVerifiedBadge: {
    position: 'absolute',
    top: 20,
    right: -5,
    width: 24,
    height: 24,
    borderRadius: 12,
    backgroundColor: '#ffffff',
    justifyContent: 'center',
    alignItems: 'center',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 3,
  },
  channelCardContent: {
    padding: 16,
    paddingTop: 12,
    flex: 1,
  },
  channelName: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#212529',
    textAlign: 'center',
    lineHeight: 16,
  },
  channelMeta: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 6,
  },
  channelMemberCount: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#6c757d',
  },
  channelCardFooter: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 6,
    paddingVertical: 12,
    backgroundColor: '#fff3cd',
    borderTopWidth: 1,
    borderTopColor: '#e9ecef',
  },
  channelJoinText: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: '#212529',
    letterSpacing: 0.3,
  },
  channelDefaultIcon: {
    backgroundColor: lightColors.beeYellow,
    borderRadius: 25,
    width: 50,
    height: 50,
    justifyContent: 'center',
    alignItems: 'center',
  },
  channelFaviconImage: {
    width: 30,
    height: 30,
    borderRadius: 15,
  },
  channelImageContainer: {
    marginBottom: 8,
    alignItems: 'center',
  },
  channelImageCircle: {
    width: 50,
    height: 50,
    borderRadius: 25,
    backgroundColor: lightColors.beeYellow,
    justifyContent: 'center',
    alignItems: 'center',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 3,
    overflow: 'hidden',
  },
  channelImage: {
    width: 50,
    height: 50,
    borderRadius: 25,
  },
  channelEmoji: {
    fontSize: 24,
  },
  jobsSection: {
    backgroundColor: '#ffffff',
    paddingVertical: 60,
    paddingHorizontal: 24,
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
  },
  jobsSectionHeader: {
    textAlign: 'center',
    marginBottom: 8,
  },
  jobsMainContainer: {
    flexDirection: 'row',
    gap: 24,
    flex: 1,
    alignItems: 'flex-start',
  },
  filterSidebarInline: {
    width: 260,
    backgroundColor: '#f8f9fa',
    borderRadius: 16,
    padding: 24,
    alignSelf: 'flex-start',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.05,
    shadowRadius: 8,
    elevation: 2,
  },
  jobsGridContainer: {
    flex: 1,
  },
  jobsHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 16,
  },
  jobsCount: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  filterSidebar: {
    width: 300,
    backgroundColor: lightColors.white,
    borderLeftWidth: 1,
    borderLeftColor: `${lightColors.lightGray}80`,
    paddingVertical: 24,
    paddingHorizontal: 20,
    shadowColor: '#000',
    shadowOffset: { width: -2, height: 0 },
    shadowOpacity: 0.06,
    shadowRadius: 8,
    elevation: 3,
  },
  filterTitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 20,
  },
  filterSection: {
    marginBottom: 24,
  },
  filterLabel: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 12,
  },
  filterScrollView: {
    maxHeight: 150,
  },
  filterOption: {
    paddingVertical: 10,
    paddingHorizontal: 12,
    borderRadius: 8,
    marginBottom: 6,
    backgroundColor: lightColors.lightGray,
  },
  filterOptionActive: {
    backgroundColor: lightColors.beeYellow,
  },
  filterOptionText: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  filterOptionTextActive: {
    color: lightColors.white,
    fontFamily: fonts.regular,
  },
  clearFiltersButton: {
    backgroundColor: lightColors.danger,
    paddingVertical: 12,
    paddingHorizontal: 16,
    borderRadius: 8,
    marginTop: 16,
  },
  clearFiltersText: {
    color: lightColors.white,
    fontSize: 14,
    fontFamily: fonts.regular,
    textAlign: 'center',
  },
  // Brand Image Styles
  appIconImage: {
    width: 28,
    height: 28,
    marginRight: 8,
    resizeMode: 'contain',
  },
  loginLogoImage: {
    width: 80,
    height: 80,
    marginBottom: 16,
    resizeMode: 'contain',
  },
  loadingLogoImage: {
    width: 240,
    height: 240,
    marginBottom: 16,
    resizeMode: 'contain',
  },
  sidebarLogoImage: {
    width: 20,
    height: 20,
    resizeMode: 'contain',
  },
  
  // Modern Header Styles
  modernHeaderContent: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 24,
    paddingVertical: 16,
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
  },
  modernLogoSection: {
    flexDirection: 'row',
    alignItems: 'center',
    flex: 1,
  },
  modernLogoContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    marginRight: 32,
  },
  modernLogoBadge: {
    width: 40,
    height: 40,
    borderRadius: 12,
    backgroundColor: lightColors.beeYellow,
    alignItems: 'center',
    justifyContent: 'center',
    marginRight: 12,
    borderWidth: 1,
    borderColor: 'rgba(0, 0, 0, 0.08)',
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.3,
    shadowRadius: 4,
    elevation: 2,
  },
  modernLogo: {
    width: 24,
    height: 24,
    resizeMode: 'contain',
  },
  modernNavigation: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 24,
  },
  modernNavItem: {
    paddingHorizontal: 16,
    paddingVertical: 8,
    borderRadius: 8,
  },
  modernHeaderRight: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 16,
  },
  modernQuickActions: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  modernIconButton: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: lightColors.lightGray,
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(0, 0, 0, 0.06)',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.05,
    shadowRadius: 2,
    elevation: 1,
  },
  modernLanguageButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 8,
    borderRadius: 8,
    backgroundColor: lightColors.lightGray,
    gap: 4,
    borderWidth: 1,
    borderColor: 'rgba(0, 0, 0, 0.06)',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.05,
    shadowRadius: 2,
    elevation: 1,
  },
  modernLanguageText: {
    fontSize: 14,
    fontWeight: '600',
    color: lightColors.deepNavy,
  },
  modernDownloadButtons: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  modernDownloadButton: {
    height: 32,
    resizeMode: 'contain',
  },
  modernSecondaryButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 20,
    paddingVertical: 12,
    borderRadius: 24,
    backgroundColor: 'transparent',
    borderWidth: 2,
    borderColor: lightColors.deepNavy,
    gap: 8,
  },
  modernSecondaryButtonText: {
    fontSize: 14,
    fontWeight: '600',
    color: lightColors.deepNavy,
  },
  modernPrimaryButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 20,
    paddingVertical: 12,
    borderRadius: 24,
    backgroundColor: lightColors.deepNavy,
    gap: 8,
  },
  modernPrimaryButtonText: {
    fontSize: 14,
    fontWeight: '600',
    color: lightColors.white,
  },
  googleButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 14,
    paddingHorizontal: 20,
    borderRadius: 12,
    backgroundColor: lightColors.white,
    borderWidth: 2,
    borderColor: lightColors.softBlue,
    marginTop: 16,
    gap: 10,
  },
  googleButtonText: {
    fontSize: 16,
    fontWeight: '600',
    color: lightColors.deepNavy,
  },
  dividerContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    marginVertical: 24,
  },
  divider: {
    flex: 1,
    height: 1,
    backgroundColor: lightColors.warmGray,
    opacity: 0.3,
  },
  dividerText: {
    marginHorizontal: 16,
    fontSize: 14,
    color: lightColors.warmGray,
    fontWeight: '500',
  },
  signupLinkContainer: {
    flexDirection: 'row',
    justifyContent: 'center',
    marginTop: 24,
  },
  signupLinkText: {
    fontSize: 14,
    color: lightColors.warmGray,
  },
  signupLink: {
    fontSize: 14,
    color: lightColors.softBlue,
    fontWeight: '600',
  },
  forgotPasswordLink: {
    alignSelf: 'center',
    marginTop: 16,
    paddingVertical: 8,
  },
  forgotPasswordText: {
    fontSize: 14,
    color: lightColors.softBlue,
    fontFamily: fonts.regular,
  },
  forgotPasswordDescription: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginBottom: 24,
    lineHeight: 20,
  },
  
  // Hero Section Styles
  heroContent: {
    flexDirection: 'row',
    alignItems: 'center',
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
    paddingHorizontal: 24,
    paddingVertical: 60,
    gap: 60,
  },
  heroTextSection: {
    flex: 1,
  },
  heroImageSection: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
  },
  heroMascotImage: {
    width: 300,
    height: 300,
  },
  heroImagePlaceholder: {
    width: 300,
    height: 200,
    borderRadius: 20,
    backgroundColor: lightColors.cream,
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 2,
    borderColor: lightColors.beeYellow,
    borderStyle: 'dashed',
  },
  modernSearchButton: {
    width: 48,
    height: 48,
    borderRadius: 24,
    backgroundColor: lightColors.deepNavy,
    alignItems: 'center',
    justifyContent: 'center',
  },
  heroStats: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 40,
    marginTop: 32,
  },
  heroStat: {
    alignItems: 'center',
  },
  heroDownloadImage: {
    height: 50,
    width: 170,
    marginTop: 32,
    resizeMode: 'cover',
  },
  
  // Mobile Menu Styles
  mobileMenuOverlay: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    zIndex: 1000,
  },
  mobileMenuBackdrop: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    backgroundColor: 'rgba(0, 0, 0, 0.5)',
  },
  mobileMenu: {
    position: 'absolute',
    top: 0,
    left: 0,
    width: '80%',
    maxWidth: 320,
    height: '100%',
    backgroundColor: lightColors.white,
  },
  mobileMenuHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    padding: 20,
    borderBottomWidth: 1,
    borderBottomColor: lightColors.lightGray,
  },
  mobileMenuContent: {
    flex: 1,
    paddingVertical: 16,
  },
  mobileMenuItem: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingVertical: 16,
    paddingHorizontal: 20,
    gap: 16,
  },
  mobileMenuDivider: {
    height: 1,
    backgroundColor: lightColors.lightGray,
    marginVertical: 16,
    marginHorizontal: 20,
  },
  mobileMenuDownloads: {
    paddingHorizontal: 20,
  },
  mobileMenuDownloadItem: {
    marginVertical: 8,
  },
  mobileDownloadButton: {
    height: 40,
    resizeMode: 'contain',
  },
  
  // About Us Section Styles
  aboutSection: {
    backgroundColor: '#ffffff',
    paddingVertical: 80,
    paddingHorizontal: 24,
    marginBottom: 0,
  },
  sectionHeader: {
    alignItems: 'center',
    marginBottom: 56,
  },
  aboutContent: {
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
  },
  aboutTextContainer: {
    width: '100%',
  },
  aboutFeatures: {
    marginTop: 48,
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 24,
    justifyContent: 'space-between',
  },
  aboutFeature: {
    flexDirection: 'row',
    gap: 16,
    flex: 1,
    minWidth: 280,
    maxWidth: 500,
    backgroundColor: '#ffffff',
    padding: 24,
    borderRadius: 16,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.08,
    shadowRadius: 12,
    elevation: 3,
  },
  aboutFeatureText: {
    flex: 1,
  },
  aboutFeatureIconContainer1: {
    width: 56,
    height: 56,
    borderRadius: 12,
    backgroundColor: '#FF6B35',
    alignItems: 'center',
    justifyContent: 'center',
    shadowColor: '#FF6B35',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  aboutFeatureIconContainer2: {
    width: 56,
    height: 56,
    borderRadius: 12,
    backgroundColor: '#FFB84D',
    alignItems: 'center',
    justifyContent: 'center',
    shadowColor: '#FFB84D',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  aboutFeatureIconContainer3: {
    width: 56,
    height: 56,
    borderRadius: 12,
    backgroundColor: '#4A90E2',
    alignItems: 'center',
    justifyContent: 'center',
    shadowColor: '#4A90E2',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  pricingSection: {
    backgroundColor: '#f8f9fa',
    paddingVertical: 80,
    paddingHorizontal: 24,
    marginBottom: 0,
  },
  pricingGrid: {
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
    flexDirection: 'row',
    gap: 32,
    marginTop: 56,
    flexWrap: 'wrap',
    justifyContent: 'center',
  },
  pricingCard: {
    backgroundColor: '#ffffff',
    borderRadius: 20,
    padding: 40,
    flex: 1,
    minWidth: 300,
    maxWidth: 380,
    borderWidth: 1,
    borderColor: '#e9ecef',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.08,
    shadowRadius: 16,
    elevation: 4,
  },
  pricingCardPopular: {
    borderColor: lightColors.beeYellow,
    borderWidth: 2,
    transform: [{ scale: 1.05 }],
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 8 },
    shadowOpacity: 0.15,
    shadowRadius: 24,
    elevation: 8,
  },
  pricingBadge: {
    position: 'absolute',
    top: -16,
    right: 32,
    backgroundColor: lightColors.beeYellow,
    paddingHorizontal: 20,
    paddingVertical: 8,
    borderRadius: 24,
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  pricingBadgeText: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: '#ffffff',
    letterSpacing: 1.5,
    textTransform: 'uppercase',
  },
  pricingHeader: {
    alignItems: 'center',
    marginBottom: 32,
    paddingBottom: 32,
    borderBottomWidth: 1,
    borderBottomColor: '#e9ecef',
  },
  pricingIcon: {
    marginBottom: 20,
  },
  pricingFeatures: {
    gap: 20,
    marginBottom: 32,
  },
  pricingFeature: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    gap: 12,
  },
  pricingFeatureDisabled: {
    opacity: 0.3,
  },
  pricingButton: {
    backgroundColor: lightColors.beeYellow,
    paddingVertical: 18,
    paddingHorizontal: 32,
    borderRadius: 12,
    alignItems: 'center',
    justifyContent: 'center',
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.2,
    shadowRadius: 8,
    elevation: 3,
  },
  pricingButtonOutline: {
    backgroundColor: 'transparent',
    borderWidth: 2,
    borderColor: '#495057',
    shadowColor: 'transparent',
  },
  pricingButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: '#ffffff',
    letterSpacing: 0.5,
  },
  pricingButtonOutlineText: {
    color: '#495057',
  },
  // Footer Styles
  footerSection: {
    backgroundColor: '#212529',
    paddingVertical: 60,
    paddingHorizontal: 24,
  },
  footerContent: {
    maxWidth: 1200,
    alignSelf: 'center',
    width: '100%',
  },
  footerTop: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 48,
    marginBottom: 48,
    justifyContent: 'space-between',
  },
  footerColumn: {
    flex: 1,
    minWidth: 200,
  },
  footerLogoSection: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 16,
    gap: 12,
  },
  footerLogo: {
    width: 32,
    height: 32,
  },
  footerBrandName: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: '#ffffff',
  },
  footerDescription: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#adb5bd',
    lineHeight: 22,
    marginBottom: 20,
  },
  footerSocial: {
    flexDirection: 'row',
    gap: 12,
  },
  footerSocialButton: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: '#343a40',
    alignItems: 'center',
    justifyContent: 'center',
  },
  footerColumnTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: '#ffffff',
    marginBottom: 20,
    letterSpacing: 0.5,
  },
  footerLink: {
    paddingVertical: 8,
  },
  footerLinkText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#adb5bd',
  },
  footerBottom: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingTop: 32,
    borderTopWidth: 1,
    borderTopColor: '#343a40',
    flexWrap: 'wrap',
    gap: 16,
  },
  footerCopyright: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#6c757d',
  },
  footerBottomLinks: {
    flexDirection: 'row',
    gap: 12,
    alignItems: 'center',
  },
  footerBottomLinkText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: '#6c757d',
  },
  footerDivider: {
    fontSize: 14,
    color: '#6c757d',
  },
  
  // Job Details Screen Styles
  jobDetailsContainer: {
    flex: 1,
    backgroundColor: '#f8f9fa',
  },
  jobDetailsHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 20,
    paddingVertical: 16,
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: '#e9ecef',
  },
  backButton: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: '#f8f9fa',
    alignItems: 'center',
    justifyContent: 'center',
  },
  jobDetailsHeaderTitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  jobDetailsTopSection: {
    backgroundColor: lightColors.white,
    padding: 24,
    alignItems: 'center',
    borderBottomWidth: 1,
    borderBottomColor: '#e9ecef',
  },
  jobDetailsIconContainer: {
    width: 80,
    height: 80,
    borderRadius: 40,
    backgroundColor: '#fff3cd',
    alignItems: 'center',
    justifyContent: 'center',
    marginBottom: 16,
  },
  jobDetailsTitle: {
    fontSize: 24,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    textAlign: 'center',
    marginBottom: 8,
  },
  jobDetailsCompany: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginBottom: 16,
  },
  jobDetailsBadges: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 8,
    justifyContent: 'center',
  },
  jobDetailsBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#e9ecef',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 16,
    gap: 4,
  },
  jobDetailsBadgeText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#495057',
    textTransform: 'uppercase',
  },
  remoteBadgeLarge: {
    backgroundColor: '#d4edda',
  },
  remoteBadgeTextLarge: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#155724',
    textTransform: 'uppercase',
  },
  categoryBadgeLarge: {
    backgroundColor: '#e7f3ff',
  },
  categoryBadgeTextLarge: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#2c5aa0',
  },
  jobDetailsInfoSection: {
    padding: 20,
    gap: 12,
  },
  jobDetailsInfoCard: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.white,
    padding: 16,
    borderRadius: 12,
    gap: 12,
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  jobDetailsInfoContent: {
    flex: 1,
  },
  jobDetailsInfoLabel: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 4,
  },
  jobDetailsInfoValue: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  jobDetailsSection: {
    backgroundColor: lightColors.white,
    padding: 20,
    marginHorizontal: 20,
    marginBottom: 12,
    borderRadius: 12,
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  jobDetailsSectionTitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 12,
  },
  jobDetailsDescription: {
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    lineHeight: 24,
  },
  jobTagsContainer: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 8,
  },
  jobTag: {
    backgroundColor: '#e7f3ff',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 16,
  },
  jobTagText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.softBlue,
  },
  jobDetailsApplySection: {
    padding: 20,
    paddingBottom: 40,
  },
  jobDetailsApplyButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: lightColors.deepNavy,
    paddingVertical: 16,
    borderRadius: 12,
    gap: 8,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.2,
    shadowRadius: 8,
    elevation: 4,
  },
  jobDetailsApplyButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.white,
  },
  jobDetailsMainContainer: {
    flexDirection: 'row',
    flex: 1,
    backgroundColor: '#f8f9fa',
  },
  relatedJobsSidebar: {
    width: 280,
    minWidth: 280,
    maxWidth: 320,
    backgroundColor: lightColors.white,
    padding: 20,
    borderLeftWidth: 1,
    borderLeftColor: '#e9ecef',
  },
  relatedJobsTitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 16,
  },
  relatedJobCard: {
    backgroundColor: lightColors.white,
    padding: 12,
    borderRadius: 12,
    marginBottom: 14,
    borderWidth: 1,
    borderColor: '#e9ecef',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.05,
    shadowRadius: 4,
    elevation: 2,
  },
  relatedJobHeader: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    gap: 10,
    marginBottom: 10,
  },
  relatedJobIcon: {
    width: 32,
    height: 32,
    borderRadius: 8,
  },
  relatedJobIconPlaceholder: {
    width: 32,
    height: 32,
    borderRadius: 8,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
  },
  relatedJobTitle: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 3,
    lineHeight: 18,
  },
  relatedJobCompany: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  relatedJobDetails: {
    gap: 6,
    marginBottom: 10,
  },
  relatedJobDetailItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  relatedJobDetailText: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    flex: 1,
  },
  relatedJobFooter: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingTop: 8,
    borderTopWidth: 1,
    borderTopColor: '#f0f0f0',
  },
  relatedJobSalaryBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    backgroundColor: '#d4edda',
    paddingHorizontal: 8,
    paddingVertical: 4,
    borderRadius: 6,
  },
  relatedJobSalary: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: lightColors.success,
  },
  relatedJobTime: {
    fontSize: 10,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  relatedJobMeta: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
  },
  relatedJobLocation: {
    fontSize: 11,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  relatedJobsEmpty: {
    alignItems: 'center',
    justifyContent: 'center',
    padding: 32,
    marginTop: 20,
  },
  relatedJobsEmptyText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginTop: 12,
    textAlign: 'center',
  },
  relatedJobsEmptySubtext: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 6,
    textAlign: 'center',
  },
  jobDetailsContent: {
    flex: 1,
    backgroundColor: '#f8f9fa',
  },
  skillTag: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#d4edda',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 16,
    gap: 6,
  },
  skillTagText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#155724',
  },
  sourceChannelImage: {
    width: 32,
    height: 32,
    borderRadius: 16,
    marginRight: 8,
  },
  headerActions: {
    flexDirection: 'row',
    gap: 12,
  },
  headerActionButton: {
    padding: 8,
    borderRadius: 8,
    backgroundColor: lightColors.cream,
  },
  relatedJobsSidebarHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    marginBottom: 16,
  },
  jobHeaderCard: {
    backgroundColor: lightColors.white,
    borderRadius: 16,
    padding: 24,
    marginBottom: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.06,
    shadowRadius: 8,
    elevation: 2,
  },
  jobHeaderTop: {
    flexDirection: 'row',
    marginBottom: 20,
  },
  jobHeaderInfo: {
    flex: 1,
    marginLeft: 16,
  },
  companyLogo: {
    width: 64,
    height: 64,
    borderRadius: 12,
  },
  companyLogoPlaceholder: {
    width: 64,
    height: 64,
    borderRadius: 12,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
  },
  jobPostedTime: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  quickStatsContainer: {
    flexDirection: 'row',
    gap: 20,
    marginTop: 16,
    paddingTop: 16,
    borderTopWidth: 1,
    borderTopColor: '#e9ecef',
  },
  quickStat: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  quickStatText: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  salaryHighlight: {
    backgroundColor: '#d4edda',
    borderRadius: 12,
    padding: 16,
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
    marginTop: 16,
    borderWidth: 1,
    borderColor: '#c3e6cb',
  },
  salaryHighlightText: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: '#155724',
  },
  keyInfoSection: {
    marginBottom: 20,
  },
  jobDetailsSectionHeader: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 16,
    flexDirection: 'row',
    alignItems: 'center',
  },
  infoCardIcon: {
    width: 48,
    height: 48,
    borderRadius: 12,
    backgroundColor: '#f8f9fa',
    justifyContent: 'center',
    alignItems: 'center',
  },
  contentCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.04,
    shadowRadius: 4,
    elevation: 1,
  },
  benefitsList: {
    gap: 12,
  },
  benefitItem: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    gap: 12,
  },
  benefitText: {
    flex: 1,
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    lineHeight: 22,
  },
  preferredSkillTag: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#fff3cd',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 16,
    gap: 6,
  },
  preferredSkillTagText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: '#856404',
  },
  sourceInfoSection: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 20,
    marginBottom: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.04,
    shadowRadius: 4,
    elevation: 1,
  },
  sourceInfoLabel: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 12,
    textTransform: 'uppercase',
    letterSpacing: 0.5,
  },
  sourceInfoContent: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  sourceChannelImageLarge: {
    width: 48,
    height: 48,
    borderRadius: 24,
  },
  sourceInfoText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  applyDisclaimer: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    marginTop: 12,
  },
  jobDetailsFooter: {
    backgroundColor: lightColors.white,
    borderTopWidth: 1,
    borderTopColor: '#e9ecef',
    paddingVertical: 24,
    paddingHorizontal: 20,
    marginTop: 32,
  },
  jobFooterContent: {
    flexDirection: 'row',
    justifyContent: 'space-around',
    alignItems: 'center',
    marginBottom: 20,
  },
  jobFooterSection: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  jobFooterText: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  jobFooterDividerVertical: {
    width: 1,
    height: 20,
    backgroundColor: '#e9ecef',
  },
  jobFooterBottom: {
    alignItems: 'center',
    gap: 8,
    marginBottom: 16,
  },
  jobFooterBottomText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
  },
  jobFooterLinks: {
    flexDirection: 'row',
    justifyContent: 'center',
    alignItems: 'center',
    gap: 12,
  },
  jobFooterLinkDivider: {
    fontSize: 12,
    color: lightColors.warmGray,
  },
  
  // Modern Toolbar Styles
  modernToolbar: {
    backgroundColor: lightColors.white,
    borderBottomWidth: 1,
    borderBottomColor: '#e9ecef',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.05,
    shadowRadius: 3,
    elevation: 3,
    position: 'relative',
    zIndex: 1000,
  },
  modernToolbarContent: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 16,
    paddingVertical: 12,
    maxWidth: 1400,
    alignSelf: 'center',
    width: '100%',
  },
  modernToolbarLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 16,
    flex: 1,
  },
  modernBackButton: {
    width: 40,
    height: 40,
    borderRadius: 8,
    backgroundColor: `${lightColors.beeYellow}15`,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernToolbarLogo: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 10,
  },
  modernToolbarLogoBadge: {
    width: 36,
    height: 36,
    borderRadius: 8,
    backgroundColor: lightColors.beeYellow,
    justifyContent: 'center',
    alignItems: 'center',
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.3,
    shadowRadius: 4,
    elevation: 3,
  },
  modernToolbarLogoImage: {
    width: 24,
    height: 24,
  },
  modernToolbarBrandText: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    letterSpacing: -0.5,
  },
  modernToolbarNav: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    marginLeft: 16,
  },
  modernToolbarNavItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 8,
    backgroundColor: 'transparent',
  },
  modernToolbarNavText: {
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  modernToolbarCenter: {
    flex: 2,
    alignItems: 'center',
    position: 'relative',
    zIndex: 100,
  },
  modernSearchContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.white,
    borderWidth: 1.5,
    borderColor: '#e9ecef',
    borderRadius: 12,
    paddingHorizontal: 14,
    paddingVertical: 10,
    width: '100%',
    maxWidth: 500,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.05,
    shadowRadius: 2,
    elevation: 1,
  },
  modernSearchIcon: {
    marginRight: 8,
  },
  modernSearchInput: {
    flex: 1,
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    outlineStyle: 'none',
  },
  modernSearchResults: {
    position: 'absolute',
    top: '100%',
    left: 0,
    right: 0,
    backgroundColor: lightColors.white,
    borderRadius: 12,
    marginTop: 8,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.1,
    shadowRadius: 12,
    elevation: 5,
    borderWidth: 1,
    borderColor: '#e9ecef',
    zIndex: 1000,
  },
  modernSearchResultItem: {
    flexDirection: 'row',
    alignItems: 'center',
    padding: 14,
    borderBottomWidth: 1,
    borderBottomColor: '#f5f5f5',
    gap: 12,
  },
  modernSearchResultIcon: {
    width: 40,
    height: 40,
    borderRadius: 8,
    backgroundColor: `${lightColors.beeYellow}15`,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernSearchResultContent: {
    flex: 1,
  },
  modernSearchResultTitle: {
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 4,
  },
  modernSearchResultMeta: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  modernSearchLoading: {
    position: 'absolute',
    top: '100%',
    left: 0,
    right: 0,
    backgroundColor: lightColors.white,
    borderRadius: 12,
    marginTop: 8,
    padding: 20,
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 12,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.1,
    shadowRadius: 12,
    elevation: 5,
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernSearchLoadingText: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  modernToolbarRight: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    flex: 1,
    justifyContent: 'flex-end',
  },
  
  // Social Proof Card Styles
  socialProofCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 20,
    marginTop: 16,
    borderWidth: 1,
    borderColor: '#e9ecef',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.05,
    shadowRadius: 4,
    elevation: 2,
  },
  socialProofHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 10,
    marginBottom: 16,
  },
  socialProofTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  socialProofStats: {
    gap: 12,
  },
  socialProofStat: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    gap: 10,
  },
  socialProofStatIcon: {
    width: 32,
    height: 32,
    borderRadius: 8,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
  },
  socialProofStatText: {
    flex: 1,
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    lineHeight: 20,
  },
  socialProofStatBold: {
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  
  // Match Score Card Styles
  matchScoreCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 20,
    marginTop: 16,
    borderWidth: 2,
    borderColor: lightColors.beeYellow,
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.15,
    shadowRadius: 8,
    elevation: 3,
  },
  matchScoreHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    marginBottom: 16,
  },
  matchScoreLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  matchScoreTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  matchScoreSubtitle: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginTop: 2,
  },
  matchScoreBadge: {
    backgroundColor: lightColors.beeYellow,
    paddingHorizontal: 16,
    paddingVertical: 8,
    borderRadius: 20,
  },
  matchScorePercentage: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  matchScoreBar: {
    height: 8,
    backgroundColor: lightColors.cream,
    borderRadius: 4,
    overflow: 'hidden',
    marginBottom: 12,
  },
  matchScoreProgress: {
    height: '100%',
    backgroundColor: lightColors.beeYellow,
    borderRadius: 4,
  },
  matchScoreDescription: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    lineHeight: 18,
  },
  // Login Prompt Card Styles
  loginPromptCard: {
    backgroundColor: lightColors.white,
    marginHorizontal: 16,
    marginTop: 16,
    marginBottom: 16,
    padding: 20,
    borderRadius: 16,
    borderWidth: 2,
    borderColor: lightColors.beeYellow,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.1,
    shadowRadius: 8,
    elevation: 4,
  },
  loginPromptHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 12,
    gap: 12,
  },
  loginPromptTitle: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  loginPromptSubtitle: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    marginBottom: 16,
    lineHeight: 20,
  },
  loginPromptBenefits: {
    gap: 14,
    marginBottom: 20,
  },
  loginPromptBenefit: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  loginPromptBenefitText: {
    flex: 1,
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.charcoal,
    lineHeight: 20,
  },
  loginPromptButton: {
    backgroundColor: lightColors.deepNavy,
    paddingVertical: 14,
    paddingHorizontal: 24,
    borderRadius: 12,
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 8,
  },
  loginPromptButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.white,
  },
  // Sticky Apply Button
  stickyApplyButton: {
    position: 'absolute',
    bottom: 0,
    left: 0,
    right: 0,
    backgroundColor: lightColors.white,
    paddingHorizontal: 16,
    paddingVertical: 12,
    paddingBottom: 20,
    borderTopWidth: 1,
    borderTopColor: lightColors.lightGray,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: -2 },
    shadowOpacity: 0.1,
    shadowRadius: 8,
    elevation: 8,
  },

  // ===== MODERN JOB DETAILS STYLES =====
  // Modern Job Header Card
  modernJobHeaderCard: {
    backgroundColor: lightColors.white,
    borderRadius: 16,
    padding: 26,
    marginBottom: 24,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.08,
    shadowRadius: 12,
    elevation: 3,
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernJobHeaderTop: {
    flexDirection: 'row',
    marginBottom: 22,
  },
  modernJobDetailsIconContainer: {
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.08,
    shadowRadius: 4,
    elevation: 2,
  },
  modernCompanyLogo: {
    width: 72,
    height: 72,
    borderRadius: 14,
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernCompanyLogoPlaceholder: {
    width: 72,
    height: 72,
    borderRadius: 14,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernJobHeaderInfo: {
    flex: 1,
    marginLeft: 18,
  },
  modernJobDetailsTitle: {
    fontSize: 22,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
    marginBottom: 8,
    lineHeight: 30,
  },
  modernJobDetailsCompany: {
    fontSize: 16,
    fontFamily: fonts.medium,
    color: lightColors.softBlue,
    marginBottom: 10,
  },
  modernJobMetaRow: {
    flexDirection: 'row',
    gap: 16,
    flexWrap: 'wrap',
  },
  modernJobMetaItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  modernJobPostedTime: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  modernJobDetailsBadges: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 10,
    marginBottom: 18,
  },
  modernJobDetailsBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.cream,
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 8,
    gap: 6,
    borderWidth: 1,
    borderColor: lightColors.lightGray,
  },
  modernJobDetailsBadgeText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
  },
  modernQuickStatsContainer: {
    flexDirection: 'row',
    gap: 24,
    marginTop: 18,
    paddingTop: 18,
    borderTopWidth: 1,
    borderTopColor: '#e9ecef',
  },
  modernQuickStat: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 10,
  },
  modernStatIconCircle: {
    width: 36,
    height: 36,
    borderRadius: 18,
    backgroundColor: lightColors.white,
    justifyContent: 'center',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernQuickStatText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
  },
  modernMatchScoreCard: {
    backgroundColor: '#fff8e1',
    borderRadius: 14,
    padding: 18,
    marginTop: 18,
    borderWidth: 1.5,
    borderColor: lightColors.beeYellow,
    shadowColor: lightColors.beeYellow,
    shadowOffset: { width: 0, height: 3 },
    shadowOpacity: 0.15,
    shadowRadius: 8,
    elevation: 3,
  },
  modernMatchScoreHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 14,
  },
  modernMatchScoreLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  modernMatchScoreTitle: {
    fontSize: 16,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
  },
  modernMatchScoreSubtitle: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
  },
  modernMatchScoreBadge: {
    backgroundColor: lightColors.beeYellow,
    borderRadius: 20,
    paddingHorizontal: 14,
    paddingVertical: 6,
  },
  modernMatchScorePercentage: {
    fontSize: 18,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
  },
  modernMatchScoreBar: {
    height: 8,
    backgroundColor: lightColors.white,
    borderRadius: 4,
    overflow: 'hidden',
    marginBottom: 12,
  },
  modernMatchScoreProgress: {
    height: '100%',
    backgroundColor: lightColors.beeYellow,
    borderRadius: 4,
  },
  modernMatchScoreDescription: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    lineHeight: 20,
  },
  modernSalaryHighlight: {
    backgroundColor: '#e8f5e9',
    borderRadius: 12,
    padding: 16,
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
    marginTop: 18,
    borderWidth: 1,
    borderColor: '#c3e6cb',
  },
  modernSalaryHighlightText: {
    fontSize: 18,
    fontFamily: fonts.bold,
    color: lightColors.success,
  },

  // Modern Section Styles
  modernJobDetailsSection: {
    backgroundColor: lightColors.white,
    borderRadius: 16,
    padding: 24,
    marginBottom: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.06,
    shadowRadius: 8,
    elevation: 2,
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernSectionHeaderContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
    marginBottom: 18,
  },
  modernSectionIconCircle: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: lightColors.cream,
    justifyContent: 'center',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: '#e9ecef',
  },
  modernJobDetailsSectionHeader: {
    fontSize: 20,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
  },
  modernContentCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 0,
  },
  modernJobDetailsDescription: {
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    lineHeight: 24,
  },

  // Modern Info Cards
  modernJobDetailsInfoSection: {
    backgroundColor: lightColors.cream,
    borderRadius: 12,
    padding: 16,
    gap: 14,
  },
  modernJobDetailsInfoCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 16,
    flexDirection: 'row',
    gap: 14,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.05,
    shadowRadius: 4,
    elevation: 1,
  },
  modernInfoCardIcon: {
    width: 52,
    height: 52,
    borderRadius: 12,
    justifyContent: 'center',
    alignItems: 'center',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.08,
    shadowRadius: 3,
    elevation: 2,
  },
  modernJobDetailsInfoContent: {
    flex: 1,
    justifyContent: 'center',
  },
  modernJobDetailsInfoLabel: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 4,
  },
  modernJobDetailsInfoValue: {
    fontSize: 16,
    fontFamily: fonts.bold,
    color: lightColors.deepNavy,
  },

  // Modern Benefits List
  modernBenefitsList: {
    gap: 14,
  },
  modernBenefitItem: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    gap: 12,
  },
  modernBenefitText: {
    flex: 1,
    fontSize: 15,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    lineHeight: 24,
  },

  // Modern Tags and Skills
  modernJobTagsContainer: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 10,
  },
  modernSkillTag: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#e8f5e9',
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 8,
    gap: 7,
    borderWidth: 1,
    borderColor: lightColors.success,
  },
  modernSkillTagText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
  },
  modernPreferredSkillTag: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: '#fff8e1',
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 8,
    gap: 7,
    borderWidth: 1,
    borderColor: lightColors.honeyGold,
  },
  modernPreferredSkillTagText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
  },
  modernJobTag: {
    flexDirection: 'row',
    alignItems: 'center',
    backgroundColor: lightColors.cream,
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 8,
    gap: 7,
    borderWidth: 1,
    borderColor: lightColors.beeYellow,
  },
  modernJobTagText: {
    fontSize: 14,
    fontFamily: fonts.medium,
    color: lightColors.deepNavy,
  },

  // Modern Sticky Apply Button
  modernStickyApplyButton: {
    position: 'absolute',
    bottom: 0,
    left: 0,
    right: 0,
    backgroundColor: lightColors.white,
    paddingHorizontal: 20,
    paddingVertical: 16,
    paddingBottom: 24,
    borderTopWidth: 1,
    borderTopColor: lightColors.lightGray,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: -3 },
    shadowOpacity: 0.12,
    shadowRadius: 12,
    elevation: 10,
  },
  modernJobDetailsApplyButton: {
    backgroundColor: lightColors.deepNavy,
    paddingVertical: 16,
    paddingHorizontal: 32,
    borderRadius: 12,
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 12,
    shadowColor: lightColors.deepNavy,
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.25,
    shadowRadius: 8,
    elevation: 5,
  },
  modernJobDetailsApplyButtonText: {
    fontSize: 17,
    fontFamily: fonts.bold,
    color: lightColors.white,
    letterSpacing: 0.3,
  },
  // ===== END MODERN JOB DETAILS STYLES =====

  // Telegram Source Styles
  telegramSourceSection: {
    margin: 16,
    marginBottom: 24,
  },
  telegramSourceHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    marginBottom: 12,
  },
  telegramSourceTitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  telegramSourceCard: {
    backgroundColor: lightColors.white,
    borderRadius: 12,
    padding: 16,
    borderWidth: 1,
    borderColor: '#0088cc20',
    shadowColor: '#0088cc',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.08,
    shadowRadius: 6,
    elevation: 3,
  },
  telegramChannelInfo: {
    flexDirection: 'row',
    gap: 14,
  },
  telegramChannelImage: {
    width: 56,
    height: 56,
    borderRadius: 28,
    borderWidth: 2,
    borderColor: '#0088cc',
  },
  telegramChannelImagePlaceholder: {
    width: 56,
    height: 56,
    borderRadius: 28,
    backgroundColor: '#0088cc10',
    justifyContent: 'center',
    alignItems: 'center',
    borderWidth: 2,
    borderColor: '#0088cc',
  },
  telegramChannelDetails: {
    flex: 1,
    justifyContent: 'center',
  },
  telegramChannelName: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 4,
  },
  telegramChannelDescription: {
    fontSize: 13,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 10,
  },
  viewOnTelegramButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    backgroundColor: '#0088cc',
    paddingVertical: 8,
    paddingHorizontal: 12,
    borderRadius: 8,
    alignSelf: 'flex-start',
  },
  viewOnTelegramText: {
    fontSize: 12,
    fontFamily: fonts.regular,
    color: lightColors.white,
  },
  
  // 404 Not Found Screen Styles
  notFoundContainer: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    paddingHorizontal: 40,
    backgroundColor: lightColors.white,
  },
  notFoundImage: {
    width: 300,
    height: 300,
    marginBottom: 32,
  },
  notFoundTitle: {
    fontSize: 32,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginBottom: 16,
    textAlign: 'center',
  },
  notFoundSubtitle: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 40,
    textAlign: 'center',
    lineHeight: 24,
  },
  notFoundButtonsContainer: {
    flexDirection: 'row',
    gap: 16,
    flexWrap: 'wrap',
    justifyContent: 'center',
  },
  notFoundPrimaryButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    backgroundColor: lightColors.deepNavy,
    paddingVertical: 14,
    paddingHorizontal: 24,
    borderRadius: 8,
  },
  notFoundPrimaryButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.white,
  },
  notFoundSecondaryButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
    backgroundColor: lightColors.white,
    paddingVertical: 14,
    paddingHorizontal: 24,
    borderRadius: 8,
    borderWidth: 2,
    borderColor: lightColors.deepNavy,
  },
  notFoundSecondaryButtonText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  
  // Content Pages Styles (Privacy, Job Alerts, Career Advice, etc.)
  contentPage: {
    flex: 1,
    backgroundColor: lightColors.white,
  },
  contentPageHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    padding: 24,
    borderBottomWidth: 1,
    borderBottomColor: '#e9ecef',
    gap: 16,
  },
  contentPageBackButton: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: '#f8f9fa',
    alignItems: 'center',
    justifyContent: 'center',
  },
  contentPageTitle: {
    fontSize: 28,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
  },
  contentPageBody: {
    padding: 24,
    maxWidth: 800,
    alignSelf: 'center',
    width: '100%',
  },
  contentPageLastUpdated: {
    fontSize: 14,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    marginBottom: 32,
  },
  contentPageSection: {
    fontSize: 20,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginTop: 32,
    marginBottom: 16,
  },
  contentPageText: {
    fontSize: 16,
    fontFamily: fonts.regular,
    color: '#495057',
    lineHeight: 26,
    marginBottom: 16,
  },
  featureHeroSection: {
    alignItems: 'center',
    padding: 40,
    backgroundColor: '#f8f9fa',
    borderRadius: 16,
    marginBottom: 32,
  },
  featureHeroTitle: {
    fontSize: 32,
    fontFamily: fonts.regular,
    color: lightColors.deepNavy,
    marginTop: 24,
    marginBottom: 12,
    textAlign: 'center',
  },
  featureHeroSubtitle: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.warmGray,
    textAlign: 'center',
    lineHeight: 28,
  },
  contentPageCTA: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 12,
    backgroundColor: lightColors.deepNavy,
    paddingVertical: 16,
    paddingHorizontal: 32,
    borderRadius: 8,
    marginTop: 40,
    alignSelf: 'center',
  },
  contentPageCTAText: {
    fontSize: 18,
    fontFamily: fonts.regular,
    color: lightColors.white,
  },

  // Bookmarks Screen Styles
  bookmarksHeroSection: {
    paddingVertical: 60,
    paddingHorizontal: 24,
    position: 'relative',
    overflow: 'hidden',
    alignItems: 'center',
  },
  bookmarksHeroContent: {
    alignItems: 'center',
    zIndex: 1,
  },
  bookmarksHeroIconCircle: {
    width: 80,
    height: 80,
    borderRadius: 40,
    backgroundColor: 'rgba(247, 183, 49, 0.2)',
    justifyContent: 'center',
    alignItems: 'center',
    marginBottom: 20,
  },
  bookmarksHeroTitle: {
    fontSize: 32,
    fontWeight: '700',
    textAlign: 'center',
    marginBottom: 12,
  },
  bookmarksHeroSubtitle: {
    fontSize: 16,
    textAlign: 'center',
  },
  bookmarksContentContainer: {
    padding: 24,
    marginTop: -20,
  },
  bookmarksLoadingContainer: {
    padding: 60,
    alignItems: 'center',
    gap: 16,
  },
  bookmarksLoadingText: {
    fontSize: 16,
  },
  bookmarksEmptyState: {
    borderRadius: 16,
    padding: 60,
    alignItems: 'center',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.05,
    shadowRadius: 8,
    elevation: 2,
  },
  bookmarksEmptyIconCircle: {
    width: 160,
    height: 160,
    borderRadius: 80,
    justifyContent: 'center',
    alignItems: 'center',
    marginBottom: 32,
  },
  bookmarksEmptyTitle: {
    fontSize: 24,
    fontWeight: '700',
    marginBottom: 12,
  },
  bookmarksEmptySubtitle: {
    fontSize: 16,
    textAlign: 'center',
    lineHeight: 24,
    marginBottom: 32,
    maxWidth: 400,
  },
  bookmarksEmptyButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 24,
    paddingVertical: 14,
    borderRadius: 12,
    gap: 8,
  },
  bookmarksEmptyButtonText: {
    fontSize: 16,
    fontWeight: '600',
  },
  bookmarksGridContainer: {
    gap: 24,
  },
  bookmarksGridHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 16,
  },
  bookmarksGridTitle: {
    fontSize: 24,
    fontWeight: '700',
  },
  bookmarksGridStats: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  bookmarksGridStatsText: {
    fontSize: 14,
    fontWeight: '500',
  },
  bookmarksGrid: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 20,
  },
  modernBookmarkCard: {
    width: '48%',
    minWidth: 280,
    borderRadius: 16,
    padding: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.08,
    shadowRadius: 12,
    elevation: 3,
    borderWidth: 1,
    borderColor: 'rgba(0,0,0,0.05)',
  },
  modernBookmarkCardHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'flex-start',
    marginBottom: 16,
  },
  modernBookmarkLogoContainer: {
    width: 56,
    height: 56,
  },
  modernBookmarkLogo: {
    width: 56,
    height: 56,
    borderRadius: 12,
  },
  modernBookmarkLogoPlaceholder: {
    width: 56,
    height: 56,
    borderRadius: 12,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernBookmarkLogoText: {
    fontSize: 24,
    fontWeight: '700',
  },
  modernRemoveBookmarkButton: {
    width: 32,
    height: 32,
    borderRadius: 16,
    justifyContent: 'center',
    alignItems: 'center',
  },
  modernBookmarkCardBody: {
    gap: 12,
  },
  modernBookmarkJobTitle: {
    fontSize: 18,
    fontWeight: '700',
    lineHeight: 24,
  },
  modernBookmarkCompany: {
    fontSize: 14,
  },
  modernBookmarkTags: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 8,
  },
  modernBookmarkTag: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 10,
    paddingVertical: 6,
    borderRadius: 8,
    gap: 4,
    borderWidth: 1,
  },
  modernBookmarkTagText: {
    fontSize: 12,
    fontWeight: '500',
  },
  modernBookmarkSalary: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 12,
    paddingVertical: 8,
    borderRadius: 8,
    gap: 6,
  },
  modernBookmarkSalaryText: {
    fontSize: 14,
    fontWeight: '600',
  },
  modernBookmarkCardFooter: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginTop: 16,
    paddingTop: 16,
    borderTopWidth: 1,
  },
  modernBookmarkDate: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
  },
  modernBookmarkDateText: {
    fontSize: 12,
  },
  modernBookmarkApplyButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 8,
    borderRadius: 8,
    gap: 6,
  },
  modernBookmarkApplyText: {
    fontSize: 14,
    fontWeight: '600',
  },
});


